<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Debezium Connector for MySQL :: Debezium Documentation</title>
    <link rel="canonical" href="https://www.debezium.io/documentation/reference/connectors/mysql.html">
    <meta name="generator" content="Antora 2.3.4">
<link rel="stylesheet" href="../../../debezium-antora/css/site.css">
<link rel="stylesheet" href="../../../debezium-antora/css/debezium-antora.css">
<link rel="stylesheet" href="../../../debezium-antora/css/highlightjs-dark.css">
<link rel="stylesheet" href="https://static.jboss.org/css/rhbar.css">
<script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.js"></script>
<script src="../../../debezium-antora/js/jquery.ba-floatingscrollbar.js"></script>
</head>
<body class="article">
<header class="header">
  <div id="rhbar">
      <a class="jbdevlogo" href="https://developers.redhat.com"></a>
      <a class="rhlogo" href="https://www.redhat.com"></a>
  </div>
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
          <img src="/assets/images/color_white_debezium_type_600px.svg" style="height: 32px; margin-right: 14px;"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/documentation/faq">FAQ</a>
        <a class="navbar-item" href="/documentation">DOCUMENTATION</a>
        <a class="navbar-item" href="/releases">RELEASES</a>
        <a class="navbar-item" href="/community">COMMUNITY</a>
        <a class="navbar-item" href="/blog">BLOG</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="reference" data-version="1.3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Debezium Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorial.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../postgres-plugins.html">PostgreSQL Decoding Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../features.html">Features</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/avro.html">Avro Serialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/topic-routing.html">Topic Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/event-flattening.html">New Record State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/mongodb-event-flattening.html">MongoDB New Document State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/outbox-event-router.html">Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/filtering.html">Message Filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/content-based-routing.html">Content-Based Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/topic-auto-create-config.html">Customizing Topic Auto-Creation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Connectors</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="mysql.html">MySQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mongodb.html">MongoDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="postgresql.html">PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="oracle.html">Oracle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sqlserver.html">SQL Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="db2.html">Db2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cassandra.html">Cassandra</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">API and SPI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/engine.html">Debezium Engine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/converters.html">Custom Converters</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/serdes.html">Change Event SerDes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/outbox.html">Outbox Quarkus Extension</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/cloudevents.html">CloudEvents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/testcontainers.html">Integration Testing with Testcontainers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Operations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-server.html">Debezium Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/openshift.html">Running on Openshift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/embedded.html">Embedding Debezium</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Debezium Documentation</span>
    <span class="version">1.3</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Debezium Documentation</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../index.html">master</a>
        </li>
        <li class="version">
          <a href="../../1.5/index.html">1.5</a>
        </li>
        <li class="version">
          <a href="../../1.4/index.html">1.4</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">1.3</a>
        </li>
        <li class="version">
          <a href="../../1.2/index.html">1.2</a>
        </li>
        <li class="version">
          <a href="../../1.1/index.html">1.1</a>
        </li>
        <li class="version">
          <a href="../../1.0/index.html">1.0</a>
        </li>
        <li class="version">
          <a href="../../0.10/index.html">0.10</a>
        </li>
        <li class="version">
          <a href="../../0.9/index.html">0.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main" class="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Debezium Documentation</a></li>
    <li>Connectors</li>
    <li><a href="mysql.html">MySQL</a></li>
  </ul>
</nav>
    <div class="page-versions-container">
    Version:
    <div class="page-versions">
        <button class="version-menu-toggle versions-menu-current" title="Show other versions of page">1.3</button>
        <!--<button class="version-menu-toggle versions-menu-select" title="Select other versions">Select</button>-->
        <div class="version-menu">
                <a class="version" href="../../connectors/mysql.html">master</a>
                <a class="version" href="../../1.5/connectors/mysql.html">1.5</a>
                <a class="version" href="../../1.4/connectors/mysql.html">1.4</a>
                <a class="version is-current" href="mysql.html">1.3</a>
                <a class="version" href="../../1.2/connectors/mysql.html">1.2</a>
                <a class="version" href="../../1.1/connectors/mysql.html">1.1</a>
                <a class="version" href="../../1.0/connectors/mysql.html">1.0</a>
                <a class="version" href="../../0.10/connectors/mysql.html">0.10</a>
                <a class="version" href="../../0.9/connectors/mysql.html">0.9</a>
        </div>
        |
    </div>
    </div>
  <div class="edit-this-page"><a href="https://github.com/debezium/debezium/edit/1.3/documentation/modules/ROOT/pages/connectors/mysql.adoc">Edit this Page</a></div>
  </div>
<div class="article-grid">
<div class="article-cell1">
<article class="doc">
            <div class="version-banner version-banner-outdated">
    You are viewing documentation for an outdated version of Debezium.
    <br/>
            If you want to view the latest stable version of this page, please go <a href="../../1.5/connectors/mysql.html">here</a>.
            
</div>            <h1 class="page">Debezium Connector for MySQL</h1>
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>MySQL has a binary log (binlog) that records all operations in the order in which they are committed to the database. This includes changes to table schemas and the data within tables. MySQL uses the binlog for replication and recovery.</p>
</div>
<div class="paragraph">
<p>The Debezium MySQL connector reads the binlog and produces change events for row-level <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> operations and records the change events in a Kafka topic. Client applications read those Kafka topics.</p>
</div>
<div class="paragraph">
<p>As MySQL is typically set up to purge binlogs after a specified period of time, the MySQL connector performs an initial <em>consistent snapshot</em> of each of your databases. The MySQL connector reads the binlog from the point at which the snapshot was made.</p>
</div>
<div class="paragraph">
<p>The following sections provide more detailed information on how the Debezium MySQL connector functions, instructs you on how to set it up, as well as deploy and troubleshoot the connector.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview-of-how-the-mysql-connector-works"><a class="anchor" href="#overview-of-how-the-mysql-connector-works"></a>Overview of how the MySQL connector works</h2>
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#overview-of-how-the-mysql-connector-works">Overview of how the MySQL connector works</a>
<ul class="sectlevel2">
<li><a href="#how-the-mysql-connector-uses-database-schemas_debezium">How the MySQL connector uses database schemas</a></li>
<li><a href="#how-the-mysql-connector-performs-database-snapshots_debezium">How the MySQL connector performs database snapshots</a></li>
<li><a href="#how-the-mysql-connector-exposes-schema-changes">How the MySQL connector exposes schema changes</a></li>
<li><a href="#mysql-connector-events_debezium">MySQL connector events</a></li>
<li><a href="#how-the-mysql-connector-maps-data-types_debezium">How the MySQL connector maps data types</a></li>
<li><a href="#the-mysql-connector-and-kafka-topics_debezium">The MySQL connector and Kafka topics</a></li>
<li><a href="#mysql-supported-topologies_debezium">MySQL supported topologies</a></li>
</ul>
</li>
<li><a href="#setup-the-mysql-server">Setting up MySQL server</a>
<ul class="sectlevel2">
<li><a href="#create-a-mysql-user-for-cdc_debezium">Creating a MySQL user for Debezium</a></li>
<li><a href="#enable-the-mysql-binlog-for-cdc_debezium">Enabling the MySQL binlog for Debezium</a></li>
<li><a href="#enable-mysql-gtids-for-cdc_debezium">Enabling MySQL Global Transaction Identifiers for Debezium</a></li>
<li><a href="#setup-session-timeouts-for-cdc_debezium">Setting up session timeouts for Debezium</a></li>
<li><a href="#enable-query-log-events-for-cdc_debezium">Enabling query log events for Debezium</a></li>
</ul>
</li>
<li><a href="#deploy-the-mysql-connector">Deploying the MySQL connector</a>
<ul class="sectlevel2">
<li><a href="#install-the-mysql-connector_debezium">Installing the MySQL connector</a></li>
<li><a href="#configure-the-mysql-connector_debezium">Configuring the MySQL connector</a></li>
<li><a href="#add-mysql-connector-configuration-to-kafka-connect">Adding MySQL connector configuration to Kafka Connect</a></li>
<li><a href="#mysql-connector-configuration-properties_debezium">MySQL connector configuration properties</a></li>
<li><a href="#mysql-connector-monitoring-metrics_debezium">MySQL connector monitoring metrics</a></li>
</ul>
</li>
<li><a href="#connector-common-issues">MySQL connector common issues</a>
<ul class="sectlevel2">
<li><a href="#configuration-and-startup-errors_debezium">Configuration and startup errors</a></li>
<li><a href="#mysql-is-unavailable_debezium">MySQL is unavailable</a></li>
<li><a href="#kafka-connect-stops_debezium">Kafka Connect stops</a></li>
<li><a href="#mysql-purges-binlog-files_debezium">MySQL purges binlog files</a></li>
</ul>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Debezium MySQL connector tracks the structure of the tables, performs snapshots, transforms binlog events into Debezium change events and records where those events are recorded in Kafka.</p>
</div>
<div class="sect2">
<h3 id="how-the-mysql-connector-uses-database-schemas_debezium"><a class="anchor" href="#how-the-mysql-connector-uses-database-schemas_debezium"></a>How the MySQL connector uses database schemas</h3>
<div class="paragraph">
<p>When a database client queries a database, the client uses the database’s current schema. However, the database schema can be changed at any time, which means that the connector must be able to identify what the schema was at the time each insert, update, or delete operation was recorded. Also, a connector cannot just use the current schema because the connector might be processing events that are relatively old and may have been recorded before the tables' schemas were changed.</p>
</div>
<div class="paragraph">
<p>To handle this, MySQL includes in the binlog the row-level changes to the data and the DDL statements that are applied to the database. As the connector reads the binlog and comes across these DDL statements, it parses them and updates an in-memory representation of each table’s schema. The connector uses this schema representation to identify the structure of the tables at the time of each insert, update, or delete and to produce the appropriate change event. In a separate database history Kafka topic, the connector also records all DDL statements along with the position in the binlog where each DDL statement appeared.</p>
</div>
<div class="paragraph">
<p>When the connector restarts after having crashed or been stopped gracefully, the connector starts reading the binlog from a specific position, that is, from a specific point in time. The connector rebuilds the table structures that existed at this point in time by reading the database history Kafka topic and parsing all DDL statements up to the point in the binlog where the connector is starting.</p>
</div>
<div class="paragraph">
<p>This database history topic is for connector use only. The connector can optionally generate schema change events on a different topic that is intended for consumer applications. This is described in <a href="#how-the-mysql-connector-exposes-schema-changes">how the MySQL connector exposes schema changes</a>.</p>
</div>
<div class="paragraph">
<p>When the MySQL connector captures changes in a table to which a schema change tool such as <code>gh-ost</code> or <code>pt-online-schema-change</code> is applied then helper tables created during the migration process need to be included among included tables.</p>
</div>
<div class="paragraph">
<p>If downstream systems do not need the messages generated by the temporary table then a simple message transform can be written and applied to filter them out.</p>
</div>
<div class="paragraph">
<p>For information about topic naming conventions, see <a href="#the-mysql-connector-and-kafka-topics_debezium">MySQL connector and Kafka topics</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="how-the-mysql-connector-performs-database-snapshots_debezium"><a class="anchor" href="#how-the-mysql-connector-performs-database-snapshots_debezium"></a>How the MySQL connector performs database snapshots</h3>
<div class="paragraph">
<p>When your Debezium MySQL connector is first started, it performs an initial <em>consistent snapshot</em> of your database. The following flow describes how this snapshot is completed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is the default snapshot mode which is set as <code>initial</code> in the <code>snapshot.mode</code> property. For other snapshots modes, please check out the <a href="#mysql-connector-configuration-properties_debezium">MySQL connector configuration properties</a>.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The connector&#8230;&#8203;</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Step</th>
<th class="tableblock halign-left valign-top">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Grabs a <strong>global read lock</strong> that blocks <em>writes</em> by other database clients.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The snapshot itself does not prevent other clients from applying DDL which might interfere with the connector&#8217;s attempt to read the binlog position and table schemas. The global read lock is kept while the binlog position is read before released in a later step.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Starts a transaction with <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html">repeatable read semantics</a> to ensure that all subsequent reads within the transaction are done against the <em>consistent snapshot</em>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Reads the current binlog position.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Reads the schema of the databases and tables allowed by the connector&#8217;s configuration.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Releases the <strong>global read lock</strong>. This now allows other database clients to write to the database.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>6</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Writes the DDL changes to the schema change topic, including all necessary <code>DROP&#8230;&#8203;</code> and <code>CREATE&#8230;&#8203;</code> DDL statements.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This happens if applicable.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Scans the database tables and generates <code>CREATE</code> events on the relevant table-specific Kafka topics for each row.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commits the transaction.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>9</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Records the completed snapshot in the connector offsets.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_what_happens_if_the_connector_fails"><a class="anchor" href="#_what_happens_if_the_connector_fails"></a>What happens if the connector fails?</h4>
<div class="paragraph">
<p>If the connector fails, stops, or is rebalanced while making the <em>initial snapshot</em>, the connector creates a new snapshot once restarted. Once that <em>intial snapshot</em> is completed, the Debezium MySQL connector restarts from the same position in the binlog so it does not miss any updates.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the connector stops for long enough, MySQL could purge old binlog files and the connector&#8217;s position would be lost. If the position is lost, the connector reverts to the <em>initial snapshot</em> for its starting position. For more tips on troubleshooting the Debezium MySQL connector, see <a href="#connector-common-issues">MySQL connector common issues</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_what_if_global_read_locks_are_not_allowed"><a class="anchor" href="#_what_if_global_read_locks_are_not_allowed"></a>What if Global Read Locks are not allowed?</h4>
<div class="paragraph">
<p><a id="no-global-read-lock-mysql-connect_debezium"></a></p>
</div>
<div class="paragraph">
<p>Some environments do not allow a <strong>global read lock</strong>. If the Debezium MySQL connector detects that global read locks are not permitted, the connector uses table-level locks instead and performs a snapshot with this method.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The user must have <code>LOCK_TABLES</code> privileges.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The connector&#8230;&#8203;</dt>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Step</th>
<th class="tableblock halign-left valign-top">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Starts a transaction with <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html">repeatable read semantics</a> to ensure that all subsequent reads within the transaction are done against the <em>consistent snapshot</em>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reads and filters the names of the databases and tables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Reads the current binlog position.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Reads the schema of the databases and tables allowed by the connector&#8217;s configuration.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Writes the DDL changes to the schema change topic, including all necessary <code>DROP&#8230;&#8203;</code> and <code>CREATE&#8230;&#8203;</code> DDL statements.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This happens if applicable.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>6</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Scans the database tables and generates <code>CREATE</code> events on the relevant table-specific Kafka topics for each row.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commits the transaction.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Releases the table-level locks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>9</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Records the completed snapshot in the connector offsets.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="how-the-mysql-connector-exposes-schema-changes"><a class="anchor" href="#how-the-mysql-connector-exposes-schema-changes"></a>How the MySQL connector exposes schema changes</h3>
<div class="paragraph">
<p>You can configure the Debezium <strong>MySQL connector</strong> to produce schema change events that include all DDL statements applied to databases in the MySQL server. The connector writes all of these events to a Kafka topic named <code>&lt;serverName&gt;</code> where <code>serverName</code> is the name of the connector as specified in the <code>database.server.name</code> configuration property.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If you choose to use <em>schema change events</em>, use the schema change topic and <strong>do not</strong> consume the database history topic.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is vital that there is a global order of the events in the database schema history.
Therefore, the database history topic must not be partitioned. This means that a partition
count of 1 must be specified when creating this topic. When relying on auto topic
creation, make sure that Kafka’s <code>num.partitions</code> configuration option
(the default number of partitions) is set to <code>1</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_schema_change_topic_structure"><a class="anchor" href="#_schema_change_topic_structure"></a>Schema change topic structure</h4>
<div class="paragraph">
<p>Each message that is written to the schema change topic contains a message key which includes the name of the connected database used when applying DDL statements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "schema": {
    "type": "struct",
    "name": "io.debezium.connector.mysql.SchemaChangeKey",
    "optional": false,
    "fields": [
      {
        "field": "databaseName",
        "type": "string",
        "optional": false
      }
    ]
  },
  "payload": {
    "databaseName": "inventory"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The schema change event message value contains a structure that includes the DDL statements, the database to which the statements were applied, and the position in the binlog where the statements appeared:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "schema": {
    "type": "struct",
    "name": "io.debezium.connector.mysql.SchemaChangeValue",
    "optional": false,
    "fields": [
      {
        "field": "databaseName",
        "type": "string",
        "optional": false
      },
      {
        "field": "ddl",
        "type": "string",
        "optional": false
      },
      {
        "field": "source",
        "type": "struct",
        "name": "io.debezium.connector.mysql.Source",
        "optional": false,
        "fields": [
          {
            "type": "string",
            "optional": true,
            "field": "version"
          },
          {
            "type": "string",
            "optional": false,
            "field": "name"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "server_id"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "ts_sec"
          },
          {
            "type": "string",
            "optional": true,
            "field": "gtid"
          },
          {
            "type": "string",
            "optional": false,
            "field": "file"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "pos"
          },
          {
            "type": "int32",
            "optional": false,
            "field": "row"
          },
          {
            "type": "boolean",
            "optional": true,
            "default": false,
            "field": "snapshot"
          },
          {
            "type": "int64",
            "optional": true,
            "field": "thread"
          },
          {
            "type": "string",
            "optional": true,
            "field": "db"
          },
          {
            "type": "string",
            "optional": true,
            "field": "table"
          },
          {
            "type": "string",
            "optional": true,
            "field": "query"
          }
        ]
      }
    ]
  },
  "payload": {
    "databaseName": "inventory",
    "ddl": "CREATE TABLE products ( id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY, name VARCHAR(255) NOT NULL, description VARCHAR(512), weight FLOAT ); ALTER TABLE products AUTO_INCREMENT = 101;",
    "source" : {
      "version": "0.10.0.Beta4",
      "name": "mysql-server-1",
      "server_id": 0,
      "ts_sec": 0,
      "gtid": null,
      "file": "mysql-bin.000003",
      "pos": 154,
      "row": 0,
      "snapshot": true,
      "thread": null,
      "db": null,
      "table": null,
      "query": null
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_important_tips_about_the_schema_change_topic"><a class="anchor" href="#_important_tips_about_the_schema_change_topic"></a>Important tips about the schema change topic</h4>
<div class="paragraph">
<p>The <code>ddl</code> field may contain multiple DDL statements. Every statement applies to the database in the <code>databaseName</code> field and appears in the same order as they were applied in the database. The <code>source</code> field is structured exactly as a standard data change event written to table-specific topics. This field is useful to correlate events on different topic.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">....
    "payload": {
        "databaseName": "inventory",
        "ddl": "CREATE TABLE products ( id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,...
        "source" : {
            ....
        }
    }
....</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">What if a client submits DDL statements to <em>multiple databases</em>?</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>If MySQL applies them atomically, the connector takes the DDL statements in order, groups them by database, and creates a schema change event for each group.</p>
</li>
<li>
<p>If MySQL applies them individually, the connector creates a separate schema change event for each statement.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>If you do not use the <em>schema change topics</em> detailed here, check out the <a href="#how-the-mysql-connector-uses-database-schemas_debezium">database history topic</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mysql-connector-events_debezium"><a class="anchor" href="#mysql-connector-events_debezium"></a>MySQL connector events</h3>
<div class="paragraph">
<p>The Debezium MySQL connector generates a data change event for each row-level <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> operation. Each event contains a key and a value. The structure of the key and the value depends on the table that was changed.</p>
</div>
<div class="paragraph">
<p>Debezium and Kafka Connect are designed around <em>continuous streams of event messages</em>. However, the structure of these events may change over time, which can be difficult for consumers to handle. To address this, each event contains the schema for its content or, if you are using a schema registry, a schema ID that a consumer can use to obtain the schema from the registry. This makes each event self-contained.</p>
</div>
<div class="paragraph">
<p>The following skeleton JSON shows the basic four parts of a change event. However, how you configure the Kafka Connect converter that you choose to use in your application determines the representation of these four parts in change events. A <code>schema</code> field is in a change event only when you configure the converter to produce it. Likewise, the event key and event payload are in a change event only if you configure a converter to produce it. If you use the JSON converver and you configure it to produce all four basic change event parts, change events have this structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "schema": { <i class="conum" data-value="1"></i><b>(1)</b>
   ...
  },
 "payload": { <i class="conum" data-value="2"></i><b>(2)</b>
   ...
 },
 "schema": { <i class="conum" data-value="3"></i><b>(3)</b>
   ...
 },
 "payload": { <i class="conum" data-value="4"></i><b>(4)</b>
   ...
 },
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Overview of change event basic content</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schema</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The first <code>schema</code> field is part of the event key. It specifies a Kafka Connect schema that describes what is in the event key&#8217;s <code>payload</code> portion. In other words, the first <code>schema</code> field describes the structure of the primary key, or the unique key if the table does not have a primary key, for the table that was changed.<br>
<br>
It is possible to override the table&#8217;s primary key by setting the <a href="#mysql-property-message-key-columns"><code>message.key.columns</code> connector configuration property</a>. In this case, the first schema field describes the structure of the key identified by that property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The first <code>payload</code> field is part of the event key. It has the structure described by the previous <code>schema</code> field and it contains the key for the row that was changed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schema</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The second <code>schema</code> field is part of the event value. It specifies the Kafka Connect schema that describes what is in the event value&#8217;s <code>payload</code> portion. In other words, the second <code>schema</code> describes the structure of the row that was changed. Typically, this schema contains nested schemas.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The second <code>payload</code> field is part of the event value. It has the structure described by the previous <code>schema</code> field and it contains the actual data for the row that was changed.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>By default, the connector streams change event records to topics with names that are the same as the event&#8217;s originating table. See <a href="#the-mysql-connector-and-kafka-topics_debezium">MySQL connector and Kafka topics</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The MySQL connector ensures that all Kafka Connect schema names adhere to the <a href="http://avro.apache.org/docs/current/spec.html#names">Avro schema name format</a>. This means that the logical server name must start with a Latin letter or an underscore, that is, a-z, A-Z, or _. Each remaining character in the logical server name and each character in the database and table names must be a Latin letter, a digit, or an underscore, that is, a-z, A-Z, 0-9, or \_. If there is an invalid character it is replaced with an underscore character.</p>
</div>
<div class="paragraph">
<p>This can lead to unexpected conflicts if the logical server name, a database name, or a table name contains invalid characters, and the only characters that distinguish names from one another are invalid and thus replaced with underscores.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_change_event_keys"><a class="anchor" href="#_change_event_keys"></a>Change event keys</h4>
<div class="paragraph">
<p>A change event&#8217;s key contains the schema for the changed table&#8217;s key and the changed row&#8217;s actual key. Both the schema and its corresponding payload contain a field for each column in the changed table&#8217;s <code>PRIMARY KEY</code> (or unique constraint) at the time the connector created the event.</p>
</div>
<div class="paragraph">
<p>Consider the following <code>customers</code> table, which is followed by an example of a change event key for this table.</p>
</div>
<div class="listingblock">
<div class="title">Example table</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE customers (
  id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
  first_name VARCHAR(255) NOT NULL,
  last_name VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE KEY
) AUTO_INCREMENT=1001;</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Example change event key</div>
<p>Every change event that captures a change to the <code>customers</code> table has the same event key schema. For as long as the <code>customers</code> table has the previous definition, every change event that captures a change to the <code>customers</code> table has the following key structure. In JSON, it looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "schema": { <i class="conum" data-value="1"></i><b>(1)</b>
    "type": "struct",
    "name": "mysql-server-1.inventory.customers.Key", <i class="conum" data-value="2"></i><b>(2)</b>
    "optional": false, <i class="conum" data-value="3"></i><b>(3)</b>
    "fields": [ <i class="conum" data-value="4"></i><b>(4)</b>
      {
        "field": "id",
        "type": "int32",
        "optional": false
      }
    ]
  },
 "payload": { <i class="conum" data-value="5"></i><b>(5)</b>
    "id": 1001
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Description of change event key</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schema</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The schema portion of the key specifies a Kafka Connect schema that describes what is in the key&#8217;s <code>payload</code> portion.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mysql-server-1.inventory.customers.Key</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of the schema that defines the structure of the key&#8217;s payload. This schema describes the structure of the primary key for the table that was changed. Key schema names have the format <em>connector-name</em>.<em>database-name</em>.<em>table-name</em>.<code>Key</code>. In this example:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mysql-server-1</code> is the name of the connector that generated this event.<br></p>
</li>
<li>
<p><code>inventory</code> is the database that contains the table that was changed.<br></p>
</li>
<li>
<p><code>customers</code> is the table that was updated.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>optional</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the event key must contain a value in its <code>payload</code> field. In this example, a value in the key&#8217;s payload is required. A value in the key&#8217;s payload field is optional when a table does not have a primary key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fields</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies each field that is expected in the <code>payload</code>, including each field&#8217;s name, type, and whether it is required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the key for the row for which this change event was generated. In this example, the key, contains a single <code>id</code> field whose value is <code>1001</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_change_event_values"><a class="anchor" href="#_change_event_values"></a>Change event values</h4>
<div class="paragraph">
<p>The value in a change event is a bit more complicated than the key. Like the key, the value has a <code>schema</code> section and a <code>payload</code> section. The <code>schema</code> section contains the schema that describes the <code>Envelope</code> structure of the <code>payload</code> section, including its nested fields. Change events for operations that create, update or delete data all have a value payload with an envelope structure.</p>
</div>
<div class="paragraph">
<p>Consider the same sample table that was used to show an example of a change event key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE customers (
  id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
  first_name VARCHAR(255) NOT NULL,
  last_name VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE KEY
) AUTO_INCREMENT=1001;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value portion of a change event for a change to this table is described for each event type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#mysql-create-events"><em>create</em> events</a></p>
</li>
<li>
<p><a href="#mysql-update-events"><em>update</em> events</a></p>
</li>
<li>
<p><a href="#mysql-delete-events"><em>delete</em> events</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="mysql-create-events"><a class="anchor" href="#mysql-create-events"></a><em>create</em> events</h5>
<div class="paragraph">
<p>The following example shows the value portion of a change event that the connector generates for an operation that creates data in the <code>customers</code> table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "schema": { <i class="conum" data-value="1"></i><b>(1)</b>
    "type": "struct",
    "fields": [
      {
        "type": "struct",
        "fields": [
          {
            "type": "int32",
            "optional": false,
            "field": "id"
          },
          {
            "type": "string",
            "optional": false,
            "field": "first_name"
          },
          {
            "type": "string",
            "optional": false,
            "field": "last_name"
          },
          {
            "type": "string",
            "optional": false,
            "field": "email"
          }
        ],
        "optional": true,
        "name": "mysql-server-1.inventory.customers.Value", <i class="conum" data-value="2"></i><b>(2)</b>
        "field": "before"
      },
      {
        "type": "struct",
        "fields": [
          {
            "type": "int32",
            "optional": false,
            "field": "id"
          },
          {
            "type": "string",
            "optional": false,
            "field": "first_name"
          },
          {
            "type": "string",
            "optional": false,
            "field": "last_name"
          },
          {
            "type": "string",
            "optional": false,
            "field": "email"
          }
        ],
        "optional": true,
        "name": "mysql-server-1.inventory.customers.Value",
        "field": "after"
      },
      {
        "type": "struct",
        "fields": [
          {
            "type": "string",
            "optional": false,
            "field": "version"
          },
          {
            "type": "string",
            "optional": false,
            "field": "connector"
          },
          {
            "type": "string",
            "optional": false,
            "field": "name"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "ts_sec"
          },
          {
            "type": "boolean",
            "optional": true,
            "default": false,
            "field": "snapshot"
          },
          {
            "type": "string",
            "optional": false,
            "field": "db"
          },
          {
            "type": "string",
            "optional": true,
            "field": "table"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "server_id"
          },
          {
            "type": "string",
            "optional": true,
            "field": "gtid"
          },
          {
            "type": "string",
            "optional": false,
            "field": "file"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "pos"
          },
          {
            "type": "int32",
            "optional": false,
            "field": "row"
          },
          {
            "type": "int64",
            "optional": true,
            "field": "thread"
          },
          {
            "type": "string",
            "optional": true,
            "field": "query"
          }
        ],
        "optional": false,
        "name": "io.debezium.connector.mysql.Source", <i class="conum" data-value="3"></i><b>(3)</b>
        "field": "source"
      },
      {
        "type": "string",
        "optional": false,
        "field": "op"
      },
      {
        "type": "int64",
        "optional": true,
        "field": "ts_ms"
      }
    ],
    "optional": false,
    "name": "mysql-server-1.inventory.customers.Envelope" <i class="conum" data-value="4"></i><b>(4)</b>
  },
  "payload": { <i class="conum" data-value="5"></i><b>(5)</b>
    "op": "c", <i class="conum" data-value="6"></i><b>(6)</b>
    "ts_ms": 1465491411815, <i class="conum" data-value="7"></i><b>(7)</b>
    "before": null, <i class="conum" data-value="8"></i><b>(8)</b>
    "after": { <i class="conum" data-value="9"></i><b>(9)</b>
      "id": 1004,
      "first_name": "Anne",
      "last_name": "Kretchmar",
      "email": "annek@noanswer.org"
    },
    "source": { <i class="conum" data-value="10"></i><b>(10)</b>
      "version": "1.3.1.Final",
      "connector": "mysql",
      "name": "mysql-server-1",
      "ts_sec": 0,
      "snapshot": false,
      "db": "inventory",
      "table": "customers",
      "server_id": 0,
      "gtid": null,
      "file": "mysql-bin.000003",
      "pos": 154,
      "row": 0,
      "thread": 7,
      "query": "INSERT INTO customers (first_name, last_name, email) VALUES ('Anne', 'Kretchmar', 'annek@noanswer.org')"
    }
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Descriptions of <em>create</em> event value fields</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schema</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value&#8217;s schema, which describes the structure of the value&#8217;s payload. A change event&#8217;s value schema is the same in every change event that the connector generates for a particular table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>In the <code>schema</code> section, each <code>name</code> field specifies the schema for a field in the value&#8217;s payload.<br>
<br>
<code>mysql-server-1.inventory.customers.Value</code> is the schema for the payload&#8217;s <code>before</code> and <code>after</code> fields. This schema is specific to the <code>customers</code> table.<br>
<br>
Names of schemas for <code>before</code> and <code>after</code> fields are of the form <code><em>logicalName</em>.<em>tableName</em>.Value</code>, which ensures that the schema name is unique in the database. This means that when using the <a href="../configuration/avro.html" class="page">Avro converter</a>, the resulting Avro schema for each table in each logical source has its own evolution and history.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.debezium.connector.mysql.Source</code> is the schema for the payload&#8217;s <code>source</code> field. This schema is specific to the MySQL connector. The connector uses it for all events that it generates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mysql-server-1.inventory.customers.Envelope</code> is the schema for the overall structure of the payload, where <code>mysql-server-1</code> is the connector name, <code>inventory</code> is the database, and <code>customers</code> is the table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value&#8217;s actual data. This is the information that the change event is providing.<br>
<br>
It may appear that the JSON representations of the events are much larger than the rows they describe. This is because the JSON representation must include the schema and the payload portions of the message.
However, by using the <a href="../configuration/avro.html" class="page">Avro converter</a>, you can significantly decrease the size of the messages that the connector streams to Kafka topics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>op</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory string that describes the type of operation that caused the connector to generate the event. In this example, <code>c</code> indicates that the operation created a row. Valid values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>c</code> = create</p>
</li>
<li>
<p><code>u</code> = update</p>
</li>
<li>
<p><code>d</code> = delete</p>
</li>
<li>
<p><code>r</code> = read (applies to only snapshots)</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ts_ms</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional field that displays the time at which the connector processed the event. The time is based on the system clock in the JVM running the Kafka Connect task.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>before</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional field that specifies the state of the row before the event occurred. When the <code>op</code> field is <code>c</code> for create, as it is in this example, the <code>before</code> field is <code>null</code> since this change event is for new content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>after</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional field that specifies the state of the row after the event occurred. In this example, the <code>after</code> field contains the values of the new row&#8217;s <code>id</code>, <code>first_name</code>, <code>last_name</code>, and <code>email</code> columns.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory field that describes the source metadata for the event. This field contains information that you can use to compare this event with other events, with regard to the origin of the events, the order in which the events occurred, and whether events were part of the same transaction. The source metadata includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debezium version</p>
</li>
<li>
<p>Connector name</p>
</li>
<li>
<p>binlog name where the event was recorded</p>
</li>
<li>
<p>binlog position</p>
</li>
<li>
<p>Row within the event</p>
</li>
<li>
<p>If the event was part of a snapshot</p>
</li>
<li>
<p>Name of the database and table that contain the new row</p>
</li>
<li>
<p>ID of the MySQL thread that created the event (non-snapshot only)</p>
</li>
<li>
<p>MySQL server ID (if available)</p>
</li>
<li>
<p>Timestamp</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="#enable-query-log-events-for-cdc_debezium"><code>binlog_rows_query_log_events</code></a> MySQL configuration option is enabled and the connector configuration <code>include.query</code> property is enabled, the <code>source</code> field also provides the <code>query</code> field, which contains the original SQL statement that caused the change event.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="mysql-update-events"><a class="anchor" href="#mysql-update-events"></a><em>update</em> events</h5>
<div class="paragraph">
<p>The value of a change event for an update in the sample <code>customers</code> table has the same schema as a <em>create</em> event for that table. Likewise, the event value&#8217;s payload has the same structure. However, the event value payload contains different values in an <em>update</em> event. Here is an example of a change event value in an event that the connector generates for an update in the <code>customers</code> table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "schema": { ... },
  "payload": {
    "before": { <i class="conum" data-value="1"></i><b>(1)</b>
      "id": 1004,
      "first_name": "Anne",
      "last_name": "Kretchmar",
      "email": "annek@noanswer.org"
    },
    "after": { <i class="conum" data-value="2"></i><b>(2)</b>
      "id": 1004,
      "first_name": "Anne Marie",
      "last_name": "Kretchmar",
      "email": "annek@noanswer.org"
    },
    "source": { <i class="conum" data-value="3"></i><b>(3)</b>
      "version": "1.3.1.Final",
      "name": "mysql-server-1",
      "connector": "mysql",
      "name": "mysql-server-1",
      "ts_sec": 1465581,
      "snapshot": false,
      "db": "inventory",
      "table": "customers",
      "server_id": 223344,
      "gtid": null,
      "file": "mysql-bin.000003",
      "pos": 484,
      "row": 0,
      "thread": 7,
      "query": "UPDATE customers SET first_name='Anne Marie' WHERE id=1004"
    },
    "op": "u", <i class="conum" data-value="4"></i><b>(4)</b>
    "ts_ms": 1465581029523
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Descriptions of <em>update</em> event value fields</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>before</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional field that specifies the state of the row before the event occurred. In an <em>update</em> event value, the <code>before</code> field contains a field for each table column and the value that was in that column before the database commit. In this example, the <code>first_name</code> value is <code>Anne.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>after</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional field that specifies the state of the row after the event occurred. You can compare the <code>before</code> and <code>after</code> structures to determine what the update to this row was. In the example, the <code>first_name</code> value is now <code>Anne Marie</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory field that describes the source metadata for the event. The <code>source</code> field structure has the same fields as in a <em>create</em> event, but some values are different, for example, the sample <em>update</em> event is from a different position in the binlog. The source metadata includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debezium version</p>
</li>
<li>
<p>Connector name</p>
</li>
<li>
<p>binlog name where the event was recorded</p>
</li>
<li>
<p>binlog position</p>
</li>
<li>
<p>Row within the event</p>
</li>
<li>
<p>If the event was part of a snapshot</p>
</li>
<li>
<p>Name of the database and table that contain the updated row</p>
</li>
<li>
<p>ID of the MySQL thread that created the event (non-snapshot only)</p>
</li>
<li>
<p>MySQL server ID (if available)</p>
</li>
<li>
<p>Timestamp</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="#enable-query-log-events-for-cdc_debezium"><code>binlog_rows_query_log_events</code></a> MySQL configuration option is enabled and the connector configuration <code>include.query</code> property is enabled, the <code>source</code> field also provides the <code>query</code> field, which contains the original SQL statement that caused the change event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>op</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory string that describes the type of operation. In an <em>update</em> event value, the <code>op</code> field value is <code>u</code>, signifying that this row changed because of an update.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Updating the columns for a row&#8217;s primary/unique key changes the value of the row&#8217;s key. When a key changes, Debezium outputs <em>three</em> events: a <code>DELETE</code> event and a <a href="#mysql-tombstone-events">tombstone event</a> with the old key for the row, followed by an event with the new key for the row. Details are in the next section.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="mysql-primary-key-updates"><a class="anchor" href="#mysql-primary-key-updates"></a>Primary key updates</h5>
<div class="paragraph">
<p>An <code>UPDATE</code> operation that changes a row&#8217;s primary key field(s) is known
as a primary key change. For a primary key change, in place of an <code>UPDATE</code> event record, the connector emits a <code>DELETE</code> event record for the old key and a <code>CREATE</code> event record for the new (updated) key. These events have the usual structure and content, and in addition, each one has a message header related to the primary key change:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>DELETE</code> event record has <code>__debezium.newkey</code> as a message header. The value of this header is the new primary key for the updated row.</p>
</li>
<li>
<p>The <code>CREATE</code> event record has <code>__debezium.oldkey</code> as a message header. The value of this header is the previous (old) primary key that the updated row had.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="mysql-delete-events"><a class="anchor" href="#mysql-delete-events"></a><em>delete</em> events</h5>
<div class="paragraph">
<p>The value in a <em>delete</em> change event has the same <code>schema</code> portion as <em>create</em> and <em>update</em> events for the same table. The <code>payload</code> portion in a <em>delete</em> event for the sample <code>customers</code> table looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "schema": { ... },
  "payload": {
    "before": { <i class="conum" data-value="1"></i><b>(1)</b>
      "id": 1004,
      "first_name": "Anne Marie",
      "last_name": "Kretchmar",
      "email": "annek@noanswer.org"
    },
    "after": null, <i class="conum" data-value="2"></i><b>(2)</b>
    "source": { <i class="conum" data-value="3"></i><b>(3)</b>
      "version": "1.3.1.Final",
      "connector": "mysql",
      "name": "mysql-server-1",
      "ts_sec": 1465581,
      "snapshot": false,
      "db": "inventory",
      "table": "customers",
      "server_id": 223344,
      "gtid": null,
      "file": "mysql-bin.000003",
      "pos": 805,
      "row": 0,
      "thread": 7,
      "query": "DELETE FROM customers WHERE id=1004"
    },
    "op": "d", <i class="conum" data-value="4"></i><b>(4)</b>
    "ts_ms": 1465581902461 <i class="conum" data-value="5"></i><b>(5)</b>
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Descriptions of <em>delete</em> event value fields</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>before</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that specifies the state of the row before the event occurred. In a <em>delete</em> event value, the <code>before</code> field contains the values that were in the row before it was deleted with the database commit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>after</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that specifies the state of the row after the event occurred. In a <em>delete</em> event value, the <code>after</code> field is <code>null</code>, signifying that the row no longer exists.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory field that describes the source metadata for the event. In a <em>delete</em> event value, the <code>source</code> field structure is the same as for <em>create</em> and <em>update</em> events for the same table. Many <code>source</code> field values are also the same. In a <em>delete</em> event value, the <code>ts_ms</code> and <code>pos</code> field values, as well as other values, might have changed. But the <code>source</code> field in a <em>delete</em> event value provides the same metadata:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debezium version</p>
</li>
<li>
<p>Connector name</p>
</li>
<li>
<p>binlog name where the event was recorded</p>
</li>
<li>
<p>binlog position</p>
</li>
<li>
<p>Row within the event</p>
</li>
<li>
<p>If the event was part of a snapshot</p>
</li>
<li>
<p>Name of the database and table that contain the updated row</p>
</li>
<li>
<p>ID of the MySQL thread that created the event (non-snapshot only)</p>
</li>
<li>
<p>MySQL server ID (if available)</p>
</li>
<li>
<p>Timestamp</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="#enable-query-log-events-for-cdc_debezium"><code>binlog_rows_query_log_events</code></a> MySQL configuration option is enabled and the connector configuration <code>include.query</code> property is enabled, the <code>source</code> field also provides the <code>query</code> field, which contains the original SQL statement that caused the change event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>op</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory string that describes the type of operation. The <code>op</code> field value is <code>d</code>, signifying that this row was deleted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ts_ms</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional field that displays the time at which the connector processed the event. The time is based on the system clock in the JVM running the Kafka Connect task.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A <em>delete</em> change event record provides a consumer with the information it needs to process the removal of this row. The old values are included because some consumers might require them in order to properly handle the removal.</p>
</div>
<div class="paragraph">
<p>MySQL connector events are designed to work with <a href="https://kafka.apache.org/documentation/#compaction">Kafka log compaction</a>. Log compaction enables removal of some older messages as long as at least the most recent message for every key is kept. This lets Kafka reclaim storage space while ensuring that the topic contains a complete data set and can be used for reloading key-based state.</p>
</div>
<div id="mysql-tombstone-events" class="paragraph">
<div class="title">Tombstone events</div>
<p>When a row is deleted, the <em>delete</em> event value still works with log compaction, because Kafka can remove all earlier messages that have that same key. However, for Kafka to remove all messages that have that same key, the message value must be <code>null</code>. To make this possible, after Debezium’s MySQL connector emits a <em>delete</em> event, the connector emits a special tombstone event that has the same key but a <code>null</code> value.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="how-the-mysql-connector-maps-data-types_debezium"><a class="anchor" href="#how-the-mysql-connector-maps-data-types_debezium"></a>How the MySQL connector maps data types</h3>
<div class="paragraph">
<p>The Debezium MySQL connector represents changes to rows with events that are structured like the table in which the row exists. The event contains a field for each column value. The MySQL data type of that column dictates how the value is represented in the event.</p>
</div>
<div class="paragraph">
<p>Columns that store strings are defined in MySQL with a character set and collation. The MySQL connector uses the column&#8217;s character set when reading the binary representation of the column values in the binlog events. The following table shows how the connector maps the MySQL data types to both <em>literal</em> and <em>semantic</em> types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>literal type</strong> : how the value is represented using Kafka Connect schema types</p>
</li>
<li>
<p><strong>semantic type</strong> : how the Kafka Connect schema captures the meaning of the field (schema name)</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BOOLEAN, BOOL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BOOLEAN</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BIT(1)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BOOLEAN</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BIT(&gt;1)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.Bits</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>length</code> schema parameter contains an integer that represents the number of bits. The <code>byte[]</code> contains the bits in <em>little-endian</em> form and is sized to contain the specified number of bits.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">example (where n is bits)</div>
<div class="content">
<pre>numBytes = n/8 + (n%8== 0 ? 0 : 1)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TINYINT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT16</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SMALLINT[(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT16</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MEDIUMINT[(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT32</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT, INTEGER[(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT32</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BIGINT[(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REAL[(M,D)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT32</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT[(M,D)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DOUBLE[(M,D)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CHAR(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VARCHAR(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BINARY(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code> or <code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div>
<div class="paragraph">
<p>Either the raw bytes (the default), a base64-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode">binary handling mode</a> setting</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>VARBINARY(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code> or <code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div>
<div class="paragraph">
<p>Either the raw bytes (the default), a base64-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode">binary handling mode</a> setting</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TINYBLOB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code> or <code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div>
<div class="paragraph">
<p>Either the raw bytes (the default), a base64-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode">binary handling mode</a> setting</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TINYTEXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BLOB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code> or <code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div>
<div class="paragraph">
<p>Either the raw bytes (the default), a base64-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode">binary handling mode</a> setting</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MEDIUMBLOB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code> or <code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div>
<div class="paragraph">
<p>Either the raw bytes (the default), a base64-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode">binary handling mode</a> setting</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MEDIUMTEXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LONGBLOB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code> or <code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div>
<div class="paragraph">
<p>Either the raw bytes (the default), a base64-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode">binary handling mode</a> setting</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LONGTEXT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JSON</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.Json</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Contains the string representation of a <code>JSON</code> document, array, or scalar.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ENUM</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.Enum</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>allowed</code> schema parameter contains the comma-separated list of allowed values.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.EnumSet</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>allowed</code> schema parameter contains the comma-separated list of allowed values.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>YEAR[(2|4)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.debezium.time.Year</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMESTAMP[(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.ZonedTimestamp</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a> format with microsecond precision. MySQL allows <code>M</code> to be in the range of <code>0-6</code>.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_temporal_values"><a class="anchor" href="#_temporal_values"></a>Temporal values</h4>
<div class="paragraph">
<p>Excluding the <code>TIMESTAMP</code> data type, MySQL temporal types depend on the value of the <code>time.precision.mode</code> configuration property. For <code>TIMESTAMP</code> columns whose default value is specified as <code>CURRENT_TIMESTAMP</code> or <code>NOW</code>, the value <code>1970-01-01 00:00:00</code> is used as the default value in the Kafka Connect schema.</p>
</div>
<div class="paragraph">
<p>MySQL allows zero-values for <code>DATE, `DATETIME</code>, and <code>TIMESTAMP</code> columns because zero-values are sometimes preferred over null values. The MySQL connector represents zero-values as null values when the column definition allows null values, or as the epoch day when the column does not allow null values.</p>
</div>
<div class="paragraph">
<div class="title">Temporal values without time zones</div>
<p>The <code>DATETIME</code> type represents a local date and time such as "2018-01-13 09:48:27". As you can see, there is no time zone information. Such columns are converted into epoch milli-seconds or micro-seconds based on the column’s precision by using UTC. The <code>TIMESTAMP</code> type represents a timestamp without time zone information and is converted by MySQL from the server (or session’s) current time zone into UTC when writing and vice versa when reading back the value. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DATETIME</code> with a value of <code>2018-06-20 06:37:03</code> becomes <code>1529476623000</code>.</p>
</li>
<li>
<p><code>TIMESTAMP</code> with a value of <code>2018-06-20 06:37:03</code> becomes <code>2018-06-20T13:37:03Z</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such columns are converted into an equivalent <code>io.debezium.time.ZonedTimestamp</code> in UTC based on the server (or session’s) current time zone. The time zone will be queried from the server by default. If this fails, it must be specified explicitly by the <code>database.serverTimezone</code> connector configuration property. For example, if the database’s time zone (either globally or configured for the connector by means of the <code>database.serverTimezone property</code>) is "America/Los_Angeles", the TIMESTAMP value "2018-06-20 06:37:03" is represented by a <code>ZonedTimestamp</code> with the value "2018-06-20T13:37:03Z".</p>
</div>
<div class="paragraph">
<p>Note that the time zone of the JVM running Kafka Connect and Debezium does not affect these conversions.</p>
</div>
<div class="paragraph">
<p>More details about properties related to termporal values are in the documentation for <a href="#mysql-connector-configuration-properties_debezium">MySQL connector configuration properties</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">time.precision.mode=adaptive_time_microseconds(default)</dt>
<dd>
<p>The MySQL connector determines the literal type and semantic type based on the column&#8217;s data type definition so that events represent exactly the values in the database. All time fields are in microseconds. Only positive <code>TIME</code> field values in the range of <code>00:00:00.000000</code> to <code>23:59:59.999999</code> can be captured correctly.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT32</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.Date</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Represents the number of days since epoch.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIME[(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.MicroTime</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Represents the time value in microseconds and does not include time zone information. MySQL allows <code>M</code> to be in the range of <code>0-6</code>.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATETIME, DATETIME(0), DATETIME(1), DATETIME(2), DATETIME(3)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.Timestamp</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Represents the number of milliseconds past epoch and does not include time zone information.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATETIME(4), DATETIME(5), DATETIME(6)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.MicroTimestamp</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Represents the number of microseconds past epoch and does not include time zone information.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">time.precision.mode=connect</dt>
<dd>
<p>The MySQL connector uses the predefined Kafka Connect logical types. This approach is less precise than the default approach and the events could be less precise if the database column has a <em>fractional second precision</em> value of greater than <code>3</code>. Only values in the range of <code>00:00:00.000</code> to <code>23:59:59.999</code> can be handled. Set <code>time.precision.mode=connect</code> only if you can ensure that the <code>TIME</code> values in your tables never exceed the supported ranges. The <code>connect</code> setting is expected to be removed in a future version of Debezium.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT32</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Date</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Represents the number of days since epoch.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIME[(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Time</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Represents the time value in microseconds since midnight and does not include time zone information.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATETIME[(M)]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Timestamp</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Represents the number of milliseconds since epoch, and does not include time zone information.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_decimal_values"><a class="anchor" href="#_decimal_values"></a>Decimal values</h4>
<div class="paragraph">
<p>Decimals are handled via the <code>decimal.handling.mode</code> property.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#mysql-connector-configuration-properties_debezium">MySQL connector configuration properties</a> for more details.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">decimal.handling.mode=precise</dt>
<dd>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NUMERIC[(M[,D])]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Decimal</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>scale</code> schema parameter contains an integer that represents how many digits the decimal point shifted.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DECIMAL[(M[,D])]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BYTES</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Decimal</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>scale</code> schema parameter contains an integer that represents how many digits the decimal point shifted.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">decimal.handling.mode=double</dt>
<dd>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NUMERIC[(M[,D])]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DECIMAL[(M[,D])]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FLOAT64</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">decimal.handling.mode=string</dt>
<dd>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NUMERIC[(M[,D])]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DECIMAL[(M[,D])]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRING</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_boolean_values"><a class="anchor" href="#_boolean_values"></a>Boolean values</h4>
<div class="paragraph">
<p>MySQL handles the <code>BOOLEAN</code> value internally in a specific way.
The <code>BOOLEAN</code> column is internally mapped to <code>TINYINT(1)</code> datatype.
When the table is created during streaming then it uses proper <code>BOOLEAN</code> mapping as Debezium receives the original DDL.
During snapshot Debezium executes <code>SHOW CREATE TABLE</code> to obtain table definition which returns <code>TINYINT(1)</code> for both <code>BOOLEAN</code> and <code>TINYINT(1)</code> columns.</p>
</div>
<div class="paragraph">
<p>Debezium then has no way how to obtain the original type mapping and will map to <code>TINYINT(1)</code>.
The operator can configure the out-of-the-box <a href="../development/converters.html" class="page">custom converter</a> <code>TinyIntOneToBooleanConverter</code> that would either map all <code>TINYINT(1)</code> columns to <code>BOOLEAN</code> or if <code>selector</code> parameter is set then a subset of columns could be enumerated using comma-separated regular expressions.</p>
</div>
<div class="paragraph">
<p>An example configuration is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>converters=boolean
boolean.type=io.debezium.connector.mysql.converters.TinyIntOneToBooleanConverter
boolean.selector=db1.table1.*, db1.table2.column1</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spatial_data_types"><a class="anchor" href="#_spatial_data_types"></a>Spatial data types</h4>
<div class="paragraph">
<p>Currently, the Debezium MySQL connector supports the following spatial data types:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GEOMETRY, LINESTRING, POLYGON, MULTIPOINT, MULTILINESTRING, MULTIPOLYGON, GEOMETRYCOLLECTION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STRUCT</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.geometry.Geometry</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Contains a structure with two fields:
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><code>srid (INT32</code>: a spatial reference system id that defines the type of geometry object stored in the structure</p>
</li>
<li>
<p><code>wkb (BYTES)</code>: a binary representation of the geometry object encoded in the Well-Known-Binary (wkb) format. See the <a href="https://www.opengeospatial.org/standards/sfa">Open Geospatial Consortium</a> for more details.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="the-mysql-connector-and-kafka-topics_debezium"><a class="anchor" href="#the-mysql-connector-and-kafka-topics_debezium"></a>The MySQL connector and Kafka topics</h3>
<div class="paragraph">
<p>The Debezium MySQL connector writes events for all <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> operations from a single table to a single Kafka topic. The Kafka topic naming convention is as follows:</p>
</div>
<div class="listingblock">
<div class="title">format</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">serverName.databaseName.tableName</code></pre>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 1. example</div>
<div class="content">
<div class="paragraph">
<p>Let us say that <code>fulfillment</code> is the server name and <code>inventory</code> is the database which contains <strong>three</strong> tables of <code>orders</code>, <code>customers</code>, and <code>products</code>. The Debezium MySQL connector produces events on three Kafka topics, one for each table in the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">fulfillment.inventory.orders

fulfillment.inventory.customers

fulfillment.inventory.products</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mysql-supported-topologies_debezium"><a class="anchor" href="#mysql-supported-topologies_debezium"></a>MySQL supported topologies</h3>
<div class="paragraph">
<p>The Debezium MySQL connector supports the following MySQL topologies:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Standalone</dt>
<dd>
<p>When a single MySQL server is used, the server must have the binlog enabled (<em>and optionally GTIDs enabled</em>) so the Debezium MySQL connector can monitor the server. This is often acceptable, since the binary log can also be used as an incremental <a href="https://dev.mysql.com/doc/refman/8.0/en/backup-methods.html">backup</a>. In this case, the MySQL connector always connects to and follows this standalone MySQL server instance.</p>
</dd>
<dt class="hdlist1">Primary and replica</dt>
<dd>
<p>The Debezium MySQL connector can follow one of the primary servers or one of the replicas (<em>if that replica has its binlog enabled</em>), but the connector only sees changes in the cluster that are visible to that server. Generally, this is not a problem except for the multi-primary topologies.</p>
<div class="paragraph">
<p>The connector records its position in the server’s binlog, which is different on each server in the cluster. Therefore, the connector will need to follow just one MySQL server instance. If that server fails, it must be restarted or recovered before the connector can continue.</p>
</div>
</dd>
<dt class="hdlist1">High available clusters</dt>
<dd>
<p>A variety of <a href="https://dev.mysql.com/doc/mysql-ha-scalability/en/">high availability</a> solutions exist for MySQL, and they make it far easier to tolerate and almost immediately recover from problems and failures. Most HA MySQL clusters use GTIDs so that replicas are able to keep track of all changes on any of the primary servers.</p>
</dd>
<dt class="hdlist1">Multi-primary</dt>
<dd>
<p>A link: <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql-cluster-replication-multi-source.html">NDB Cluster Replication</a> uses one or more MySQL replica nodes that each replicate from multiple primary servers. This is a powerful way to aggregate the replication of multiple MySQL clusters, and requires using GTIDs.</p>
<div class="paragraph">
<p>The Debezium MySQL connector can use these multi-primary MySQL replicas as sources, and can fail over to different multi-primary MySQL replicas as long as thew new replica is caught up to the old replica (<em>e.g., the new replica has all the transactions that were last seen on the first replica</em>). This works even if the connector is only using a subset of databases and/or tables, as the connector can be configured to include or exclude specific GTID sources when attempting to reconnect to a new multi-primary MySQL replica and find the correct position in the binlog.</p>
</div>
</dd>
<dt class="hdlist1">Hosted</dt>
<dd>
<p>There is support for the Debezium MySQL connector to use hosted options such as Amazon RDS and Amazon Aurora.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Because these hosted options do not allow a <strong>global read lock</strong>, table-level locks are used to create the <em>consistent snapshot</em>.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setup-the-mysql-server"><a class="anchor" href="#setup-the-mysql-server"></a>Setting up MySQL server</h2>
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#overview-of-how-the-mysql-connector-works">Overview of how the MySQL connector works</a>
<ul class="sectlevel2">
<li><a href="#how-the-mysql-connector-uses-database-schemas_debezium">How the MySQL connector uses database schemas</a></li>
<li><a href="#how-the-mysql-connector-performs-database-snapshots_debezium">How the MySQL connector performs database snapshots</a></li>
<li><a href="#how-the-mysql-connector-exposes-schema-changes">How the MySQL connector exposes schema changes</a></li>
<li><a href="#mysql-connector-events_debezium">MySQL connector events</a></li>
<li><a href="#how-the-mysql-connector-maps-data-types_debezium">How the MySQL connector maps data types</a></li>
<li><a href="#the-mysql-connector-and-kafka-topics_debezium">The MySQL connector and Kafka topics</a></li>
<li><a href="#mysql-supported-topologies_debezium">MySQL supported topologies</a></li>
</ul>
</li>
<li><a href="#setup-the-mysql-server">Setting up MySQL server</a>
<ul class="sectlevel2">
<li><a href="#create-a-mysql-user-for-cdc_debezium">Creating a MySQL user for Debezium</a></li>
<li><a href="#enable-the-mysql-binlog-for-cdc_debezium">Enabling the MySQL binlog for Debezium</a></li>
<li><a href="#enable-mysql-gtids-for-cdc_debezium">Enabling MySQL Global Transaction Identifiers for Debezium</a></li>
<li><a href="#setup-session-timeouts-for-cdc_debezium">Setting up session timeouts for Debezium</a></li>
<li><a href="#enable-query-log-events-for-cdc_debezium">Enabling query log events for Debezium</a></li>
</ul>
</li>
<li><a href="#deploy-the-mysql-connector">Deploying the MySQL connector</a>
<ul class="sectlevel2">
<li><a href="#install-the-mysql-connector_debezium">Installing the MySQL connector</a></li>
<li><a href="#configure-the-mysql-connector_debezium">Configuring the MySQL connector</a></li>
<li><a href="#add-mysql-connector-configuration-to-kafka-connect">Adding MySQL connector configuration to Kafka Connect</a></li>
<li><a href="#mysql-connector-configuration-properties_debezium">MySQL connector configuration properties</a></li>
<li><a href="#mysql-connector-monitoring-metrics_debezium">MySQL connector monitoring metrics</a></li>
</ul>
</li>
<li><a href="#connector-common-issues">MySQL connector common issues</a>
<ul class="sectlevel2">
<li><a href="#configuration-and-startup-errors_debezium">Configuration and startup errors</a></li>
<li><a href="#mysql-is-unavailable_debezium">MySQL is unavailable</a></li>
<li><a href="#kafka-connect-stops_debezium">Kafka Connect stops</a></li>
<li><a href="#mysql-purges-binlog-files_debezium">MySQL purges binlog files</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="create-a-mysql-user-for-cdc_debezium"><a class="anchor" href="#create-a-mysql-user-for-cdc_debezium"></a>Creating a MySQL user for Debezium</h3>
<div class="paragraph">
<p>You have to define a MySQL user with appropriate permissions on all databases that the Debezium MySQL connector monitors.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have a MySQL server.</p>
</li>
<li>
<p>You must know basic SQL commands.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create the MySQL user:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; CREATE USER 'user'@'localhost' IDENTIFIED BY 'password';</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Grant the required permissions to the user:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; GRANT SELECT, RELOAD, SHOW DATABASES, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'user' IDENTIFIED BY 'password';</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#permissions-explained-mysql-connector">permissions explained</a> for notes on each permission.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If using a hosted option such as Amazon RDS or Amazon Aurora that do not allow a <strong>global read lock</strong>, table-level locks are used to create the <em>consistent snapshot</em>. In this case, you need to also grant <code>LOCK_TABLES</code> permissions to the user that you create. See <a href="#overview-of-how-the-mysql-connector-works">Overview of how the MySQL connector works</a> for more details.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Finalize the user&#8217;s permissions:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; FLUSH PRIVILEGES;</pre>
</div>
</div>
<div class="sect3">
<h4 id="_permissions_explained"><a class="anchor" href="#_permissions_explained"></a>Permissions explained</h4>
<table id="permissions-explained-mysql-connector" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission/item</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>enables the connector to select rows from tables in databases</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is only used when performing a snapshot.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RELOAD</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>enables the connector the use of the <code>FLUSH</code> statement to clear or reload internal caches, flush tables, or acquire locks.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is only used when performing a snapshot.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SHOW DATABASES</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>enables the connector to see database names by issuing the <code>SHOW DATABASE</code> statement.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is only used when performing a snapshot.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPLICATION SLAVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">enables the connector to connect to and read the MySQL server binlog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPLICATION CLIENT</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>enables the connector the use of following statements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SHOW MASTER STATUS</code></p>
</li>
<li>
<p><code>SHOW SLAVE STATUS</code></p>
</li>
<li>
<p><code>SHOW BINARY LOGS</code></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This is always required for the connector.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ON</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Identifies the <strong>database</strong> to which the permission apply.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TO 'user'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the <strong>user</strong> to which the permissions are granted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IDENTIFIED BY 'password'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the <strong>password</strong> for the user.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="enable-the-mysql-binlog-for-cdc_debezium"><a class="anchor" href="#enable-the-mysql-binlog-for-cdc_debezium"></a>Enabling the MySQL binlog for Debezium</h3>
<div class="paragraph">
<p>You must enable binary logging for MySQL replication. The binary logs record transaction updates for replication tools to propagate changes.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have a MySQL server.</p>
</li>
<li>
<p>You should have appropriate MySQL user privileges.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Check if the <code>log-bin</code> option is already on or not.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; SELECT variable_value as "BINARY LOGGING STATUS (log-bin) ::"
FROM information_schema.global_variables WHERE variable_name='log_bin';</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>If <code>OFF</code>, configure your MySQL server configuration file with the following:</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#binlog-configuration-properties-mysql-connector">Binlog config properties</a> for notes on each property.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">server-id         = 223344 <i class="conum" data-value="1"></i><b>(1)</b>
log_bin           = mysql-bin <i class="conum" data-value="2"></i><b>(2)</b>
binlog_format     = ROW <i class="conum" data-value="3"></i><b>(3)</b>
binlog_row_image  = FULL <i class="conum" data-value="4"></i><b>(4)</b>
expire_logs_days  = 10 <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Confirm your changes by checking the binlog status once more.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; SELECT variable_value as "BINARY LOGGING STATUS (log-bin) ::"
FROM information_schema.global_variables WHERE variable_name='log_bin';</pre>
</div>
</div>
<div class="sect3">
<h4 id="_binlog_configuration_properties"><a class="anchor" href="#_binlog_configuration_properties"></a>Binlog configuration properties</h4>
<table id="binlog-configuration-properties-mysql-connector" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number</th>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server-id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value for the <code>server-id</code> must be unique for each server and replication client within the MySQL cluster. When the MySQL connector is setup, we assign the connector a unique server ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log_bin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of <code>log_bin</code> is the base name of the sequence of binlog files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binlog_format</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>binlog-format</code> must be set to <code>ROW</code> or <code>row</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binlog_row_image</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>binlog_row_image</code> must be set to <code>FULL</code> or <code>full</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>expire_logs_days</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>This is the number of days for automatic binlog file removal. The default is <code>0</code> which means no automatic removal.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Set the value to match the needs of your environment.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="enable-mysql-gtids-for-cdc_debezium"><a class="anchor" href="#enable-mysql-gtids-for-cdc_debezium"></a>Enabling MySQL Global Transaction Identifiers for Debezium</h3>
<div class="paragraph">
<p>Global transaction identifiers (GTIDs) uniquely identify transactions that occur on a server within a cluster. Though not required for the Debezium MySQL connector, using GTIDs simplifies replication and allows you to more easily confirm if primary and replica servers are consistent.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
GTIDs are only available from MySQL 5.6.5 and later. See the <a href="https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html#option_mysqld_gtid-mode">MySQL documentation</a> for more details.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have a MySQL server.</p>
</li>
<li>
<p>You must know basic SQL commands.</p>
</li>
<li>
<p>You must have access to the MySQL configuration file.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enable <code>gtid_mode</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; gtid_mode=ON</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Enable <code>enforce_gtid_consistency</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; enforce_gtid_consistency=ON</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Confirm the changes:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; show global variables like '%GTID%';</pre>
</div>
</div>
<div class="listingblock">
<div class="title">response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| enforce_gtid_consistency | ON    |
| gtid_mode                | ON    |
+--------------------------+-------+</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_options_explained"><a class="anchor" href="#_options_explained"></a>Options explained</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission/item</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gtid_mode</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean which specifies whether GTID mode of the MySQL server is enabled or not.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ON</code> = enabled</p>
</li>
<li>
<p><code>OFF</code> = disabled</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enforce_gtid_consistency</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean which instructs the server whether or not to enforce GTID consistency by allowing the execution of statements that can be logged in a transactionally safe manner; required when using GTIDs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ON</code> = enabled</p>
</li>
<li>
<p><code>OFF</code> = disabled</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="setup-session-timeouts-for-cdc_debezium"><a class="anchor" href="#setup-session-timeouts-for-cdc_debezium"></a>Setting up session timeouts for Debezium</h3>
<div class="paragraph">
<p>When an initial consistent snapshot is made for large databases, your established connection could timeout while the tables are being read. You can prevent this behavior by configuring <code>interactive_timeout</code> and <code>wait_timeout</code> in your MySQL configuration file.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have a MySQL server.</p>
</li>
<li>
<p>You must know basic SQL commands.</p>
</li>
<li>
<p>You must have access to the MySQL configuration file.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Configure <code>interactive_timeout</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; interactive_timeout=&lt;duration-in-seconds&gt;</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Configure <code>wait_timeout</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; wait_timeout= &lt;duration-in-seconds&gt;</pre>
</div>
</div>
<div class="sect3">
<h4 id="_options_explained_2"><a class="anchor" href="#_options_explained_2"></a>Options explained</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission/item</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interactive_timeout</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of seconds the server waits for activity on an interactive connection before closing it.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_interactive_timeout">MySQL&#8217;s documentation</a> for more details.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>wait_timeout</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of seconds the server waits for activity on a noninteractive connection before closing it.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_wait_timeout">MySQL&#8217;s documentation</a> for more details.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="enable-query-log-events-for-cdc_debezium"><a class="anchor" href="#enable-query-log-events-for-cdc_debezium"></a>Enabling query log events for Debezium</h3>
<div class="paragraph">
<p>You might want to see the original <code>SQL</code> statement for each binlog event. Enabling the <code>binlog_rows_query_log_events</code> option in the MySQL configuration file allows you to do this.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This option is only available from MySQL 5.6 and later.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have a MySQL server.</p>
</li>
<li>
<p>You must know basic SQL commands.</p>
</li>
<li>
<p>You must have access to the MySQL configuration file.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enable <code>binlog_rows_query_log_events</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; binlog_rows_query_log_events=ON</pre>
</div>
</div>
<div class="sect3">
<h4 id="_options_explained_3"><a class="anchor" href="#_options_explained_3"></a>Options explained</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Permission/item</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binlog_rows_query_log_events`</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean which enables/disables support for including the original <code>SQL</code> statement in the binlog entry.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ON</code> = enabled</p>
</li>
<li>
<p><code>OFF</code> = disabled</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy-the-mysql-connector"><a class="anchor" href="#deploy-the-mysql-connector"></a>Deploying the MySQL connector</h2>
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#overview-of-how-the-mysql-connector-works">Overview of how the MySQL connector works</a>
<ul class="sectlevel2">
<li><a href="#how-the-mysql-connector-uses-database-schemas_debezium">How the MySQL connector uses database schemas</a></li>
<li><a href="#how-the-mysql-connector-performs-database-snapshots_debezium">How the MySQL connector performs database snapshots</a></li>
<li><a href="#how-the-mysql-connector-exposes-schema-changes">How the MySQL connector exposes schema changes</a></li>
<li><a href="#mysql-connector-events_debezium">MySQL connector events</a></li>
<li><a href="#how-the-mysql-connector-maps-data-types_debezium">How the MySQL connector maps data types</a></li>
<li><a href="#the-mysql-connector-and-kafka-topics_debezium">The MySQL connector and Kafka topics</a></li>
<li><a href="#mysql-supported-topologies_debezium">MySQL supported topologies</a></li>
</ul>
</li>
<li><a href="#setup-the-mysql-server">Setting up MySQL server</a>
<ul class="sectlevel2">
<li><a href="#create-a-mysql-user-for-cdc_debezium">Creating a MySQL user for Debezium</a></li>
<li><a href="#enable-the-mysql-binlog-for-cdc_debezium">Enabling the MySQL binlog for Debezium</a></li>
<li><a href="#enable-mysql-gtids-for-cdc_debezium">Enabling MySQL Global Transaction Identifiers for Debezium</a></li>
<li><a href="#setup-session-timeouts-for-cdc_debezium">Setting up session timeouts for Debezium</a></li>
<li><a href="#enable-query-log-events-for-cdc_debezium">Enabling query log events for Debezium</a></li>
</ul>
</li>
<li><a href="#deploy-the-mysql-connector">Deploying the MySQL connector</a>
<ul class="sectlevel2">
<li><a href="#install-the-mysql-connector_debezium">Installing the MySQL connector</a></li>
<li><a href="#configure-the-mysql-connector_debezium">Configuring the MySQL connector</a></li>
<li><a href="#add-mysql-connector-configuration-to-kafka-connect">Adding MySQL connector configuration to Kafka Connect</a></li>
<li><a href="#mysql-connector-configuration-properties_debezium">MySQL connector configuration properties</a></li>
<li><a href="#mysql-connector-monitoring-metrics_debezium">MySQL connector monitoring metrics</a></li>
</ul>
</li>
<li><a href="#connector-common-issues">MySQL connector common issues</a>
<ul class="sectlevel2">
<li><a href="#configuration-and-startup-errors_debezium">Configuration and startup errors</a></li>
<li><a href="#mysql-is-unavailable_debezium">MySQL is unavailable</a></li>
<li><a href="#kafka-connect-stops_debezium">Kafka Connect stops</a></li>
<li><a href="#mysql-purges-binlog-files_debezium">MySQL purges binlog files</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="install-the-mysql-connector_debezium"><a class="anchor" href="#install-the-mysql-connector_debezium"></a>Installing the MySQL connector</h3>
<div class="paragraph">
<p>Installing the Debezium MySQL connector is a simple process whereby you only need to download the JAR, extract it to your Kafka Connect environment, and ensure the plug-in&#8217;s parent directory is specified in your Kafka Connect environment.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have <a href="https://zookeeper.apache.org/">Zookeeper</a>, <a href="http://kafka.apache.org/">Kafka</a>, and <a href="https://kafka.apache.org/documentation.html#connect">Kafka Connect</a> installed.</p>
</li>
<li>
<p>You have MySQL Server installed and setup.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download the Debezium <a href="https://repo1.maven.org/maven2/io/debezium/debezium-connector-mysql/1.3.1.Final/debezium-connector-mysql-1.3.1.Final-plugin.tar.gz">MySQL connector plug-in</a>.</p>
</li>
<li>
<p>Extract the files into your Kafka Connect environment.</p>
</li>
<li>
<p>Add the plug-in&#8217;s parent directory to your Kafka Connect <code>plugin.path</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>plugin.path=/kafka/connect</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The above example assumes you have extracted the Debezium MySQL connector to the <code>/kafka/connect/debezium-connector-mysql</code> path.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Restart your Kafka Connect process. This ensures the new JARs are picked up.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="configure-the-mysql-connector_debezium"><a class="anchor" href="#configure-the-mysql-connector_debezium"></a>Configuring the MySQL connector</h3>
<div class="paragraph">
<p>Typically, you configure the Debezium MySQL connector in a <code>.json</code> file using the configuration properties available for the connector.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You should have completed the <a href="#install-the-mysql-connector_debezium">installation process</a> for the connector.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Set the <code>"name"</code> of the connector in the <code>.json</code> file.</p>
</li>
<li>
<p>Set the configuration properties that you require for your Debezium MySQL connector.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For a complete list of configuration properties, see <a href="#mysql-connector-configuration-properties_debezium">MySQL connector configuration properties</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">MySQL connector example configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name": "inventory-connector", <i class="conum" data-value="1"></i><b>(1)</b>
  "config": {
    "connector.class": "io.debezium.connector.mysql.MySqlConnector", <i class="conum" data-value="2"></i><b>(2)</b>
    "database.hostname": "192.168.99.100", <i class="conum" data-value="3"></i><b>(3)</b>
    "database.port": "3306", <i class="conum" data-value="4"></i><b>(4)</b>
    "database.user": "debezium-user", <i class="conum" data-value="5"></i><b>(5)</b>
    "database.password": "debezium-user-pw", <i class="conum" data-value="6"></i><b>(6)</b>
    "database.server.id": "184054", <i class="conum" data-value="7"></i><b>(7)</b>
    "database.server.name": "fullfillment", <i class="conum" data-value="8"></i><b>(8)</b>
    "database.include.list": "inventory", <i class="conum" data-value="9"></i><b>(9)</b>
    "database.history.kafka.bootstrap.servers": "kafka:9092", <i class="conum" data-value="10"></i><b>(10)</b>
    "database.history.kafka.topic": "dbhistory.fullfillment", <i class="conum" data-value="11"></i><b>(11)</b>
    "include.schema.changes": "true" <i class="conum" data-value="12"></i><b>(12)</b>
  }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_example_configuration_properties_explained"><a class="anchor" href="#_example_configuration_properties_explained"></a>Example configuration properties explained</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The connector&#8217;s name when registered with the Kafka Connect service.</p>
</li>
<li>
<p>The connector&#8217;s class name.</p>
</li>
<li>
<p>The MySQL server address.</p>
</li>
<li>
<p>The MySQL server port number.</p>
</li>
<li>
<p>The MySQL user with the appropriate privileges.</p>
</li>
<li>
<p>The MySQL user&#8217;s password.</p>
</li>
<li>
<p>The unique ID of the connector.</p>
</li>
<li>
<p>The logical name of the MySQL server or cluster.</p>
</li>
<li>
<p>A list of all databases hosted by the specified server.</p>
</li>
<li>
<p>A list of Kafka brokers that the connector uses to write and recover DDL statements to the database history topic.</p>
</li>
<li>
<p>The name of the database history topic.</p>
</li>
<li>
<p>The flag that specifies if the connector should generate on the schema change topic named <code>fulfillment</code> events with DDL changes that can be used by consumers.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="add-mysql-connector-configuration-to-kafka-connect"><a class="anchor" href="#add-mysql-connector-configuration-to-kafka-connect"></a>Adding MySQL connector configuration to Kafka Connect</h3>
<div class="paragraph">
<p>To start running a MySQL connector, configure a connector and add the configuration to your Kafka Connect cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="#setup-the-mysql-server">MySQL server</a> is
set up for a Debezium connector.</p>
</li>
<li>
<p>Debezium MySQL connector is installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a configuration for the MySQL connector.</p>
</li>
<li>
<p>Use the <a href="https://kafka.apache.org/documentation/#connect_rest">Kafka Connect REST API</a> to add that connector configuration to your Kafka Connect cluster.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Results</div>
<p>When the connector starts, it <a href="#how-the-mysql-connector-performs-database-snapshots_debezium">performs a consistent snapshot</a> of the MySQL databases that the connector is configured for. The connector then starts generating data change events for row-level operations and streaming change event records to Kafka topics.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-connector-configuration-properties_debezium"><a class="anchor" href="#mysql-connector-configuration-properties_debezium"></a>MySQL connector configuration properties</h3>
<div class="paragraph">
<p>The configuration properties listed here are <strong>required</strong> to run the Debezium MySQL connector. There are also <a href="#advanced-mysql-connector-properties">advanced MySQL connector properties</a> whose default value rarely needs to be changed and therefore, they do not need to be specified in the connector configuration.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The Debezium MySQL connector supports <em>pass-through</em> configuration when creating the Kafka producer and consumer. See <a href="#mysql-connector-pass-through-properties">information about pass-through properties</a> at the end of this section, and also see <a href="https://kafka.apache.org/documentation.html">the Kafka documentation</a> for more details about <em>pass-through</em> properties.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-name"></a><a href="#mysql-property-name"><code>name</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique name for the connector. Attempting to register again with the same name will fail. (This property is required by all Kafka Connect connectors.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-connector-class"></a><a href="#mysql-property-connector-class"><code>connector.class</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the Java class for the connector. Always use a value of <code>io.debezium&#8203;.connector.mysql.MySqlConnector</code> for the MySQL connector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-tasks-max"></a><a href="#mysql-property-tasks-max"><code>tasks.max</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of tasks that should be created for this connector. The MySQL connector always uses a single task and therefore does not use this value, so the default is always acceptable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-hostname"></a><a href="#mysql-property-database-hostname"><code>database.hostname</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP address or hostname of the MySQL database server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-port"></a><a href="#mysql-property-database-port"><code>database.port</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3306</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer port number of the MySQL database server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-user"></a><a href="#mysql-property-database-user"><code>database.user</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the MySQL database to use when connecting to the MySQL database server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-password"></a><a href="#mysql-property-database-password"><code>database.password</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password to use when connecting to the MySQL database server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-server-name"></a><a href="#mysql-property-database-server-name"><code>database.server.name</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical name that identifies and provides a namespace for the particular MySQL database server/cluster being monitored. The logical name should be unique across all other connectors, since it is used as a prefix for all Kafka topic names emanating from this connector.
Only alphanumeric characters and underscores should be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-server-id"></a><a href="#mysql-property-database-server-id"><code>database.server.id</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>random</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A numeric ID of this database client, which must be unique across all currently-running database processes in the MySQL cluster. This connector joins the MySQL database cluster as another server (with this unique ID) so it can read the binlog. By default, a random number is generated between 5400 and 6400, though we recommend setting an explicit value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-history-kafka-topic"></a><a href="#mysql-property-database-history-kafka-topic"><code>database.history.kafka.topic</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full name of the Kafka topic where the connector will store the database schema history.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-history-kafka-bootstrap-servers"></a><a href="#mysql-property-database-history-kafka-bootstrap-servers"><code>database.history&#8203;.kafka.bootstrap.servers</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A list of host/port pairs that the connector will use for establishing an initial connection to the Kafka cluster. This connection will be used for retrieving database schema history previously stored by the connector, and for writing each DDL statement read from the source database. This should point to the same Kafka cluster used by the Kafka Connect process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-whitelist"></a>
<a id="mysql-property-database-include-list"></a><a href="#mysql-property-database-include-list"><code>database.include.list</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>empty string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match database names to be monitored; any database name not included in <code>database.include.list</code> will be excluded from monitoring. By default all databases will be monitored.
Must not be used with <code>database.exclude.list</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-blacklist"></a>
<a id="mysql-property-database-exclude-list"></a><a href="#mysql-property-database-exclude-list"><code>database.exclude.list</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>empty string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match database names to be excluded from monitoring; any database name not included in <code>database.exclude.list</code> will be monitored.
Must not be used with <code>database.include.list</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-table-whitelist"></a>
<a id="mysql-property-table-include-list"></a><a href="#mysql-property-table-include-list"><code>table.include.list</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>empty string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match fully-qualified table identifiers for tables to be monitored; any table not included in <code>table.include.list</code> will be excluded from monitoring. Each identifier is of the form <em>databaseName</em>.<em>tableName</em>. By default the connector will monitor every non-system table in each monitored database.
Must not be used with <code>table.exclude.list</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-table-blacklist"></a>
<a id="mysql-property-table-exclude-list"></a><a href="#mysql-property-table-exclude-list"><code>table.exclude.list</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>empty string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match fully-qualified table identifiers for tables to be excluded from monitoring; any table not included in <code>table.exclude.list</code> will be monitored. Each identifier is of the form <em>databaseName</em>.<em>tableName</em>.
Must not be used with <code>table.include.list</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-column-blacklist"></a>
<a id="mysql-property-column-exclude-list"></a><a href="#mysql-property-column-exclude-list"><code>column.exclude.list</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>empty string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match the fully-qualified names of columns that should be excluded from change event message values. Fully-qualified names for columns are of the form <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-column-include-list"></a><a href="#mysql-property-column-include-list"><code>column.include.list</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>empty string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match the fully-qualified names of columns that should be included in change event message values. Fully-qualified names for columns are of the form <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-column-truncate-to-length-chars"></a><a href="#mysql-property-column-truncate-to-length-chars"><code>column.truncate.to.<em>length</em>.chars</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>n/a</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match the fully-qualified names of character-based columns whose values should be truncated in the change event message values if the field values are longer than the specified number of characters. Multiple properties with different lengths can be used in a single configuration, although in each the length must be a positive integer. Fully-qualified names for columns are of the form <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-column-mask-with-length-chars"></a><a href="#mysql-property-column-mask-with-length-chars"><code>column.mask.with.<em>length</em>.chars</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>n/a</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match the fully-qualified names of character-based columns whose values should be replaced in the change event message values with a field value consisting of the specified number of asterisk (<code>*</code>) characters. Multiple properties with different lengths can be used in a single configuration, although in each the length must be a positive integer or zero. Fully-qualified names for columns are of the form <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-column-mask-hash"></a><a href="#mysql-property-column-mask-hash"><code>column.mask.hash.<em>hashAlgorithm</em>.with.salt.<em>salt</em></code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>n/a</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match the fully-qualified names of character-based columns whose values should be pseudonyms in the change event message values with a field value consisting of the hashed value using the algorithm <code><em>hashAlgorithm</em></code> and salt <code><em>salt</em></code>.
Based on the used hash function referential integrity is kept while data is pseudonymized. Supported hash functions are described in the <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/security/StandardNames.html#MessageDigest">MessageDigest section</a> of the Java Cryptography Architecture Standard Algorithm Name Documentation.
The hash is automatically shortened to the length of the column.</p>
<p class="tableblock">Multiple properties with different lengths can be used in a single configuration, although in each the length must be a positive integer or zero. Fully-qualified names for columns are of the form <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.</p>
<p class="tableblock">Example:</p>
<p class="tableblock">    column.mask.hash.SHA-256.with.salt.CzQMA0cB5K = inventory.orders.customerName, inventory.shipment.customerName</p>
<p class="tableblock">where <code>CzQMA0cB5K</code> is a randomly selected salt.</p>
<p class="tableblock">Note: Depending on the <code><em>hashAlgorithm</em></code> used, the <code><em>salt</em></code> selected and the actual data set, the resulting masked data set may not be completely anonymized.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-column-propagate-source-type"></a><a href="#mysql-property-column-propagate-source-type"><code>column.propagate.source.type</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>n/a</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match the fully-qualified names of columns whose original type and length should be added as a parameter to the corresponding field schemas in the emitted change messages.
The schema parameters <code>__Debezium.source.column.type</code>, <code>__Debezium.source.column.length</code> and <code>_Debezium.source.column.scale</code> will be used to propagate the original type name and length (for variable-width types), respectively.
Useful to properly size corresponding columns in sink databases.
Fully-qualified names for columns are of the form <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>, or <em>databaseName</em>.<em>schemaName</em>.<em>tableName</em>.<em>columnName</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-datatype-propagate-source-type"></a><a href="#mysql-property-datatype-propagate-source-type"><code>datatype.propagate.source.type</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>n/a</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional comma-separated list of regular expressions that match the database-specific data type name of columns whose original type and length should be added as a parameter to the corresponding field schemas in the emitted change messages.
The schema parameters <code>__debezium.source.column.type</code>, <code>__debezium.source.column.length</code> and <code>__debezium.source.column.scale</code> will be used to propagate the original type name and length (for variable-width types), respectively.
Useful to properly size corresponding columns in sink databases.
Fully-qualified data type names are of the form <em>databaseName</em>.<em>tableName</em>.<em>typeName</em>, or <em>databaseName</em>.<em>schemaName</em>.<em>tableName</em>.<em>typeName</em>.
See <a href="#how-the-mysql-connector-maps-data-types_debezium">how the MySQL connector maps data types</a> for the list of MySQL-specific data type names.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-time-precision-mode"></a><a href="#mysql-property-time-precision-mode"><code>time.precision.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>adaptive_time&#8203;_microseconds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time, date, and timestamps can be represented with different kinds of precision, including: <code>adaptive_time_microseconds</code> (the default) captures the date, datetime and timestamp values exactly as in the database using either millisecond, microsecond, or nanosecond precision values based on the database column&#8217;s type, with the exception of TIME type fields, which are always captured as microseconds;
<code>adaptive</code> (deprecated) captures the time and timestamp values exactly as in the database using either millisecond, microsecond, or nanosecond precision values based on the database column&#8217;s type;
or <code>connect</code> always represents time and timestamp values using Kafka Connect&#8217;s built-in representations for Time, Date, and Timestamp, which uses millisecond precision regardless of the database columns' precision.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-decimal-handling-mode"></a><a href="#mysql-property-decimal-handling-mode"><code>decimal.handling.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>precise</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how the connector should handle values for <code>DECIMAL</code> and <code>NUMERIC</code> columns: <code>precise</code> (the default) represents them precisely using <code>java.math.BigDecimal</code> values represented in change events in a binary form; or <code>double</code> represents them using <code>double</code> values, which may result in a loss of precision but will be far easier to use. <code>string</code> option encodes values as formatted string which is easy to consume but a semantic information about the real type is lost.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-bigint-unsigned-handling-mode"></a><a href="#mysql-property-bigint-unsigned-handling-mode"><code>bigint.unsigned.handling.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how BIGINT UNSIGNED columns should be represented in change events, including: <code>precise</code> uses <code>java.math.BigDecimal</code> to represent values, which are encoded in the change events using a binary representation and Kafka Connect&#8217;s <code>org.apache.kafka.connect.data.Decimal</code> type; <code>long</code> (the default) represents values using Java&#8217;s <code>long</code>, which may not offer the precision but will be far easier to use in consumers. <code>long</code> is usually the preferable setting. Only when working with values larger than 2^63, the <code>precise</code> setting should be used as those values cannot be conveyed using <code>long</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-include-schema-changes"></a><a href="#mysql-property-include-schema-changes"><code>include.schema.changes</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean value that specifies whether the connector should publish changes in the database schema to a Kafka topic with the same name as the database server ID. Each schema change will be recorded using a key that contains the database name and whose value includes the DDL statement(s). This is independent of how the connector internally records database history. The default is <code>true</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-include-query"></a><a href="#mysql-property-include-query"><code>include.query</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean value that specifies whether the connector should include the original SQL query that generated the change event.<br>
Note: This option requires MySQL be configured with the binlog_rows_query_log_events option set to ON. Query will not be present for events generated from the snapshot process.<br>
WARNING: Enabling this option may expose tables or fields explicitly excluded or masked by including the original SQL statement in the change event. For this reason this option is defaulted to 'false'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-event-processing-failure-handling-mode"></a><a href="#mysql-property-event-processing-failure-handling-mode"><code>event.processing&#8203;.failure.handling.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how the connector should react to exceptions during deserialization of binlog events.
<code>fail</code> will propagate the exception (indicating the problematic event and its binlog offset), causing the connector to stop.<br>
<code>warn</code> will cause the problematic event to be skipped and the problematic event and its binlog offset to be logged.<br>
<code>skip</code> will cause problematic event will be skipped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-inconsistent-schema-handling-mode"></a><a href="#mysql-property-inconsistent-schema-handling-mode"><code>inconsistent.schema.handling.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how the connector should react to binlog events that relate to tables that are not present in internal schema representation (i.e. internal representation is not consistent with database)
<code>fail</code> will throw an exception (indicating the problematic event and its binlog offset), causing the connector to stop.<br>
<code>warn</code> will cause the problematic event to be skipped and the problematic event and its binlog offset to be logged.<br>
<code>skip</code> will cause the problematic event to be skipped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-max-queue-size"></a><a href="#mysql-property-max-queue-size"><code>max.queue.size</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8192</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Positive integer value that specifies the maximum size of the blocking queue into which change events read from the database log are placed before they are written to Kafka. This queue can provide backpressure to the binlog reader when, for example, writes to Kafka are slower or if Kafka is not available. Events that appear in the queue are not included in the offsets periodically recorded by this connector. Defaults to 8192, and should always be larger than the maximum batch size specified in the <code>max.batch.size</code> property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-max-batch-size"></a><a href="#mysql-property-max-batch-size"><code>max.batch.size</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2048</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Positive integer value that specifies the maximum size of each batch of events that should be processed during each iteration of this connector. Defaults to 2048.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-poll-interval-ms"></a><a href="#mysql-property-poll-interval-ms"><code>poll.interval.ms</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Positive integer value that specifies the number of milliseconds the connector should wait during each iteration for new change events to appear. Defaults to 1000 milliseconds, or 1 second.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-connect-timeout-ms"></a><a href="#mysql-property-connect-timeout-ms"><code>connect.timeout.ms</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>30000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A positive integer value that specifies the maximum time in milliseconds this connector should wait after trying to connect to the MySQL database server before timing out. Defaults to 30 seconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-gtid-source-includes"></a><a href="#mysql-property-gtid-source-includes"><code>gtid.source.includes</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of regular expressions that match source UUIDs in the GTID set used to find the binlog position in the MySQL server. Only the GTID ranges that have sources matching one of these include patterns will be used.
Must not be used with <code>gtid.source.excludes</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-gtid-source-excludes"></a><a href="#mysql-property-gtid-source-excludes"><code>gtid.source.excludes</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of regular expressions that match source UUIDs in the GTID set used to find the binlog position in the MySQL server. Only the GTID ranges that have sources matching none of these exclude patterns will be used.
Must not be used with <code>gtid.source.includes</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-gtid-new-channel-position"></a><a href="#mysql-property-gtid-new-channel-position"><code>gtid.new.channel.position</code></a><br>
<em>deprecated and scheduled for removal</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>earliest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When set to <code>latest</code>, when the connector sees a new GTID channel, it will start consuming from the last executed transaction in that GTID channel. If set to <code>earliest</code> (default), the connector starts reading that channel from the first available (not purged) GTID position. <code>earliest</code> is useful when you have a active-passive MySQL setup where Debezium is connected to the primary server, in this case during failover the replica with new UUID (and GTID channel) starts receiving writes before Debezium is connected. These writes would be lost when using <code>latest</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-tombstones-on-delete"></a><a href="#mysql-property-tombstones-on-delete"><code>tombstones.on.delete</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls whether a tombstone event should be generated after a delete event.<br>
When <code>true</code> the delete operations are represented by a delete event and a subsequent tombstone event. When <code>false</code> only a delete event is sent.<br>
Emitting the tombstone event (the default behavior) allows Kafka to completely delete all events pertaining to the given key once the source record got deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-message-key-columns"></a><a href="#mysql-property-message-key-columns"><code>message.key.columns</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>empty string</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A semi-colon list of regular expressions that match fully-qualified tables and columns to map a primary key.<br>
Each item (regular expression) must match the <code>&lt;fully-qualified table&gt;:&lt;a comma-separated list of columns&gt;</code> representing the custom key.<br>
Fully-qualified tables could be defined as <em>databaseName</em>.<em>tableName</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-binary-handling-mode"></a><a href="#mysql-property-binary-handling-mode"><code>binary.handling.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how binary (<code>blob</code>, <code>binary</code>, <code>varbinary</code>, etc.) columns should be represented in change events, including: <code>bytes</code> represents binary data as byte array (default), <code>base64</code> represents binary data as base64-encoded String, <code>hex</code> represents binary data as hex-encoded (base16) String</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="advanced-mysql-connector-properties"><a class="anchor" href="#advanced-mysql-connector-properties"></a>Advanced MySQL connector properties</h4>
<div class="paragraph">
<p>The following table describes <a href="#advanced-mysql-connector-properties">advanced MySQL connector properties</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-connect-keep-alive"></a><a href="#mysql-property-connect-keep-alive"><code>connect.keep.alive</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A boolean value that specifies whether a separate thread should be used to ensure the connection to the MySQL server/cluster is kept alive.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-table-ignore-builtin"></a><a href="#mysql-property-table-ignore-builtin"><code>table.ignore.builtin</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean value that specifies whether built-in system tables should be ignored. This applies regardless of the table include or exclude lists. By default system tables are excluded from monitoring, and no events are generated when changes are made to any of the system tables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-history-kafka-recovery-poll-interval-ms"></a><a href="#mysql-property-database-history-kafka-recovery-poll-interval-ms"><code>database.history.kafka.recovery.poll.interval.ms</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer value that specifies the maximum number of milliseconds the connector should wait during startup/recovery while polling for persisted data. The default is 100ms.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-history-kafka-recovery-attempts"></a><a href="#mysql-property-database-history-kafka-recovery-attempts"><code>database.history.kafka.recovery.attempts</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of times that the connector should attempt to read persisted history data before the connector recovery fails with an error. The maximum amount of time to wait after receiving no data is <code>recovery.attempts</code> x <code>recovery.poll.interval.ms</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-history-skip-unparseable-ddl"></a><a href="#mysql-property-database-history-skip-unparseable-ddl"><code>database.history.skip.unparseable.ddl</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean value that specifies if connector should ignore malformed or unknown database statements or stop processing and let operator to fix the issue.
The safe default is <code>false</code>.
Skipping should be used only with care as it can lead to data loss or mangling when binlog is processed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-history-store-only-monitored-tables-ddl"></a><a href="#mysql-property-database-history-store-only-monitored-tables-ddl"><code>database.history.store.only.monitored.tables.ddl</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean value that specifies if connector should should record all DDL statements or (when <code>true</code>) only those that are relevant to tables that are monitored by Debezium (via filter configuration).
The safe default is <code>false</code>.
This feature should be used only with care as the missing data might be necessary when the filters are changed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-ssl-mode"></a><a href="#mysql-property-database-ssl-mode"><code>database.ssl.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>disabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies whether to use an encrypted connection.  The default is <code>disabled</code>, and specifies to use an unencrypted connection.</p>
<p class="tableblock">The <code>preferred</code> option establishes an encrypted connection if the server supports secure connections but falls back to an unencrypted connection otherwise.</p>
<p class="tableblock">The <code>required</code> option establishes an encrypted connection but will fail if one cannot be made for any reason.</p>
<p class="tableblock">The <code>verify_ca</code> option behaves like <code>required</code> but additionally it verifies the server TLS certificate against the configured Certificate Authority (CA) certificates and will fail if it doesn&#8217;t match any valid CA certificates.</p>
<p class="tableblock">The <code>verify_identity</code> option behaves like <code>verify_ca</code> but additionally verifies that the server certificate matches the host of the remote connection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-binlog-buffer-size"></a><a href="#mysql-property-binlog-buffer-size"><code>binlog.buffer.size</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The size of a look-ahead buffer used by the binlog reader.<br>
Under specific conditions it is possible that MySQL binlog contains uncommitted data finished by a <code>ROLLBACK</code> statement.
Typical examples are using savepoints or mixing temporary and regular table changes in a single transaction.<br>
When a beginning of a transaction is detected then Debezium tries to roll forward the binlog position and find either <code>COMMIT</code> or <code>ROLLBACK</code> so it can decide whether the changes from  the transaction will be streamed or not.
The size of the buffer defines the maximum number of changes in the transaction that Debezium can buffer while searching for transaction boundaries.
If the size of transaction is larger than the buffer then Debezium needs to rewind and re-read the events that has not fit into the buffer while streaming. Value <code>0</code> disables buffering.<br>
Disabled by default.<br>
<em>Note:</em> This feature should be considered an incubating one. We need a feedback from customers but it is expected that it is not completely polished.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-snapshot-mode"></a><a href="#mysql-property-snapshot-mode"><code>snapshot.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initial</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the criteria for running a snapshot upon startup of the connector. The default is <code>initial</code>, and specifies the connector can run a snapshot only when no offsets have been recorded for the logical server name. The <code>when_needed</code> option specifies that the connector run a snapshot upon startup whenever it deems it necessary (when no offsets are available, or when a previously recorded offset specifies a binlog location or GTID that is not available in the server). The <code>never</code> option specifies that the connect should never use snapshots and that upon first startup with a logical server name the connector should read from the beginning of the binlog; this should be used with care, as it is only valid when the binlog is guaranteed to contain the entire history of the database. If you don&#8217;t need the topics to contain a consistent snapshot of the data but only need them to have the changes since the connector was started, you can use the <code>schema_only</code> option, where the connector only snapshots the schemas (not the data).</p>
<p class="tableblock"><code>schema_only_recovery</code> is a recovery option for an existing connector to recover a corrupted or lost database history topic, or to periodically "clean up" a database history topic (which requires infinite retention) that may be growing unexpectedly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-snapshot-locking-mode"></a><a href="#mysql-property-snapshot-locking-mode"><code>snapshot.locking.mode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minimal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls if and how long the connector holds onto the global MySQL read lock (preventing any updates to the database) while it is performing a snapshot.  There are three possible values <code>minimal</code>, <code>extended</code>, and <code>none</code>.<br></p>
<p class="tableblock"><code>minimal</code> The connector holds the global read lock for just the initial portion of the snapshot while the connector reads the database schemas and other metadata. The remaining work in a snapshot involves selecting all rows from each table, and this can be done in a consistent fashion using the REPEATABLE READ transaction even when the global read lock is no longer held and while other MySQL clients are updating the database.<br></p>
<p class="tableblock"><code>minimal_percona</code> The connector holds <a href="https://www.percona.com/doc/percona-server/5.7/management/backup_locks.html">the global backup lock</a> for just the initial portion of the snapshot while the connector reads the database schemas and other metadata. The remaining work in a snapshot involves selecting all rows from each table, and this can be done in a consistent fashion using the REPEATABLE READ transaction even when the global read lock is no longer held and while other MySQL clients are updating the database. This mode does not flush tables to disk and is not blocked by long-running reads, and is only available in Percona Server<br></p>
<p class="tableblock"><code>extended</code> In some cases where clients are submitting operations that MySQL excludes from REPEATABLE READ semantics, it may be desirable to block all writes for the entire duration of the snapshot. For these such cases, use this option.<br></p>
<p class="tableblock"><code>none</code> Will prevent the connector from acquiring any table locks during the snapshot process. This value can be used with all snapshot modes but it is safe to use if and <em>only</em> if no schema changes are happening while the snapshot is taken. Note that for tables defined with MyISAM engine, the tables would still be locked despite this property being set as MyISAM acquires a table lock. This behavior is unlike InnoDB engine which acquires row level locks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-snapshot-select-statement-overrides"></a><a href="#mysql-property-snapshot-select-statement-overrides"><code>snapshot.select.statement.overrides</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls which rows from tables will be included in snapshot.<br>
This property contains a comma-separated list of fully-qualified tables <em>(DB_NAME.TABLE_NAME)</em>. Select statements for the individual tables are specified in further configuration properties, one for each table, identified by the id <code>snapshot.select.statement.overrides.[DB_NAME].[TABLE_NAME]</code>. The value of those properties is the SELECT statement to use when retrieving data from the specific table during snapshotting. <em>A possible use case for large append-only tables is setting a specific point where to start (resume) snapshotting, in case a previous snapshotting was interrupted.</em><br>
<strong>Note</strong>: This setting has impact on snapshots only. Events captured from binlog are not affected by it at all.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-min-row-count-to-stream-results"></a><a href="#mysql-property-min-row-count-to-stream-results"><code>min.row.count.to.stream.results</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">During a snapshot operation, the connector will query each included table to produce a read event for all rows in that table. This parameter determines whether the MySQL connection will pull all results for a table into memory (which is fast but requires large amounts of memory), or whether the results will instead be streamed (can be slower, but will work for very large tables). The value specifies the minimum number of rows a table must contain before the connector will stream results, and defaults to 1,000. Set this parameter to '0' to skip all table size checks and always stream all results during a snapshot.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-heartbeat-interval-ms"></a><a href="#mysql-property-heartbeat-interval-ms"><code>heartbeat.interval.ms</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls how frequently the heartbeat messages are sent.<br>
This property contains an interval in milli-seconds that defines how frequently the connector sends heartbeat messages into a heartbeat topic.
Set this parameter to <code>0</code> to not send heartbeat messages at all.<br>
Disabled by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-heartbeat-topics-prefix"></a><a href="#mysql-property-heartbeat-topics-prefix"><code>heartbeat.topics.prefix</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>__debezium-heartbeat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls the naming of the topic to which heartbeat messages are sent.<br>
The topic is named according to the pattern <code>&lt;heartbeat.topics.prefix&gt;.&lt;server.name&gt;</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-database-initial-statements"></a><a href="#mysql-property-database-initial-statements"><code>database.initial.statements</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A semicolon separated list of SQL statements to be executed when a JDBC connection (not the transaction log reading connection) to the database is established.
Use doubled semicolon (';;') to use a semicolon as a character and not as a delimiter.<br>
<em>Note: The connector may establish JDBC connections at its own discretion, so this should typically be used for configuration of session parameters only, but not for executing DML statements.</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-snapshot-delay-ms"></a><a href="#mysql-property-snapshot-delay-ms"><code>snapshot.delay.ms</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An interval in milli-seconds that the connector should wait before taking a snapshot after starting up;<br>
Can be used to avoid snapshot interruptions when starting multiple connectors in a cluster, which may cause re-balancing of connectors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-snapshot-fetch-size"></a><a href="#mysql-property-snapshot-fetch-size"><code>snapshot.fetch.size</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the maximum number of rows that should be read in one go from each table while taking a snapshot.
The connector will read the table contents in multiple batches of this size.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-snapshot-lock-timeout-ms"></a><a href="#mysql-property-snapshot-lock-timeout-ms"><code>snapshot.lock.timeout.ms</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Positive integer value that specifies the maximum amount of time (in milliseconds) to wait to obtain table locks when performing a snapshot.
If table locks cannot be acquired in this time interval, the snapshot will fail. See <a href="#how-the-mysql-connector-performs-database-snapshots_debezium">How the MySQL connector performs database snapshots</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-enable-time-adjuster"></a><a href="#mysql-property-enable-time-adjuster"><code>enable.time.adjuster</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MySQL allows user to insert year value as either 2-digit or 4-digit.
In case of two digits the value is automatically mapped to 1970 - 2069 range.
This is usually done by database.<br>
Set to <code>true</code> (the default) when Debezium should do the conversion.<br>
Set to <code>false</code> when conversion is fully delegated to the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-source-struct-version"></a><a href="#mysql-property-source-struct-version"><code>source.struct.version</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schema version for the <code>source</code> block in Debezium events; Debezium 0.10 introduced a few breaking<br>
changes to the structure of the <code>source</code> block in order to unify the exposed structure across
all the connectors.<br>
By setting this option to <code>v1</code> the structure used in earlier versions can be produced.
Note that this setting is not recommended and is planned for removal in a future Debezium version.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-sanitize-field-names"></a><a href="#mysql-property-sanitize-field-names"><code>sanitize.field.names</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> when connector configuration explicitly specifies the <code>key.converter</code> or <code>value.converter</code> parameters to use Avro, otherwise defaults to <code>false</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether field names will be sanitized to adhere to Avro naming requirements.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-property-skipped-operations"></a><a href="#mysql-property-skipped-operations"><code>skipped.operations</code></a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comma-separated list of oplog operations that will be skipped during streaming.
The operations include: <code>c</code> for inserts, <code>u</code> for updates, and <code>d</code> for deletes.
By default, no operations are skipped.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="mysql-connector-pass-through-properties"><a class="anchor" href="#mysql-connector-pass-through-properties"></a>Pass-through configuration properties</h4>
<div class="paragraph">
<p>The MySQL connector also supports <a href="#mysql-connector-pass-through-properties">pass-through configuration properties</a> that are used when creating the Kafka producer and consumer. Specifically, all connector configuration properties that begin with the <code>database.history.producer.</code> prefix are used (without the prefix) when creating the Kafka producer that writes to the database history. All properties that begin with the prefix <code>database.history.consumer.</code> are used (without the prefix) when creating the Kafka consumer that reads the database history upon connector start-up.</p>
</div>
<div class="paragraph">
<p>For example, the following connector configuration properties can be used to secure connections to the Kafka broker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>database.history.producer.security.protocol=SSL
database.history.producer.ssl.keystore.location=/var/private/ssl/kafka.server.keystore.jks
database.history.producer.ssl.keystore.password=test1234
database.history.producer.ssl.truststore.location=/var/private/ssl/kafka.server.truststore.jks
database.history.producer.ssl.truststore.password=test1234
database.history.producer.ssl.key.password=test1234
database.history.consumer.security.protocol=SSL
database.history.consumer.ssl.keystore.location=/var/private/ssl/kafka.server.keystore.jks
database.history.consumer.ssl.keystore.password=test1234
database.history.consumer.ssl.truststore.location=/var/private/ssl/kafka.server.truststore.jks
database.history.consumer.ssl.truststore.password=test1234
database.history.consumer.ssl.key.password=test1234</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mysql-connector-pass-through-properties-for-database-drivers"><a class="anchor" href="#mysql-connector-pass-through-properties-for-database-drivers"></a>Pass-through properties for database drivers</h4>
<div class="paragraph">
<p>In addition to the pass-through properties for the Kafka producer and consumer, there are <a href="#mysql-connector-pass-through-properties-for-database-drivers">pass-through properties for database drivers</a>. These properties have the <code>database.</code> prefix. For example, <code>database.tinyInt1isBit=false</code> is passed to the JDBC URL.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mysql-connector-monitoring-metrics_debezium"><a class="anchor" href="#mysql-connector-monitoring-metrics_debezium"></a>MySQL connector monitoring metrics</h3>
<div class="paragraph">
<p>The Debezium MySQL connector has three metric types in addition to the built-in support for JMX metrics that Zookeeper, Kafka, and Kafka Connect have.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#mysql-connector-snapshot-metrics">snapshot metrics</a>; for monitoring the connector when performing snapshots</p>
</li>
<li>
<p><a href="#mysql-connector-binlog-metrics">binlog metrics</a>; for monitoring the connector when reading CDC table data</p>
</li>
<li>
<p><a href="#mysql-connector-schema-history-metrics">schema history metrics</a>; for monitoring the status of the connector&#8217;s schema history</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Refer to the <a href="../operations/monitoring.html#monitoring-debezium" class="page">monitoring documentation</a> for details of how to expose these metrics via JMX.</p>
</div>
<div class="sect3">
<h4 id="_snapshot_metrics"><a class="anchor" href="#_snapshot_metrics"></a>Snapshot metrics</h4>
<div id="mysql-connector-snapshot-metrics" class="paragraph">
<p>The <strong>MBean</strong> is <code>debezium.mysql:type=connector-metrics,context=snapshot,server=&lt;database.server.name&gt;</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 45%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attributes</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-lastevent"></a><a href="#connectors-snaps-metric-lastevent"><code>LastEvent</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The last snapshot event that the connector has read.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-millisecondssincelastevent"></a><a href="#connectors-snaps-metric-millisecondssincelastevent"><code>MilliSecondsSinceLastEvent</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds since the connector has read and processed the most recent event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-totalnumberofeventsseen"></a><a href="#connectors-snaps-metric-totalnumberofeventsseen"><code>TotalNumberOfEventsSeen</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of events that this connector has seen since last started or reset.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-numberofeventsfiltered"></a><a href="#connectors-snaps-metric-numberofeventsfiltered"><code>NumberOfEventsFiltered</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of events that have been filtered by include/exclude list filtering rules configured on the connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-monitoredtables"></a><a href="#connectors-snaps-metric-monitoredtables"><code>MonitoredTables</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string[]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The list of tables that are monitored by the connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-queuetotalcapacity"></a><a href="#connectors-snaps-metric-queuetotalcapacity"><code>QueueTotalCapacity</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The length the queue used to pass events between the snapshotter and the main Kafka Connect loop.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-queueremainingcapacity"></a><a href="#connectors-snaps-metric-queueremainingcapacity"><code>QueueRemainingCapacity</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The free capacity of the queue used to pass events between the snapshotter and the main Kafka Connect loop.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-totaltablecount"></a><a href="#connectors-snaps-metric-totaltablecount"><code>TotalTableCount</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of tables that are being included in the snapshot.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-remainingtablecount"></a><a href="#connectors-snaps-metric-remainingtablecount"><code>RemainingTableCount</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of tables that the snapshot has yet to copy.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotrunning"></a><a href="#connectors-snaps-metric-snapshotrunning"><code>SnapshotRunning</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether the snapshot was started.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotaborted"></a><a href="#connectors-snaps-metric-snapshotaborted"><code>SnapshotAborted</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether the snapshot was aborted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotcompleted"></a><a href="#connectors-snaps-metric-snapshotcompleted"><code>SnapshotCompleted</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether the snapshot completed.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotdurationinseconds"></a><a href="#connectors-snaps-metric-snapshotdurationinseconds"><code>SnapshotDurationInSeconds</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of seconds that the snapshot has taken so far, even if not complete.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-rowsscanned"></a><a href="#connectors-snaps-metric-rowsscanned"><code>RowsScanned</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Map&lt;String, Long&gt;</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Map containing the number of rows scanned for each table in the snapshot.
Tables are incrementally added to the Map during processing.
Updates every 10,000 rows scanned and upon completing a table.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Debezium MySQL connector also provides the following custom snapshot metrics:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HoldingGlobalLock</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the connector currently holds a global or table write lock.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_binlog_metrics"><a class="anchor" href="#_binlog_metrics"></a>Binlog metrics</h4>
<div id="mysql-connector-binlog-metrics" class="paragraph">
<p>The <strong>MBean</strong> is <code>debezium.mysql:type=connector-metrics,context=binlog,server=&lt;database.server.name&gt;</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The transaction-related attributes are only available if binlog event buffering is enabled. See <a href="#mysql-connector-configuration-properties_debezium">binlog.buffer.size</a> in the advanced connector configuration properties for more details.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 45%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attributes</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-lastevent"></a><a href="#connectors-strm-metric-lastevent"><code>LastEvent</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The last streaming event that the connector has read.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-millisecondssincelastevent"></a><a href="#connectors-strm-metric-millisecondssincelastevent"><code>MilliSecondsSinceLastEvent</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds since the connector has read and processed the most recent event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-totalnumberofeventsseen"></a><a href="#connectors-strm-metric-totalnumberofeventsseen"><code>TotalNumberOfEventsSeen</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of events that this connector has seen since last started or reset.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-numberofeventsfiltered"></a><a href="#connectors-strm-metric-numberofeventsfiltered"><code>NumberOfEventsFiltered</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of events that have been filtered by include/exclude list filtering rules configured on the connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-monitoredtables"></a><a href="#connectors-strm-metric-monitoredtables"><code>MonitoredTables</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string[]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The list of tables that are monitored by the connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-queuetotalcapacity"></a><a href="#connectors-strm-metric-queuetotalcapacity"><code>QueueTotalCapacity</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The length the queue used to pass events between the streamer and the main Kafka Connect loop.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-queueremainingcapacity"></a><a href="#connectors-strm-metric-queueremainingcapacity"><code>QueueRemainingCapacity</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The free capacity of the queue used to pass events between the streamer and the main Kafka Connect loop.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-connected"></a><a href="#connectors-strm-metric-connected"><code>Connected</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Flag that denotes whether the connector is currently connected to the database server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-millisecondsbehindsource"></a><a href="#connectors-strm-metric-millisecondsbehindsource"><code>MilliSecondsBehindSource</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds between the last change event&#8217;s timestamp and the connector processing it.
The values will incoporate any differences between the clocks on the machines where the database server and the connector are running.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-numberofcommittedtransactions"></a><a href="#connectors-strm-metric-numberofcommittedtransactions"><code>NumberOfCommittedTransactions</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of processed transactions that were committed.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-sourceeventposition"></a><a href="#connectors-strm-metric-sourceeventposition"><code>SourceEventPosition</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Map&lt;String, String&gt;</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The coordinates of the last received event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-lasttransactionid"></a><a href="#connectors-strm-metric-lasttransactionid"><code>LastTransactionId</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Transaction identifier of the last processed transaction.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Debezium MySQL connector also provides the following custom binlog metrics:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-binlogfilename"></a><a href="#mysql-metric-binlogfilename"><code>BinlogFilename</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the binlog filename that the connector has most recently read.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-binlogposition"></a><a href="#mysql-metric-binlogposition"><code>BinlogPosition</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The most recent position (in bytes) within the binlog that the connector has read.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-isgtidmodeenabled"></a><a href="#mysql-metric-isgtidmodeenabled"><code>IsGtidModeEnabled</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flag that denotes whether the connector is currently tracking GTIDs from MySQL server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-gtidset"></a><a href="#mysql-metric-gtidset"><code>GtidSet</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The string representation of the most recent GTID set seen by the connector when reading the binlog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-numberofskippedevents"></a><a href="#mysql-metric-numberofskippedevents"><code>NumberOfSkippedEvents</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of events that have been skipped by the MySQL connector.  Typically events are skipped due to a malformed or unparseable event from MySQL&#8217;s binlog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-numberofdisconnects"></a><a href="#mysql-metric-numberofdisconnects"><code>NumberOfDisconnects</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of disconnects by the MySQL connector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-numberofrolledbacktransactions"></a><a href="#mysql-metric-numberofrolledbacktransactions"><code>NumberOfRolledBackTransactions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of processed transactions that were rolled back and not streamed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-numberofnotwellformedtransactions"></a><a href="#mysql-metric-numberofnotwellformedtransactions"><code>NumberOfNotWellFormedTransactions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of transactions that have not conformed to expected protocol <code>BEGIN</code> + <code>COMMIT</code>/<code>ROLLBACK</code>. Should be <code>0</code> under normal conditions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="mysql-metric-numberoflargetransactions"></a><a href="#mysql-metric-numberoflargetransactions"><code>NumberOfLargeTransactions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of transactions that have not fitted into the look-ahead buffer. Should be significantly smaller than <code>NumberOfCommittedTransactions</code> and <code>NumberOfRolledBackTransactions</code> for optimal performance.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_schema_history_metrics"><a class="anchor" href="#_schema_history_metrics"></a>Schema history metrics</h4>
<div id="mysql-connector-schema-history-metrics" class="paragraph">
<p>The <strong>MBean</strong> is <code>debezium.mysql:type=connector-metrics,context=schema-history,server=&lt;database.server.name&gt;</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 45%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attributes</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-status"></a><a href="#connectors-shist-metric-status"><code>Status</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>One of <code>STOPPED</code>, <code>RECOVERING</code> (recovering history from the storage), <code>RUNNING</code> describing the state of the database history.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-recoverystarttime"></a><a href="#connectors-shist-metric-recoverystarttime"><code>RecoveryStartTime</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The time in epoch seconds at what recovery has started.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-changesrecovered"></a><a href="#connectors-shist-metric-changesrecovered"><code>ChangesRecovered</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of changes that were read during recovery phase.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-changesapplied"></a><a href="#connectors-shist-metric-changesapplied"><code>ChangesApplied</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the total number of schema changes applied during recovery and runtime.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-millisecondssincelastrecoveredchange"></a><a href="#connectors-shist-metric-millisecondssincelastrecoveredchange"><code>MilliSecondsSinceLast&#8203;RecoveredChange</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds that elapsed since the last change was recovered from the history store.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-millisecondssincelastappliedchange"></a><a href="#connectors-shist-metric-millisecondssincelastappliedchange"><code>MilliSecondsSinceLast&#8203;AppliedChange</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds that elapsed since the last change was applied.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-lastrecoveredchange"></a><a href="#connectors-shist-metric-lastrecoveredchange"><code>LastRecoveredChange</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The string representation of the last change recovered from the history store.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-lastappliedchange"></a><a href="#connectors-shist-metric-lastappliedchange"><code>LastAppliedChange</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The string representation of the last applied change.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connector-common-issues"><a class="anchor" href="#connector-common-issues"></a>MySQL connector common issues</h2>
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#overview-of-how-the-mysql-connector-works">Overview of how the MySQL connector works</a>
<ul class="sectlevel2">
<li><a href="#how-the-mysql-connector-uses-database-schemas_debezium">How the MySQL connector uses database schemas</a></li>
<li><a href="#how-the-mysql-connector-performs-database-snapshots_debezium">How the MySQL connector performs database snapshots</a></li>
<li><a href="#how-the-mysql-connector-exposes-schema-changes">How the MySQL connector exposes schema changes</a></li>
<li><a href="#mysql-connector-events_debezium">MySQL connector events</a></li>
<li><a href="#how-the-mysql-connector-maps-data-types_debezium">How the MySQL connector maps data types</a></li>
<li><a href="#the-mysql-connector-and-kafka-topics_debezium">The MySQL connector and Kafka topics</a></li>
<li><a href="#mysql-supported-topologies_debezium">MySQL supported topologies</a></li>
</ul>
</li>
<li><a href="#setup-the-mysql-server">Setting up MySQL server</a>
<ul class="sectlevel2">
<li><a href="#create-a-mysql-user-for-cdc_debezium">Creating a MySQL user for Debezium</a></li>
<li><a href="#enable-the-mysql-binlog-for-cdc_debezium">Enabling the MySQL binlog for Debezium</a></li>
<li><a href="#enable-mysql-gtids-for-cdc_debezium">Enabling MySQL Global Transaction Identifiers for Debezium</a></li>
<li><a href="#setup-session-timeouts-for-cdc_debezium">Setting up session timeouts for Debezium</a></li>
<li><a href="#enable-query-log-events-for-cdc_debezium">Enabling query log events for Debezium</a></li>
</ul>
</li>
<li><a href="#deploy-the-mysql-connector">Deploying the MySQL connector</a>
<ul class="sectlevel2">
<li><a href="#install-the-mysql-connector_debezium">Installing the MySQL connector</a></li>
<li><a href="#configure-the-mysql-connector_debezium">Configuring the MySQL connector</a></li>
<li><a href="#add-mysql-connector-configuration-to-kafka-connect">Adding MySQL connector configuration to Kafka Connect</a></li>
<li><a href="#mysql-connector-configuration-properties_debezium">MySQL connector configuration properties</a></li>
<li><a href="#mysql-connector-monitoring-metrics_debezium">MySQL connector monitoring metrics</a></li>
</ul>
</li>
<li><a href="#connector-common-issues">MySQL connector common issues</a>
<ul class="sectlevel2">
<li><a href="#configuration-and-startup-errors_debezium">Configuration and startup errors</a></li>
<li><a href="#mysql-is-unavailable_debezium">MySQL is unavailable</a></li>
<li><a href="#kafka-connect-stops_debezium">Kafka Connect stops</a></li>
<li><a href="#mysql-purges-binlog-files_debezium">MySQL purges binlog files</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="configuration-and-startup-errors_debezium"><a class="anchor" href="#configuration-and-startup-errors_debezium"></a>Configuration and startup errors</h3>
<div class="paragraph">
<p>The Debezium MySQL connector fails, reports an error, and stops running when the following startup errors occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The connector&#8217;s configuration is invalid.</p>
</li>
<li>
<p>The connector cannot connect to the MySQL server using the specified connectivity parameters.</p>
</li>
<li>
<p>The connector is attempting to restart at a position in the binlog where MySQL no longer has the history available.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you receive any of these errors, you receive more details in the error message. The error message also contains workarounds where possible.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-is-unavailable_debezium"><a class="anchor" href="#mysql-is-unavailable_debezium"></a>MySQL is unavailable</h3>
<div class="paragraph">
<p>If your MySQL server becomes unavailable, the Debezium MySQL connector fails with an error and the connector stops. You simply need to restart the connector when the server is available.</p>
</div>
<div class="sect3">
<h4 id="_using_gtids"><a class="anchor" href="#_using_gtids"></a>Using GTIDs</h4>
<div class="paragraph">
<p>If you have GTIDs enabled and a highly available MySQL cluster, restart the connector immediately as the connector will simply connect to a different MySQL server in the cluster, find the location in the server&#8217;s binlog that represents the last transaction, and begin reading the new server&#8217;s binlog from that specific location.</p>
</div>
</div>
<div class="sect3">
<h4 id="_not_using_gtids"><a class="anchor" href="#_not_using_gtids"></a>Not Using GTIDs</h4>
<div class="paragraph">
<p>If you do not have GTIDs enabled, the connector only records the binlog position of the MySQL server to which it was connected. In order to restart from the correct binlog position, you must reconnect to that specific server.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kafka-connect-stops_debezium"><a class="anchor" href="#kafka-connect-stops_debezium"></a>Kafka Connect stops</h3>
<div class="paragraph">
<p>There are three scenarios that cause some issues when Kafka Connect stops:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_kafka_connect_stops_gracefully">Kafka Connect stops gracefully</a></p>
</li>
<li>
<p><a href="#_kafka_connect_process_crashes">Kafka Connect process crashes</a></p>
</li>
<li>
<p><a href="#_kafka_becomes_unavailable">Kafka becomes unavailable</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_kafka_connect_stops_gracefully"><a class="anchor" href="#_kafka_connect_stops_gracefully"></a>Kafka Connect stops gracefully</h4>
<div class="paragraph">
<p>When Kafka Connect stops gracefully, there is only a short delay while the Debezium MySQL connector tasks are stopped and restarted on new Kafka Connect processes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_kafka_connect_process_crashes"><a class="anchor" href="#_kafka_connect_process_crashes"></a>Kafka Connect process crashes</h4>
<div class="paragraph">
<p>If Kafka Connect crashes, the process stops and any Debezium MySQL connector tasks terminate without their most recently-processed offsets being recorded. In distributed mode, Kafka Connect restarts the connector tasks on other processes. However, the MySQL connector resumes from the last offset recorded by the earlier processes. This means that the replacement tasks may generate some of the same events processed prior to the crash, creating duplicate events.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Each change event message includes source-specific information about:
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>the event origin</p>
</li>
<li>
<p>the MySQL server&#8217;s event time</p>
</li>
<li>
<p>the binlog filename and position</p>
</li>
<li>
<p>GTIDs (if used)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kafka_becomes_unavailable"><a class="anchor" href="#_kafka_becomes_unavailable"></a>Kafka becomes unavailable</h4>
<div class="paragraph">
<p>The Kafka Connect framework records Debezium change events in Kafka using the Kafka producer API. If the Kafka brokers become unavailable, the Debezium MySQL connector pauses until the connection is reestablished and the connector resumes where it last left off.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mysql-purges-binlog-files_debezium"><a class="anchor" href="#mysql-purges-binlog-files_debezium"></a>MySQL purges binlog files</h3>
<div class="paragraph">
<p>If the Debezium MySQL connector stops for too long, the MySQL server purges older binlog files and the connector&#8217;s last position may be lost. When the connector is restarted, the MySQL server no longer has the starting point and the connector performs another initial snapshot. If the snapshot is disabled, the connector fails with an error.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="#how-the-mysql-connector-performs-database-snapshots_debezium">How the MySQL connector performs database snapshots</a> for more information on initial snapshots.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</article>
</div>
<div class="article-cell2">
</div>
</div>

<div id="toc-rightbar"></div>    <footer class="footer">
        <div class="wrapper">
            <div class="copyright">Copyright &copy; 2021 Debezium Community</div>
        </div>
    </footer>
</main>
</div>
<script>
    /* Make sure TOC carets are expanded if sub-elements exist */
    $("#toc").each(function(i,v) {
      $(this).closest('article').addClass('with-toc');
    });

    $("#toc ul.sectlevel1 > li").each(function(i,v) {
      $(this).has("ul").addClass("expanded");
    });

    $(function() {
        /* Expands all the documentation submenus */
        $(".nav-list > .nav-item:not(.is-active) .nav-item-toggle").click();
    });

    /**
     * This checks if a "#toc" element exists in the DOM and if so:
     *
     *  1. Appends a cloned copy of the #toc node to the #toc-rightbar div.
     *  2. Forces the #toc-rightbar div to be visible.
     *  3. Adds the .toc-right class to the #article-wrapper div to restrict the article's overall width.
     */
    var $toc = $("#toc");
    if ( $toc.length ) {
        $("#toc-rightbar").append($toc.clone());
        $("body .main").addClass("with-toc");
    }

    /**
     * In order to make CSS changes that are backward compatible with old adoc files, this applies a version
     * style to the body tag so we can use it to differentiate between CSS styles per version if needed,
     * such as tfoot rows.
     */
    var $version = $("body .nav-container").data("version");
    var $versionClass = "version-" + $version;
    $versionClass = $versionClass.replace('.','-');
    $("body").addClass($versionClass);

    /** A CSS trick to wrap long-width tables in a div that can be scrolled on smaller screens */
    $("table.tableblock").wrap("<div class='table-scroll-wrapper'></div>");

    $(function() {
        /* apply floating scrollbar to the scroll-wrapper */
        $(".table-scroll-wrapper").floatingScrollbar();
    });

</script>
<script src="../../../debezium-antora/js/site.js"></script>
<script async src="../../../debezium-antora/js/vendor/highlight.js"></script>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-10656779-1");
    pageTracker._trackPageview();
  } catch(err) {}
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76464546-1', 'auto');
  ga('send', 'pageview');
  ga('set', 'anonymizeIp', true);
  ga('require', 'linkid', 'linkid.js');
</script>
</body>
</html>