<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Applying transformations selectively :: Debezium Documentation</title>
    <link rel="canonical" href="https://debezium.io/documentation/reference/stable/transformations/applying-transformations-selectively.html">
    <meta name="generator" content="Antora 3.1.7">
<link rel="stylesheet" href="../../debezium-antora/css/site.css">
<link rel="stylesheet" href="../../debezium-antora/css/debezium-antora.css">
<link rel="stylesheet" href="../../debezium-antora/css/highlightjs-dark.css">
<link rel="stylesheet" href="https://static.jboss.org/css/rhbar.css">
<script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.js"></script>
<script src="../../debezium-antora/js/jquery.ba-floatingscrollbar.js"></script>
</head>
<body class="article">
<header class="header">
  <div id="rhbar">
      <a class="jbdevlogo" href="https://developers.redhat.com"></a>
      <a class="rhlogo" href="https://www.redhat.com"></a>
  </div>
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
          <img src="/assets/images/color_white_debezium_type_600px.svg" style="height: 32px; margin-right: 14px;"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/documentation/faq">FAQ</a>
        <a class="navbar-item" href="/documentation">DOCUMENTATION</a>
        <a class="navbar-item" href="/releases">RELEASES</a>
        <a class="navbar-item" href="/community">COMMUNITY</a>
        <a class="navbar-item" href="/blog">BLOG</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="reference" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Debezium nightly Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorial.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../postgres-plugins.html">PostgreSQL Decoding Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../features.html">Features</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/avro.html">Avro Serialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/topic-auto-create-config.html">Customizing Topic Auto-Creation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/signalling.html">Sending Signals to Debezium</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/notification.html">Receive notifications from Debezium</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Connectors</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/mysql.html">MySQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/mariadb.html">MariaDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/mongodb.html">MongoDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/postgresql.html">PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/oracle.html">Oracle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/sqlserver.html">SQL Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/db2.html">Db2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/cassandra.html">Cassandra</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/vitess.html">Vitess</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/spanner.html">Spanner</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/jdbc.html">JDBC</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/informix.html">Informix</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Transformations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="topic-routing.html">Topic Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="event-flattening.html">New Record State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mongodb-event-flattening.html">MongoDB New Document State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="event-changes.html">Event Changes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="outbox-event-router.html">Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mongodb-outbox-event-router.html">MongoDB Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="filtering.html">Message Filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="schema-change-event-filter.html">Schema Change Event Filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="content-based-routing.html">Content-Based Routing</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="applying-transformations-selectively.html">Using SMT Predicates to Selectively Apply Transformations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="partition-routing.html">Partition Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="header-to-value.html">HeaderToValue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="timezone-converter.html">Timezone Converter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="timescaledb.html">TimescaleDB Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="decode-logical-decoding-message-content.html">Decode Logical Decoding Message Content</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="convert-cloudevent-to-saveable-form.html">Convert CloudEvents to Saveable Form</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Post Processors</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../post-processors/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../post-processors/reselect-columns.html">Reselect Columns</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">API and SPI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/engine.html">Debezium Engine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/converters.html">Custom Converters</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/serdes.html">Change Event SerDes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/outbox.html">Outbox Quarkus Extension</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/cloudevents.html">CloudEvents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/tracing.html">OpenTelemetry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/testcontainers.html">Integration Testing with Testcontainers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Operations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-server.html">Debezium Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/kubernetes.html">Running on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/openshift.html">Running on Openshift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-ui.html">Debezium UI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Debezium Documentation</span>
    <span class="version">nightly</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Debezium Documentation</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="/documentation/reference/nightly/index.html">nightly</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.7/index.html">2.7</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/3.0/index.html">3.0</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.6/index.html">2.6</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.5/index.html">2.5</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.4/index.html">2.4</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.3/index.html">2.3</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.1/index.html">2.1</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.0/index.html">2.0</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/1.9/index.html">1.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main" class="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../stable/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Debezium Documentation</a></li>
    <li>Transformations</li>
    <li><a href="applying-transformations-selectively.html">Using SMT Predicates to Selectively Apply Transformations</a></li>
  </ul>
</nav>
    <div class="page-versions-container">
    Version:
    <div class="page-versions">
        <button class="version-menu-toggle versions-menu-current" title="Show other versions of page">nightly</button>
        <div class="version-menu">
                <a class="version is-current" href="/documentation/reference/nightly/index.html">nightly</a>
                <a class="version" href="/documentation/reference/2.7/index.html">2.7</a>
                <a class="version" href="/documentation/reference/3.0/index.html">3.0</a>
                <a class="version" href="/documentation/reference/2.6/index.html">2.6</a>
                <a class="version" href="/documentation/reference/2.5/index.html">2.5</a>
                <a class="version" href="/documentation/reference/2.4/index.html">2.4</a>
                <a class="version" href="/documentation/reference/2.3/index.html">2.3</a>
                <a class="version" href="/documentation/reference/2.2/index.html">2.2</a>
                <a class="version" href="/documentation/reference/2.1/index.html">2.1</a>
                <a class="version" href="/documentation/reference/2.0/index.html">2.0</a>
                <a class="version" href="/documentation/reference/1.9/index.html">1.9</a>
        </div>
        |
    </div>
    </div>
  <div class="edit-this-page"><a href="https://github.com/debezium/debezium/edit/main/documentation/modules/ROOT/pages/transformations/applying-transformations-selectively.adoc">Edit this Page</a></div>
  </div>
<div class="article-grid">
<div class="article-cell1">
<article class="doc">
        
    <div class="version-banner version-banner-development">
    You are viewing documentation for an unreleased version of Debezium.
    <br/>
            If you want to view the latest stable version of this page, please go <a href=/documentation/reference/stable/index.html>here</a>.
            
</div>            <h1 class="page">Applying transformations selectively</h1>
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>When you configure a single message transformation (SMT) for a connector, you can define a predicate for the transformation.
The predicate specifies how to apply the transformation conditionally to a subset of the messages that the connector processes.
You can assign predicates to transformations that you configure for source connectors, such as Debezium, or to sink connectors.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_smt_predicates"><a class="anchor" href="#_smt_predicates"></a>SMT predicates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Debezium provides several single message transformations (SMTs) that you can use to modify event records before Kafka Connect saves the records to Kafka topics.
By default, when you configure one of these SMTs for a Debezium connector, Kafka Connect applies that transformation to every record that the connector emits.
However, there might be instances in which you want to apply a transformation selectively, so that it modifies only that subset of change event messages that share a common characteristic.</p>
</div>
<div class="paragraph">
<p>For example, for a Debezium connector, you might want to run the transformation only on event messages from a specific table or that include a specific header key.
In environments that run Apache Kafka 2.6 or greater, you can append a predicate statement to a transformation to instruct Kafka Connect to apply the SMT only to certain records.
In the predicate, you specify a condition that Kafka Connect uses to evaluate each message that it processes.
When a Debezium connector emits a change event message, Kafka Connect checks the message against the configured predicate condition.
If the condition is true for the event message, Kafka Connect applies the transformation, and then writes the message to a Kafka topic.
Messages that do not match the condition are sent to Kafka unmodified.</p>
</div>
<div class="paragraph">
<p>The situation is similar for predicates that you define for a sink connector SMT.
The connector reads messages from a Kafka topic and Kafka Connect evaluates the messages against the predicate condition.
If a message matches the condition, Kafka Connect applies the transformation and then passes the messages to the sink connector.</p>
</div>
<div class="paragraph">
<p>After you define a predicate, you can reuse it and apply it to multiple transforms.
Predicates also include a <code>negate</code> option that you can use to invert a predicate so that the predicate condition is applied only to records that do <em>not</em> match the condition that is defined in the predicate statement.
You can use the <code>negate</code> option to pair the predicate with other transforms that are based on negating the condition.</p>
</div>
<div class="paragraph">
<div class="title">Predicate elements</div>
<p>Predicates include the following elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>predicates</code> prefix</p>
</li>
<li>
<p>Alias (for example, <code>isOutboxTable</code>)</p>
</li>
<li>
<p>Type (for example, <code>org.apache.kafka.connect.transforms.predicates.TopicNameMatches</code>).
Kafka Connect provides a set of default predicate types, which you can supplement by defining your own custom predicates.</p>
</li>
<li>
<p>Condition statement and any additional configuration properties, depending on the type of predicate (for example, a regex naming pattern)</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Default predicate types</div>
<p>The following predicate types are available by default:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">HasHeaderKey</dt>
<dd>
<p>Specifies a key name in the header in the event message that you want Kafka Connect to evaluate.
The predicate evaluates to true for any records that include a header key that has the specified name.</p>
</dd>
</dl>
</div>
<div id="record-is-tombstone" class="dlist">
<dl>
<dt class="hdlist1">RecordIsTombstone</dt>
<dd>
<p>Matches Kafka <em>tombstone</em> records.
The predicate evaluates to <code>true</code> for any record that has a <code>null</code> value.
Use this predicate in combination with a filter SMT to remove tombstone records.
This predicate has no configuration parameters.</p>
<div class="paragraph">
<p>A tombstone in Kafka is a record that has a key with a 0-byte, <code>null</code> payload.
When a Debezium connector processes a delete operation in the source database, the connector emits two change events for the delete operation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A delete operation (<code>"op" : "d"</code>) event that provides the previous value of the database record.</p>
</li>
<li>
<p>A tombstone event that has the same key, but a <code>null</code> value.</p>
<div class="paragraph">
<p>The tombstone represents a delete marker for the row.
When <a href="https://kafka.apache.org/documentation#compaction">log compaction</a> is enabled for Kafka, during compaction Kafka removes all events that share the same key as the tombstone.
Log compaction occurs periodically, with the compaction interval controlled by the <a href="https://kafka.apache.org/documentation#topicconfigs_delete.retention.ms"><code>delete.retention.ms</code></a> setting for the topic.</p>
</div>
<div class="paragraph">
<p>Although it is possible to <a href="#ignoring-tombstone-events">configure Debezium so that it does not emit tombstone events</a>, it&#8217;s best to permit Debezium to emit tombstones to maintain the expected behavior during log compaction.
Suppressing tombstones prevents Kafka from removing records for a deleted key during log compaction.
If your environment includes sink connectors that cannot process tombstones, you can configure the sink connector to use an SMT with the <code>RecordIsTombstone</code> predicate to filter out the tombstone records.</p>
</div>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">TopicNameMatches</dt>
<dd>
<p>A regular expression that specifies the name of a topic that you want Kafka Connect to match.
The predicate is true for connector records in which the topic name matches the specified regular expression.
Use this predicate to apply an SMT to records based on the name of the source table.</p>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-585%3A+Filter+and+Conditional+SMTs">KIP-585: Filter and Conditional SMTs</a></p>
</li>
<li>
<p><a href="https://kafka.apache.org/documentation/#connect_predicates">Apache Kafka documentation for Kafka Connect predicates</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="defining-smt-predicates"><a class="anchor" href="#defining-smt-predicates"></a>Defining SMT predicates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configuring Kafka Connect predicates is similar to configuring transforms.
You specify a predicate alias, associate the alias with a transform, and then define the type and configuration for the predicate.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Debezium environment runs Apache Kafka 2.6 or greater.</p>
</li>
<li>
<p>An SMT is configured for the Debezium connector.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Debezium connector configuration, specify a predicate alias for the <code>predicates</code> parameter, for example, <code>IsOutboxTable</code>.</p>
</li>
<li>
<p>Associate the predicate alias with the transform that you want to apply conditionally, by appending the predicate alias to the transform alias in the connector configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">transforms.<em>&lt;TRANSFORM_ALIAS&gt;</em>.predicate=<em>&lt;PREDICATE_ALIAS&gt;</em></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">transforms.outbox.predicate=IsOutboxTable</code></pre>
</div>
</div>
</li>
<li>
<p>Configure the predicate by specifying its type and providing values for configuration parameters.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For the type, specify one of the following default types that are available in Kafka Connect:</p>
<div class="ulist">
<ul>
<li>
<p>HasHeaderKey</p>
</li>
<li>
<p>RecordIsTombstone</p>
</li>
<li>
<p>TopicNameMatches</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">predicates.IsOutboxTable.type=org.apache.kafka.connect.transforms.predicates.TopicNameMatches</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>For the TopicNameMatch or <code>HasHeaderKey</code> predicates, specify a regular expression for the topic or header name that you want to match.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">predicates.IsOutboxTable.pattern=outbox.event.*</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>If you want to negate a condition, append the <code>negate</code> keyword to the transform alias and set it to <code>true</code>.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">transforms.outbox.negate=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding property inverts the set of records that the predicate matches, so that Kafka Connect applies the transform to any record that does not match the condition specified in the predicate.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Example: TopicNameMatch predicate for the outbox event router transformation</div>
<p>The following example shows a Debezium connector configuration that applies the outbox event router transformation only to messages that Debezium emits to the Kafka <code>outbox.event.order</code> topic.</p>
</div>
<div class="paragraph">
<p>Because the <code>TopicNameMatch</code> predicate evaluates to <em>true</em> only for messages from the outbox table (<code>outbox.event.*</code>), the transformation is not applied to messages that originate from other tables in the database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">transforms=outbox
transforms.outbox.predicate=IsOutboxTable
transforms.outbox.type=io.debezium.transforms.outbox.EventRouter
predicates=IsOutboxTable
predicates.IsOutboxTable.type=org.apache.kafka.connect.transforms.predicates.TopicNameMatches
predicates.IsOutboxTable.pattern=outbox.event.*</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ignoring-tombstone-events"><a class="anchor" href="#ignoring-tombstone-events"></a>Ignoring tombstone events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can control whether Debezium emits tombstone events, and how long Kafka retains them.
Depending on your data pipeline, you might want to set the <code>tombstones.on.delete</code> property for a connector so that Debezium does not emit tombstone events.</p>
</div>
<div class="paragraph">
<p>Whether you enable Debezium to emit tombstones depends on how topics are consumed in your environment and by the characteristics of the sink consumer.
Some sink connectors rely on tombstone events to remove records from downstream data stores.
In cases where sink connectors rely on tombstone records to indicate when to delete records in downstream data stores, configure Debezium to emit them.</p>
</div>
<div class="paragraph">
<p>When you configure Debezium to generate tombstones, further configuration is required to ensure that sink connectors receive the tombstone events.
The retention policy for a topic must be set so that the connector has time to read event messages before Kafka removes them during log compaction.
The length of time that a topic retains tombstones before compaction is controlled by the <a href="https://kafka.apache.org/documentation#topicconfigs_delete.retention.ms"><code>delete.retention.ms</code></a> property for the topic.</p>
</div>
<div class="paragraph">
<p>By default, the <code>tombstones.on.delete</code> property for a connector is set to <code>true</code> so that the connector generates a tombstone after each delete event.
If you set the property to <code>false</code> to prevent Debezium from saving tombstone records to Kafka topics, the absence of tombstone records might lead to unintended consequences.
Kafka relies on tombstone during log compaction to remove records that are related to a deleted key.</p>
</div>
<div class="paragraph">
<p>If you need to support sink connectors or downstream Kafka consumers that cannot process records with null values, rather than preventing Debezium from emitting tombstones,
consider configuring an SMT for the connector with a predicate that uses the <a href="#record-is-tombstone"><code>RecordIsTombstone</code></a> predicate type to remove tombstone messages before consumers read them.</p>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>To prevent Debezium from emitting tombstone events for deleted database records, set the connector option <code>tombstones.on.delete</code> to <code>false</code>.</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">“tombstones.on.delete”: “false”</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</article>
</div>
<div class="article-cell2">
</div>
</div>

<div id="toc-rightbar"></div>    <footer class="footer">
        <div class="wrapper">
            <div class="copyright">Copyright &copy; 2024 Debezium Community (Rev: <span class="truncated"><a href="https://github.com/debezium/debezium/commit/0056310130a27320ef7011edf4a9ab8d2b4780e0">00563101</a></span>)
            
        </div>
    </footer>
</main></div>
<script>
    /* Make sure TOC carets are expanded if sub-elements exist */
    $("#toc").each(function(i,v) {
      $(this).closest('article').addClass('with-toc');
    });

    $("#toc ul.sectlevel1 > li").each(function(i,v) {
      $(this).has("ul").addClass("expanded");
    });

    $(function() {
        /* Expands all the documentation submenus */
        $(".nav-list > .nav-item:not(.is-active) .nav-item-toggle").click();
    });

    /**
     * This checks if a "#toc" element exists in the DOM and if so:
     *
     *  1. Appends a cloned copy of the #toc node to the #toc-rightbar div.
     *  2. Forces the #toc-rightbar div to be visible.
     *  3. Adds the .toc-right class to the #article-wrapper div to restrict the article's overall width.
     */
    var $toc = $("#toc");
    if ( $toc.length ) {
        $("#toc-rightbar").append($toc.clone());
        $("body .main").addClass("with-toc");
    }

    /**
     * In order to make CSS changes that are backward compatible with old adoc files, this applies a version
     * style to the body tag so we can use it to differentiate between CSS styles per version if needed,
     * such as tfoot rows.
     */
    var $version = $("body .nav-container").data("version");
    var $versionClass = "version-" + $version;
    $versionClass = $versionClass.replace('.','-');
    $("body").addClass($versionClass);

    /** A CSS trick to wrap long-width tables in a div that can be scrolled on smaller screens */
    $("table.tableblock").wrap("<div class='table-scroll-wrapper'></div>");

    $(function() {
        /* apply floating scrollbar to the scroll-wrapper */
        $(".table-scroll-wrapper").floatingScrollbar();
    });

</script>
<script src="../../debezium-antora/js/site.js"></script>
<script async src="../../debezium-antora/js/vendor/highlight.js"></script>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-10656779-1");
    pageTracker._trackPageview();
  } catch(err) {}
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76464546-1', 'auto');
  ga('send', 'pageview');
  ga('set', 'anonymizeIp', true);
  ga('require', 'linkid', 'linkid.js');
</script>
</body>
</html>