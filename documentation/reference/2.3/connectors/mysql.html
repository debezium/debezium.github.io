<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Debezium connector for MySQL :: Debezium Documentation</title>
    <link rel="canonical" href="https://debezium.io/documentation/reference/stable/connectors/mysql.html">
    <meta name="generator" content="Antora 3.1.7">
<link rel="stylesheet" href="../../../debezium-antora/css/site.css">
<link rel="stylesheet" href="../../../debezium-antora/css/debezium-antora.css">
<link rel="stylesheet" href="../../../debezium-antora/css/highlightjs-dark.css">
<link rel="stylesheet" href="https://static.jboss.org/css/rhbar.css">
<script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.js"></script>
<script src="../../../debezium-antora/js/jquery.ba-floatingscrollbar.js"></script>
</head>
<body class="article">
<header class="header">
  <div id="rhbar">
      <a class="jbdevlogo" href="https://developers.redhat.com"></a>
      <a class="rhlogo" href="https://www.redhat.com"></a>
  </div>
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
          <img src="/assets/images/color_white_debezium_type_600px.svg" style="height: 32px; margin-right: 14px;"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/documentation/faq">FAQ</a>
        <a class="navbar-item" href="/documentation">DOCUMENTATION</a>
        <a class="navbar-item" href="/releases">RELEASES</a>
        <a class="navbar-item" href="/community">COMMUNITY</a>
        <a class="navbar-item" href="/blog">BLOG</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="reference" data-version="2.3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Debezium 2.3 Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorial.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../postgres-plugins.html">PostgreSQL Decoding Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../features.html">Features</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/avro.html">Avro Serialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/topic-auto-create-config.html">Customizing Topic Auto-Creation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/signalling.html">Sending Signals to Debezium</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/notification.html">Receive notifications from Debezium</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Connectors</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="mysql.html">MySQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mongodb.html">MongoDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="postgresql.html">PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="oracle.html">Oracle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sqlserver.html">SQL Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="db2.html">Db2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cassandra.html">Cassandra</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vitess.html">Vitess</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="spanner.html">Spanner</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc.html">Jdbc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Transformations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/topic-routing.html">Topic Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/event-flattening.html">New Record State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/mongodb-event-flattening.html">MongoDB New Document State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/event-changes.html">Event Changes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/outbox-event-router.html">Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/mongodb-outbox-event-router.html">MongoDB Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/filtering.html">Message Filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/content-based-routing.html">Content-Based Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/applying-transformations-selectively.html">Using SMT Predicates to Selectively Apply Transformations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/compute-partition.html">Compute Partition [Deprecated]</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/partition-routing.html">Partition Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/header-to-value.html">HeaderToValue</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">API and SPI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/engine.html">Debezium Engine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/converters.html">Custom Converters</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/serdes.html">Change Event SerDes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/outbox.html">Outbox Quarkus Extension</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/cloudevents.html">CloudEvents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/tracing.html">OpenTracing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/testcontainers.html">Integration Testing with Testcontainers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Operations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-server.html">Debezium Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/kubernetes.html">Running on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/openshift.html">Running on Openshift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/embedded.html">Embedding Debezium</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-ui.html">Debezium UI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Debezium Documentation</span>
    <span class="version">2.3</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Debezium Documentation</span>
      <ul class="versions">
        <li class="version">
          <a href="/documentation/reference/nightly/index.html">nightly</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.7/index.html">2.7</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/3.0/index.html">3.0</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.6/index.html">2.6</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.5/index.html">2.5</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.4/index.html">2.4</a>
        </li>
        <li class="version is-current">
          <a href="/documentation/reference/2.3/index.html">2.3</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.1/index.html">2.1</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.0/index.html">2.0</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/1.9/index.html">1.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main" class="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../stable/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Debezium Documentation</a></li>
    <li>Connectors</li>
    <li><a href="mysql.html">MySQL</a></li>
  </ul>
</nav>
    <div class="page-versions-container">
    Version:
    <div class="page-versions">
        <button class="version-menu-toggle versions-menu-current" title="Show other versions of page">2.3</button>
        <div class="version-menu">
                <a class="version" href="/documentation/reference/nightly/index.html">nightly</a>
                <a class="version" href="/documentation/reference/2.7/index.html">2.7</a>
                <a class="version" href="/documentation/reference/3.0/index.html">3.0</a>
                <a class="version" href="/documentation/reference/2.6/index.html">2.6</a>
                <a class="version" href="/documentation/reference/2.5/index.html">2.5</a>
                <a class="version" href="/documentation/reference/2.4/index.html">2.4</a>
                <a class="version is-current" href="/documentation/reference/2.3/index.html">2.3</a>
                <a class="version" href="/documentation/reference/2.2/index.html">2.2</a>
                <a class="version" href="/documentation/reference/2.1/index.html">2.1</a>
                <a class="version" href="/documentation/reference/2.0/index.html">2.0</a>
                <a class="version" href="/documentation/reference/1.9/index.html">1.9</a>
        </div>
        |
    </div>
    </div>
  <div class="edit-this-page"><a href="https://github.com/debezium/debezium/edit/2.3/documentation/modules/ROOT/pages/connectors/mysql.adoc">Edit this Page</a></div>
  </div>
<div class="article-grid">
<div class="article-cell1">
<article class="doc">
        
    <div class="version-banner version-banner-outdated">
    You are viewing documentation for an outdated version of Debezium.
    <br/>
            If you want to view the latest stable version of this page, please go <a href=/documentation/reference/stable/index.html>here</a>.
            
</div>            <h1 class="page">Debezium connector for MySQL</h1>
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#how-the-mysql-connector-works">How the connector works</a>
<ul class="sectlevel2">
<li><a href="#supported-mysql-topologies">Supported MySQL topologies</a></li>
<li><a href="#mysql-schema-history-topic">Schema history topic</a></li>
<li><a href="#mysql-schema-change-topic">Schema change topic</a></li>
<li><a href="#mysql-snapshots">Snapshots</a></li>
<li><a href="#mysql-ad-hoc-snapshots">Ad hoc snapshots</a></li>
<li><a href="#mysql-incremental-snapshots">Incremental snapshots</a></li>
<li><a href="#mysql-snapshot-events">Operation type of snapshot events</a></li>
<li><a href="#mysql-topic-names">Topic names</a></li>
<li><a href="#mysql-transaction-metadata">Transaction metadata</a></li>
</ul>
</li>
<li><a href="#mysql-events">Data change events</a>
<ul class="sectlevel2">
<li><a href="#mysql-change-event-keys">Change event keys</a></li>
<li><a href="#mysql-change-event-values">Change event values</a></li>
<li><a href="#mysql-create-events"><em>create</em> events</a></li>
<li><a href="#mysql-update-events"><em>update</em> events</a></li>
<li><a href="#mysql-primary-key-updates">Primary key updates</a></li>
<li><a href="#mysql-delete-events"><em>delete</em> events</a></li>
<li><a href="#mysql-tombstone-events">Tombstone events</a></li>
<li><a href="#mysql-truncate-events"><em>truncate</em> events</a></li>
</ul>
</li>
<li><a href="#mysql-data-types">Data type mappings</a>
<ul class="sectlevel2">
<li><a href="#mysql-basic-types">Basic types</a></li>
<li><a href="#mysql-temporal-types">Temporal types</a></li>
<li><a href="#mysql-decimal-types">Decimal types</a></li>
<li><a href="#mysql-boolean-values">Boolean values</a></li>
<li><a href="#mysql-spatial-types">Spatial types</a></li>
</ul>
</li>
<li><a href="#setting-up-mysql">Setting up MySQL</a>
<ul class="sectlevel2">
<li><a href="#mysql-creating-user">Creating a user</a></li>
<li><a href="#enable-mysql-binlog">Enabling the binlog</a></li>
<li><a href="#enable-mysql-gtids">Enabling GTIDs</a></li>
<li><a href="#mysql-session-timeouts">Configuring session timeouts</a></li>
<li><a href="#enable-query-log-events">Enabling query log events</a></li>
<li><a href="#validate-binlog-row-value-options">Validating binlog row value options</a></li>
</ul>
</li>
<li><a href="#mysql-deploying-a-connector">Deployment</a>
<ul class="sectlevel2">
<li><a href="#mysql-example-configuration">MySQL connector configuration example</a></li>
<li><a href="#mysql-adding-configuration">Adding connector configuration</a></li>
<li><a href="#mysql-connector-properties">Connector properties</a></li>
</ul>
</li>
<li><a href="#mysql-monitoring">Monitoring</a>
<ul class="sectlevel2">
<li><a href="#mysql-snapshot-metrics">Snapshot metrics</a></li>
<li><a href="#mysql-streaming-metrics">Streaming metrics</a></li>
<li><a href="#mysql-schema-history-metrics">Schema history metrics</a></li>
</ul>
</li>
<li><a href="#mysql-when-things-go-wrong">Behavior when things go wrong</a>
<ul class="sectlevel2">
<li><a href="#debezium-mysql-connector-configuration-and-startup-errors">Configuration and startup errors</a></li>
<li><a href="#mysql-becomes-unavailable-while-debezium-is-running">MySQL becomes unavailable</a></li>
<li><a href="#debezium-mysql-kafka-connect-process-stops-gracefully">Kafka Connect stops gracefully</a></li>
<li><a href="#debezium-mysql-kafka-connect-process-crashes">Kafka Connect process crashes</a></li>
<li><a href="#debezium-mysql-kafka-process-becomes-unavailable">Kafka becomes unavailable</a></li>
<li><a href="#mysql-purges-binlog-files-used-by-debezium">MySQL purges binlog files</a></li>
</ul>
</li>
</ul>
</div>
<div class="paragraph">
<p>MySQL has a binary log (binlog) that records all operations in the order in which they are committed to the database. This includes changes to table schemas as well as changes to the data in tables. MySQL uses the binlog for replication and recovery.</p>
</div>
<div class="paragraph">
<p>The Debezium MySQL connector reads the binlog, produces change events for row-level <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> operations, and emits the change events to Kafka topics. Client applications read those Kafka topics.</p>
</div>
<div class="paragraph">
<p>As MySQL is typically set up to purge binlogs after a specified period of time, the MySQL connector performs an initial <em>consistent snapshot</em> of each of your databases. The MySQL connector reads the binlog from the point at which the snapshot was made.</p>
</div>
<div class="paragraph">
<p>For information about the MySQL Database versions that are compatible with this connector, see the <a href="https://debezium.io/releases/">Debezium release overview</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-the-mysql-connector-works"><a class="anchor" href="#how-the-mysql-connector-works"></a>How the connector works</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An overview of the MySQL topologies that the connector supports is useful for planning your application. To optimally configure and run a Debezium MySQL connector, it is helpful to understand how the connector tracks the structure of tables, exposes schema changes, performs snapshots, and determines Kafka topic names.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Debezium MySQL connector has yet to be tested with MariaDB, but multiple reports from the community indicate successful usage of the connector with this database.
Official support for MariaDB is planned for a future Debezium version.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="supported-mysql-topologies"><a class="anchor" href="#supported-mysql-topologies"></a>Supported MySQL topologies</h3>
<div class="paragraph">
<p>The Debezium MySQL connector supports the following MySQL topologies:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Standalone</dt>
<dd>
<p>When a single MySQL server is used, the server must have the binlog enabled (<em>and optionally GTIDs enabled</em>) so the Debezium MySQL connector can monitor the server. This is often acceptable, since the binary log can also be used as an incremental <a href="https://dev.mysql.com/doc/refman/8.0/en/backup-methods.html">backup</a>. In this case, the MySQL connector always connects to and follows this standalone MySQL server instance.</p>
</dd>
<dt class="hdlist1">Primary and replica</dt>
<dd>
<p>The Debezium MySQL connector can follow one of the primary servers or one of the replicas (<em>if that replica has its binlog enabled</em>), but the connector sees changes in only the cluster that is visible to that server. Generally, this is not a problem except for the multi-primary topologies.</p>
<div class="paragraph">
<p>The connector records its position in the server’s binlog, which is different on each server in the cluster. Therefore, the connector must follow just one MySQL server instance. If that server fails, that server must be restarted or recovered before the connector can continue.</p>
</div>
</dd>
<dt class="hdlist1">High available clusters</dt>
<dd>
<p>A variety of <a href="https://dev.mysql.com/doc/mysql-ha-scalability/en/">high availability</a> solutions exist for MySQL, and they make it significantly easier to tolerate and almost immediately recover from problems and failures. Most HA MySQL clusters use GTIDs so that replicas are able to keep track of all changes on any of the primary servers.</p>
</dd>
<dt class="hdlist1">Multi-primary</dt>
<dd>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/mysql-cluster-replication-multi-source.html">Network Database (NDB) cluster replication</a> uses one or more MySQL replica nodes that each replicate from multiple primary servers. This is a powerful way to aggregate the replication of multiple MySQL clusters. This topology requires the use of GTIDs.</p>
<div class="paragraph">
<p>A Debezium MySQL connector can use these multi-primary MySQL replicas as sources, and can fail over to different multi-primary MySQL replicas as long as the new replica is caught up to the old replica. That is, the new replica has all transactions that were seen on the first replica. This works even if the connector is using only a subset of databases and/or tables, as the connector can be configured to include or exclude specific GTID sources when attempting to reconnect to a new multi-primary MySQL replica and find the correct position in the binlog.</p>
</div>
</dd>
<dt class="hdlist1">Hosted</dt>
<dd>
<p>There is support for the Debezium MySQL connector to use hosted options such as Amazon RDS and Amazon Aurora.</p>
<div class="paragraph">
<p>Because these hosted options do not allow a global read lock, table-level locks are used to create the <em>consistent snapshot</em>.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="mysql-schema-history-topic"><a class="anchor" href="#mysql-schema-history-topic"></a>Schema history topic</h3>
<div class="paragraph">
<p>When a database client queries a database, the client uses the database’s current schema.
However, the database schema can be changed at any time, which means that the connector must be able to identify what the schema was at the time each insert, update, or delete operation was recorded.
Also, a connector cannot necessarily apply the current schema to every event.
If an event is relatively old, it&#8217;s possible that it was recorded before the current schema was applied.</p>
</div>
<div class="paragraph">
<p>To ensure correct processing of events that occur after a schema change, MySQL includes in the transaction log not only the row-level changes that affect the data, but also the DDL statements that are applied to the database.
As the connector encounters these DDL statements in the binlog, it parses them and updates an in-memory representation of each table’s schema.
The connector uses this schema representation to identify the structure of the tables at the time of each insert, update, or delete operation and to produce the appropriate change event.
In a separate database schema history Kafka topic, the connector records all DDL statements along with the position in the binlog where each DDL statement appeared.</p>
</div>
<div class="paragraph">
<p>When the connector restarts after either a crash or a graceful stop, it starts reading the binlog from a specific position, that is, from a specific point in time.
The connector rebuilds the table structures that existed at this point in time by reading the database schema history Kafka topic and parsing all DDL statements up to the point in the binlog where the connector is starting.</p>
</div>
<div class="paragraph">
<p>This database schema history topic is for internal connector use only.
Optionally, the connector can also <a href="#mysql-schema-change-topic">emit schema change events to a different topic that is intended for consumer applications</a>.</p>
</div>
<div class="paragraph">
<p>When the MySQL connector captures changes in a table to which a schema change tool such as <code>gh-ost</code> or <code>pt-online-schema-change</code> is applied, there are helper tables created during the migration process.
You must configure the connector to capture changes that occur in these helper tables.
If consumers do not need the records the the connector generates for helper tables, configure a <a href="../transformations/filtering.html#message-filtering" class="xref page">single message transform (SMT)</a> to remove these records from the messages that the connector emits.</p>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#mysql-topic-names">Default names for topics</a> that receive Debezium event records.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mysql-schema-change-topic"><a class="anchor" href="#mysql-schema-change-topic"></a>Schema change topic</h3>
<div class="paragraph">
<p>You can configure a Debezium MySQL connector to produce schema change events that describe schema changes that are applied to tables in the database.
The connector writes schema change events to a Kafka topic named <code><em>&lt;topicPrefix&gt;</em></code>, where <code><em>topicPrefix</em></code> is the namespace specified in the <a href="#mysql-property-topic-prefix"><code>topic.prefix</code></a> connector configuration property.
Messages that the connector sends to the schema change topic contain a payload, and, optionally, also contain the schema of the change event message.</p>
</div>
<div class="paragraph">
<p>The payload of a schema change event message includes the following elements:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ddl</code></dt>
<dd>
<p>Provides the SQL <code>CREATE</code>, <code>ALTER</code>, or <code>DROP</code> statement that results in the schema change.</p>
</dd>
<dt class="hdlist1"><code>databaseName</code></dt>
<dd>
<p>The name of the database to which the DDL statements are applied.
The value of <code>databaseName</code> serves as the message key.</p>
</dd>
<dt class="hdlist1"><code>pos</code></dt>
<dd>
<p>The position in the binlog where the statements appear.</p>
</dd>
<dt class="hdlist1"><code>tableChanges</code></dt>
<dd>
<p>A structured representation of the entire table schema after the schema change.
The <code>tableChanges</code> field contains an array that includes entries for each column of the table.
Because the structured representation presents data in JSON or Avro format, consumers can easily read messages without first processing them through a DDL parser.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a table that is in capture mode, the connector not only stores the history of schema changes in the schema change topic, but also in an internal database schema history topic.
The internal database schema history topic is for connector use only and it is not intended for direct use by consuming applications.
Ensure that applications that require notifications about schema changes consume that information only from the schema change topic.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Never partition the database schema history topic.
For the database schema history topic to function correctly, it must maintain a consistent, global order of the event records that the connector emits to it.</p>
</div>
<div class="paragraph">
<p>To ensure that the topic is not split among partitions, set the partition count for the topic by using one of the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you create the database schema history topic manually, specify a partition count of <code>1</code>.</p>
</li>
<li>
<p>If you use the Apache Kafka broker to create the database schema history topic automatically, the topic is created, set the value of the <a href="https://kafka.apache.org/documentation/#brokerconfigs_num.partitions">Kafka <code>num.partitions</code></a> configuration option to <code>1</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The format of the messages that a connector emits to its schema change topic is in an incubating state and is subject to change without notice.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Example: Message emitted to the MySQL connector schema change topic</div>
<p>The following example shows a typical schema change message in JSON format.
The message contains a logical representation of the table schema.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "schema": { },
  "payload": {
      "source": {  <i class="conum" data-value="1"></i><b>(1)</b>
        "version": "2.3.7.Final",
        "connector": "mysql",
        "name": "mysql",
        "ts_ms": 1651535750218, <i class="conum" data-value="2"></i><b>(2)</b>
        "snapshot": "false",
        "db": "inventory",
        "sequence": null,
        "table": "customers",
        "server_id": 223344,
        "gtid": null,
        "file": "mysql-bin.000003",
        "pos": 570,
        "row": 0,
        "thread": null,
        "query": null
      },
      "databaseName": "inventory", <i class="conum" data-value="3"></i><b>(3)</b>
      "schemaName": null,
      "ddl": "ALTER TABLE customers ADD middle_name varchar(255) AFTER first_name", <i class="conum" data-value="4"></i><b>(4)</b>
      "tableChanges": [  <i class="conum" data-value="5"></i><b>(5)</b>
        {
          "type": "ALTER", <i class="conum" data-value="6"></i><b>(6)</b>
          "id": "\"inventory\".\"customers\"", <i class="conum" data-value="7"></i><b>(7)</b>
          "table": {    <i class="conum" data-value="8"></i><b>(8)</b>
            "defaultCharsetName": "utf8mb4",
            "primaryKeyColumnNames": [  <i class="conum" data-value="9"></i><b>(9)</b>
              "id"
            ],
            "columns": [  <i class="conum" data-value="10"></i><b>(10)</b>
              {
                "name": "id",
                "jdbcType": 4,
                "nativeType": null,
                "typeName": "INT",
                "typeExpression": "INT",
                "charsetName": null,
                "length": null,
                "scale": null,
                "position": 1,
                "optional": false,
                "autoIncremented": true,
                "generated": true
              },
              {
                "name": "first_name",
                "jdbcType": 12,
                "nativeType": null,
                "typeName": "VARCHAR",
                "typeExpression": "VARCHAR",
                "charsetName": "utf8mb4",
                "length": 255,
                "scale": null,
                "position": 2,
                "optional": false,
                "autoIncremented": false,
                "generated": false
              },
              {
                "name": "middle_name",
                "jdbcType": 12,
                "nativeType": null,
                "typeName": "VARCHAR",
                "typeExpression": "VARCHAR",
                "charsetName": "utf8mb4",
                "length": 255,
                "scale": null,
                "position": 3,
                "optional": true,
                "autoIncremented": false,
                "generated": false
              },
              {
                "name": "last_name",
                "jdbcType": 12,
                "nativeType": null,
                "typeName": "VARCHAR",
                "typeExpression": "VARCHAR",
                "charsetName": "utf8mb4",
                "length": 255,
                "scale": null,
                "position": 4,
                "optional": false,
                "autoIncremented": false,
                "generated": false
              },
              {
                "name": "email",
                "jdbcType": 12,
                "nativeType": null,
                "typeName": "VARCHAR",
                "typeExpression": "VARCHAR",
                "charsetName": "utf8mb4",
                "length": 255,
                "scale": null,
                "position": 5,
                "optional": false,
                "autoIncremented": false,
                "generated": false
            }
          ],
          "attributes": [ <i class="conum" data-value="11"></i><b>(11)</b>
            {
              "customAttribute": "attributeValue"
            }
          ]
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Descriptions of fields in messages emitted to the schema change topic</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 40%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>source</code> field is structured exactly as standard data change events that the connector writes to table-specific topics.
This field is useful to correlate events on different topics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ts_ms</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that displays the time at which the connector processed the event. The time is based on the system clock in the JVM running the Kafka Connect task.</p>
<p class="tableblock">In the source object, ts_ms indicates the time that the change was made in the database. By comparing the value for payload.source.ts_ms with the value for payload.ts_ms, you can determine the lag between the source database update and Debezium.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>databaseName</code><br>
<code>schemaName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the database and the schema that contains the change.
The value of the <code>databaseName</code> field is used as the message key for the record.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ddl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This field contains the DDL that is responsible for the schema change.
The <code>ddl</code> field can contain multiple DDL statements.
Each statement applies to the database in the <code>databaseName</code> field.
Multiple DDL statements appear in the order in which they were applied to the database.<br>
<br>
Clients can submit multiple DDL statements that apply to multiple databases.
If MySQL applies them atomically, the connector takes the DDL statements in order, groups them by database, and creates a schema change event for each group.
If MySQL applies them individually, the connector creates a separate schema change event for each statement.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tableChanges</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An array of one or more items that contain the schema changes generated by a DDL command.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Describes the kind of change. The value is one of the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>CREATE</code></dt>
<dd>
<p>Table created.</p>
</dd>
<dt class="hdlist1"><code>ALTER</code></dt>
<dd>
<p>Table modified.</p>
</dd>
<dt class="hdlist1"><code>DROP</code></dt>
<dd>
<p>Table deleted.</p>
</dd>
</dl>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full identifier of the table that was created, altered, or dropped.
In the case of a table rename, this identifier is a concatenation of <code><em>&lt;old&gt;</em>,<em>&lt;new&gt;</em></code> table names.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>table</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents table metadata after the applied change.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>primaryKeyColumnNames</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of columns that compose the table&#8217;s primary key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>columns</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metadata for each column in the changed table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>attributes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom attribute metadata for each table change.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For more information, see <a href="#mysql-schema-history-topic">schema history topic</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-snapshots"><a class="anchor" href="#mysql-snapshots"></a>Snapshots</h3>
<div class="paragraph">
<p>When a Debezium MySQL connector is first started, it performs an initial <em>consistent snapshot</em> of your database.
This snapshot enables the connector to establish a baseline for the current state of the database.</p>
</div>
<div class="paragraph">
<p>Debezium can use different modes when it runs a snapshot.
The snapshot mode is determined by the <a href="#mysql-property-snapshot-mode"><code>snapshot.mode</code></a> configuration property.
The default value of the property is <code>initial</code>.
You can customize the way that the connector creates snapshots by changing the value of the <code>snapshot.mode</code> property.</p>
</div>
<div class="paragraph">
<p>The connector completes a series of tasks when it performs the snapshot.
The exact steps vary with the snapshot mode and with the table locking policy that is in effect for the database.
The Debezium MySQL connector completes different steps when it performs an initial snapshot that uses a <a href="#initial-snapshot-workflow-with-global-read-lock">global read lock</a> or <a href="#initial-snapshot-workflow-with-table-level-locks">table-level locks</a>.</p>
</div>
<div class="sect3">
<h4 id="initial-snapshot-workflow-with-global-read-lock"><a class="anchor" href="#initial-snapshot-workflow-with-global-read-lock"></a>Initial snapshots that use a global read lock</h4>
<div class="paragraph">
<p>You can customize the way that the connector creates snapshots by changing the value of the <code>snapshot.mode</code> property.
If you configure a different snapshot mode, the connector completes the snapshot by using a modified version of this workflow.
For information about the snapshot process in environments that do not permit global read locks, see the <a href="#snapshot-workflow-with-table-level-locks">snapshot workflow for table-level locks</a>.</p>
</div>
<div class="paragraph">
<div class="title">Default workflow that the Debezium MySQL connector uses to perform an initial snapshot with a global read lock</div>
<p>The following table shows the steps in the workflow that Debezium follows to create a snapshot with a global read lock.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Step</th>
<th class="tableblock halign-left valign-top">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>1</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Establish a connection to the database.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>2</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Determine the tables to be captured.
By default, the connector captures the data for all non-system tables.
After the snapshot completes, the connector continues to stream data for the specified tables.
If you want the connector to capture data only from specific tables you can direct the connector to capture the data for only a subset of tables or table elements by setting properties such as <a href="#mysql-property-table-include-list"><code>table.include.list</code></a> or <a href="#mysql-property-table-exclude-list"><code>table.exclude.list</code></a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>3</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Obtain a global read lock on the tables to be captured to block <em>writes</em> by other database clients.<br></p>
</div>
<div class="paragraph">
<p>The snapshot itself does not prevent other clients from applying DDL that might interfere with the connector&#8217;s attempt to read the binlog position and table schemas.
The connector retains the global read lock while it reads the binlog position, and releases the lock as described in a later step.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>4</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Start a transaction with <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html">repeatable read semantics</a> to ensure that all subsequent reads within the transaction are done against the <em>consistent snapshot</em>.<br>
<br></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The use of these isolation semantics can slow the progress of the snapshot.
If the snapshot takes too long to complete, consider using a different isolation configuration, or skip the initial snapshot and run an <a href="#mysql-incremental-snapshots">incremental snapshot</a> instead.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>5</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Read the current binlog position.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>6</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Capture the structure of all tables in the database, or all tables that are designated for capture.
The connector persists schema information in its internal database schema history topic, including all necessary <code>DROP&#8230;&#8203;</code> and <code>CREATE&#8230;&#8203;</code> DDL statements.<br>
The schema history provides information about the structure that is in effect when a change event occurs.
<br></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the connector captures the schema of every table in the database, including tables that are not configured for capture.
If tables are not configured for capture, the initial snapshot captures only their structure; it does not capture any table data.</p>
</div>
<div class="paragraph">
<p>For more information about why snapshots persist schema information for tables that you did not include in the initial snapshot, see <a href="#understanding-why-initial-snapshots-capture-the-schema-history-for-all-tables">Understanding why initial snapshots capture the schema for all tables</a>.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>7</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Release the global read lock obtained in Step 3.
Other database clients can now write to the database.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>8</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>At the binlog position that the connector read in Step 5, the connector begins to scan the tables that are designated for capture.
  During the scan, the connector completes the following tasks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Confirms that the table was created before the snapshot began.
If the table was created after the snapshot began, the connector skips the table.
After the snapshot is complete, and the connector transitions to streaming, it emits change events for any tables that were created after the snapshot began.</p>
</li>
<li>
<p>Produces a <code>read</code> event for each row that is captured from a table.
All <code>read</code> events contain the same binlog position, which is the position that was obtained in step 5.</p>
</li>
<li>
<p>Emits each <code>read</code> event to the Kafka topic for the source table.</p>
</li>
<li>
<p>Releases data table locks, if applicable.</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>9</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit the transaction.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>10</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Record the successful completion of the snapshot in the connector offsets.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The resulting initial snapshot captures the current state of each row in the captured tables.
From this baseline state, the connector captures subsequent changes as they occur.</p>
</div>
<div class="paragraph">
<p>After the snapshot process begins, if the process is interrupted due to connector failure, rebalancing, or other reasons, the process restarts after the connector restarts.</p>
</div>
<div class="paragraph">
<p>After the connector completes the initial snapshot, it continues streaming from the position that it read in Step 5 so that it does not miss any updates.</p>
</div>
<div class="paragraph">
<p>If the connector stops again for any reason, after it restarts, it resumes streaming changes from where it previously left off.</p>
</div>
<div class="paragraph">
<p>After the connector restarts, if the logs have been pruned, the connector&#8217;s position in the logs might no longer available.
The connector then fails, and returns an error that indicates that a new snapshot is required.
To configure the connector to automatically initiate a snapshot in this situation, set the value of the <a href="#mysql-property-snapshot-mode"><code>snapshot.mode</code></a> property to <code>when_needed</code>.
For more tips on troubleshooting the Debezium MySQL connector, see <a href="#mysql-when-things-go-wrong">behavior when things go wrong</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="initial-snapshot-workflow-with-table-level-locks"><a class="anchor" href="#initial-snapshot-workflow-with-table-level-locks"></a>Initial snapshots that use table-level locks</h4>
<div class="paragraph">
<p>In some database environments administrators do not permit global read locks.
If the Debezium MySQL connector detects that global read locks are not permitted, the connector uses table-level locks when it performs snapshots.
For the connector to perform a snapshot that uses table-level locks, the database account that the Debezium connector uses to connect to MySQL must have <code>LOCK TABLES</code> privileges.</p>
</div>
<div class="paragraph">
<div class="title">Default workflow that the Debezium MySQL connector uses to perform an initial snapshot with table-level locks</div>
<p>The following workflow lists the steps that Debezium takes to create a snapshot with table-level read locks.
For information about the snapshot process in environments that do not permit global read locks, see the <a href="#initial-snapshot-workflow-with-global-read-lock">snapshot workflow for global read locks</a>.</p>
</div>
<table id="snapshot-workflow-with-table-level-locks" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Step</th>
<th class="tableblock halign-left valign-top">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Establish a connection to the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determine the tables to be captured.
By default, the connector captures all non-system tables.
To have the connector capture a subset of tables or table elements, you can set a number of <code>include</code> and <code>exclude</code> properties to filter the data, for example, <a href="#mysql-property-table-include-list"><code>table.include.list</code></a> or <a href="#mysql-property-table-exclude-list"><code>table.exclude.list</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Obtain table-level locks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Start a transaction with <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html">repeatable read semantics</a> to ensure that all subsequent reads within the transaction are done against the <em>consistent snapshot</em>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Read the current binlog position.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Read the schema of the databases and tables for which the connector is configured to capture changes.
The connector persists schema information in its internal database schema history topic, including all necessary <code>DROP&#8230;&#8203;</code> and <code>CREATE&#8230;&#8203;</code> DDL statements.<br>
The schema history provides information about the structure that is in effect when a change event occurs.
<br></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the connector captures the schema of every table in the database, including tables that are not configured for capture.
If tables are not configured for capture, the initial snapshot captures only their structure; it does not capture any table data.</p>
</div>
<div class="paragraph">
<p>For more information about why snapshots persist schema information for tables that you did not include in the initial snapshot, see <a href="#understanding-why-initial-snapshots-capture-the-schema-history-for-all-tables">Understanding why initial snapshots capture the schema for all tables</a>.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>At the binlog position that the connector read in Step 5, the connector begins to scan the tables that are designated for capture.
  During the scan, the connector completes the following tasks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Confirms that the table was created before the snapshot began.
If the table was created after the snapshot began, the connector skips the table.
After the snapshot is complete, and the connector transitions to streaming, it emits change events for any tables that were created after the snapshot began.</p>
</li>
<li>
<p>Produces a <code>read</code> event for each row that is captured from a table.
All <code>read</code> events contain the same binlog position, which is the position that was obtained in step 5.</p>
</li>
<li>
<p>Emits each <code>read</code> event to the Kafka topic for the source table.</p>
</li>
<li>
<p>Releases data table locks, if applicable.</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Commit the transaction.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Release the table-level locks.
Other database clients can now write to any previously locked tables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Record the successful completion of the snapshot in the connector offsets.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="understanding-why-initial-snapshots-capture-the-schema-history-for-all-tables"><a class="anchor" href="#understanding-why-initial-snapshots-capture-the-schema-history-for-all-tables"></a>Understanding why initial snapshots capture the schema history for all tables</h4>
<div class="paragraph">
<p>The initial snapshot that a connector runs captures two types of information:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Table data</dt>
<dd>
<p>Information about <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> operations in tables that are named in the connector&#8217;s <a href="#mysql-property-table-include-list"><code>table.include.list</code></a> property.</p>
</dd>
<dt class="hdlist1">Schema data</dt>
<dd>
<p>DDL statements that describe the structural changes that are applied to tables.
Schema data is persisted to both the internal schema history topic, and to the connector&#8217;s schema change topic, if one is configured.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>After you run an initial snapshot, you might notice that the snapshot captures schema information for tables that are not designated for capture.
By default, initial snapshots are designed to capture schema information for every table that is present in the database, not only from tables that are designated for capture.
Connectors require that the table&#8217;s schema is present in the schema history topic before they can capture a table.
By enabling the initial snapshot to capture schema data for tables that are not part of the original capture set, Debezium prepares the connector to readily capture event data from these tables should that later become necessary.
If the initial snapshot does not capture a table&#8217;s schema, you must add the schema to the history topic before the connector can capture data from the table.</p>
</div>
<div class="paragraph">
<p>In some cases, you might want to limit schema capture in the initial snapshot.
This can be useful when you want to reduce the time required to complete a snapshot.
Or when Debezium connects to the database instance through a user account that has access to multiple logical databases, but you want the connector to capture changes only from tables in a specific logic database.</p>
</div>
<div class="ulist">
<div class="title">Additional information</div>
<ul>
<li>
<p><a href="#mysql-capturing-data-from-tables-not-captured-by-the-initial-snapshot-no-schema-change">Capturing data from tables not captured by the initial snapshot (no schema change)</a></p>
</li>
<li>
<p><a href="#mysql-capturing-data-from-new-tables-with-schema-changes">Capturing data from tables not captured by the initial snapshot (schema change)</a></p>
</li>
<li>
<p>Setting the <a href="#mysql-property-database-history-store-only-captured-tables-ddl"><code>schema.history.internal.store.only.captured.tables.ddl</code></a> property to specify the tables from which to capture schema information.</p>
</li>
<li>
<p>Setting the <a href="#mysql-property-database-history-store-only-captured-databases-ddl"><code>schema.history.internal.store.only.captured.databases.ddl</code></a> property to specify the logical databases from which to capture schema changes.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="mysql-capturing-data-from-tables-not-captured-by-the-initial-snapshot-no-schema-change"><a class="anchor" href="#mysql-capturing-data-from-tables-not-captured-by-the-initial-snapshot-no-schema-change"></a>Capturing data from tables not captured by the initial snapshot (no schema change)</h4>
<div class="paragraph">
<p>In some cases, you might want the connector to capture data from a table whose schema was not captured by the initial snapshot.
Depending on the connector configuration, the initial snapshot might capture the table schema only for specific tables in the database.
If the table schema is not present in the history topic, the connector fails to capture the table, and reports a missing schema error.</p>
</div>
<div class="paragraph">
<p>You might still be able to capture data from the table, but you must perform additional steps to add the table schema.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You want to capture data from a table with a schema that the connector did not capture during the initial snapshot.</p>
</li>
<li>
<p>In the transaction log, all entries for the table use the same schema.
For information about capturing data from a new table that has undergone structural changes, see <a href="#mysql-capturing-data-from-new-tables-with-schema-changes">Capturing data from tables not captured by the initial snapshot (schema change)</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Stop the connector.</p>
</li>
<li>
<p>Remove the internal database schema history topic that is specified by the <a href="#mysql-property-database-history-kafka-topic"><code>schema.history.internal.kafka.topic property</code></a>.</p>
</li>
<li>
<p>Apply the following changes to the connector configuration:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the <a href="#mysql-property-snapshot-mode"><code>snapshot.mode</code></a> to <code>schema_only_recovery</code>.</p>
</li>
<li>
<p>Set the value of <a href="#mysql-property-database-history-store-only-captured-tables-ddl"><code>schema.history.internal.store.only.captured.tables.ddl</code></a> to <code>false</code>.</p>
</li>
<li>
<p>Add the tables that you want the connector to capture to <code>table.include.list</code>.
This guarantees that in the future, the connector can reconstruct the schema history for all tables.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Restart the connector.
The snapshot recovery process rebuilds the schema history based on the current structure of the tables.</p>
</li>
<li>
<p>(Optional) After the snapshot completes, initiate an <a href="#mysql-incremental-snapshots">incremental snapshot</a> to capture existing data for newly added tables along with changes to other tables that occurred while that connector was off-line.</p>
</li>
<li>
<p>(Optional) Reset the <code>snapshot.mode</code> back to <code>schema_only</code> to prevent the connector from initiating recovery after a future restart.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="mysql-capturing-data-from-new-tables-with-schema-changes"><a class="anchor" href="#mysql-capturing-data-from-new-tables-with-schema-changes"></a>Capturing data from tables not captured by the initial snapshot (schema change)</h4>
<div class="paragraph">
<p>If a schema change is applied to a table, records that are committed before the schema change have different structures than those that were committed after the change.
When Debezium captures data from a table, it reads the schema history to ensure that it applies the correct schema to each event.
If the schema is not present in the schema history topic, the connector is unable to capture the table, and an error results.</p>
</div>
<div class="paragraph">
<p>If you want to capture data from a table that was not captured by the initial snapshot, and the schema of the table was modified, you must add the schema to the history topic, if it is not already available.
You can add the schema by running a new schema snapshot, or by running an initial snapshot for the table.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You want to capture data from a table with a schema that the connector did not capture during the initial snapshot.</p>
</li>
<li>
<p>A schema change was applied to the table so that the records to be captured do not have a uniform structure.</p>
</li>
</ul>
</div>
<div class="dlist">
<div class="title">Procedure</div>
<dl>
<dt class="hdlist1">Initial snapshot captured the schema for all tables (<code>store.only.captured.tables.ddl</code> was set to <code>false</code>)</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit the <a href="#mysql-property-table-include-list"><code>table.include.list</code></a> property to specify the tables that you want to capture.</p>
</li>
<li>
<p>Restart the connector.</p>
</li>
<li>
<p>Initiate an <a href="#mysql-incremental-snapshots">incremental snapshot</a> if you want to capture existing data from the newly added tables.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1">Initial snapshot did not capture the schema for all tables (<code>store.only.captured.tables.ddl</code> was set to <code>true</code>)</dt>
<dd>
<p>If the initial snapshot did not save the schema of the table that you want to capture, complete one of the following procedures:</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Procedure 1: Schema snapshot, followed by incremental snapshot</dt>
<dd>
<p>In this procedure, the connector first performs a schema snapshot.
You can then initiate an incremental snapshot to enable the connector to synchronize data.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop the connector.</p>
</li>
<li>
<p>Remove the internal database schema history topic that is specified by the <a href="#mysql-property-database-history-kafka-topic"><code>schema.history.internal.kafka.topic property</code></a>.</p>
</li>
<li>
<p>Clear the offsets in the configured Kafka Connect <a href="https://kafka.apache.org/documentation/#connectconfigs_offset.storage.topic"><code>offset.storage.topic</code></a>.
For more information about how to remove offsets, see the <a href="https://debezium.io/documentation/faq/#how_to_remove_committed_offsets_for_a_connector">Debezium community FAQ</a>.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Removing offsets should be performed only by advanced users who have experience in manipulating internal Kafka Connect data.
This operation is potentially destructive, and should be performed only as a last resort.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Set values for properties in the connector configuration as described in the following steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the value of the <a href="#mysql-property-snapshot-mode"><code>snapshot.mode</code></a> property to <code>schema_only</code>.</p>
</li>
<li>
<p>Edit the <a href="#mysql-property-table-include-list"><code>table.include.list</code></a> to add the tables that you want to capture.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Restart the connector.</p>
</li>
<li>
<p>Wait for Debezium to capture the schema of the new and existing tables.
Data changes that occurred any tables after the connector stopped are not captured.</p>
</li>
<li>
<p>To ensure that no data is lost, initiate an <a href="#mysql-incremental-snapshots">incremental snapshot</a>.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1">Procedure 2: Initial snapshot, followed by optional incremental snapshot</dt>
<dd>
<p>In this procedure the connector performs a full initial snapshot of the database.
As with any initial snapshot, in a database with many large tables, running an initial snapshot can be a time-consuming operation.
After the snapshot completes, you can optionally trigger an incremental snapshot to capture any changes that occur while the connector is off-line.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop the connector.</p>
</li>
<li>
<p>Remove the internal database schema history topic that is specified by the <a href="#mysql-property-database-history-kafka-topic"><code>schema.history.internal.kafka.topic property</code></a>.</p>
</li>
<li>
<p>Clear the offsets in the configured Kafka Connect <a href="https://kafka.apache.org/documentation/#connectconfigs_offset.storage.topic"><code>offset.storage.topic</code></a>.
For more information about how to remove offsets, see the <a href="https://debezium.io/documentation/faq/#how_to_remove_committed_offsets_for_a_connector">Debezium community FAQ</a>.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Removing offsets should be performed only by advanced users who have experience in manipulating internal Kafka Connect data.
This operation is potentially destructive, and should be performed only as a last resort.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Edit the <a href="#mysql-property-table-include-list"><code>table.include.list</code></a> to add the tables that you want to capture.</p>
</li>
<li>
<p>Set values for properties in the connector configuration as described in the following steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the value of the <a href="#mysql-property-snapshot-mode"><code>snapshot.mode</code></a> property to <code>initial</code>.</p>
</li>
<li>
<p>(Optional) Set <a href="#mysql-property-database-history-store-only-captured-tables-ddl"><code>schema.history.internal.store.only.captured.tables.ddl</code></a> to <code>false</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Restart the connector.
The connector takes a full database snapshot.
After the snapshot completes, the connector transitions to streaming.</p>
</li>
<li>
<p>(Optional) To capture any data that changed while the connector was off-line, initiate an <a href="#debezium-mysql-incremental-snapshots">incremental snapshot</a>.</p>
</li>
</ol>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mysql-ad-hoc-snapshots"><a class="anchor" href="#mysql-ad-hoc-snapshots"></a>Ad hoc snapshots</h3>
<div class="paragraph">
<p>By default, a connector runs an initial snapshot operation only after it starts for the first time.
Following this initial snapshot, under normal circumstances, the connector does not repeat the snapshot process.
Any future change event data that the connector captures comes in through the streaming process only.</p>
</div>
<div class="paragraph">
<p>However, in some situations the data that the connector obtained during the initial snapshot might become stale, lost, or incomplete.
To provide a mechanism for recapturing table data, Debezium includes an option to perform ad hoc snapshots.
The following changes in a database might be cause for performing an ad hoc snapshot:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The connector configuration is modified to capture a different set of tables.</p>
</li>
<li>
<p>Kafka topics are deleted and must be rebuilt.</p>
</li>
<li>
<p>Data corruption occurs due to a configuration error or some other problem.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can re-run a snapshot for a table for which you previously captured a snapshot by initiating a so-called <em>ad-hoc snapshot</em>.
Ad hoc snapshots require the use of <a href="../configuration/signalling.html#sending-signals-to-a-debezium-connector" class="xref page">signaling tables</a>.
You initiate an ad hoc snapshot by sending a signal request to the Debezium signaling table.</p>
</div>
<div class="paragraph">
<p>When you initiate an ad hoc snapshot of an existing table, the connector appends content to the topic that already exists for the table.
If a previously existing topic was removed, Debezium can create a topic automatically if <a href="../configuration/topic-auto-create-config.html#customizing-debezium-automatically-created-topics" class="xref page">automatic topic creation</a> is enabled.</p>
</div>
<div class="paragraph">
<p>Ad hoc snapshot signals specify the tables to include in the snapshot.
The snapshot can capture the entire contents of the database, or capture only a subset of the tables in the database.
Also, the snapshot can capture a subset of the contents of the table(s) in the database.</p>
</div>
<div class="paragraph">
<p>You specify the tables to capture by sending an <code>execute-snapshot</code> message to the signaling table.
Set the type of the <code>execute-snapshot</code> signal to <code>incremental</code>, and provide the names of the tables to include in the snapshot, as described in the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Example of an ad hoc <code>execute-snapshot</code> signal record</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>incremental</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the type of snapshot that you want to run.<br>
Setting the type is optional.
Currently, you can request only <code>incremental</code> snapshots.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data-collections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>N/A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An array that contains regular expressions matching the fully-qualified names of the table to be snapshotted.<br>
The format of the names is the same as for the <code>signal.data.collection</code> configuration option.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>additional-condition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>N/A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional string, which specifies a condition based on the column(s) of the table(s), to capture a
subset of the contents of the table(s).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>surrogate-key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>N/A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional string that specifies the column name that the connector uses as the primary key of a table during the snapshot process.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Triggering an ad hoc snapshot</div>
<p>You initiate an ad hoc snapshot by adding an entry with the <code>execute-snapshot</code> signal type to the signaling table.
After the connector processes the message, it begins the snapshot operation.
The snapshot process reads the first and last primary key values and uses those values as the start and end point for each table.
Based on the number of entries in the table, and the configured chunk size, Debezium divides the table into chunks, and proceeds to snapshot each chunk, in succession, one at a time.</p>
</div>
<div class="paragraph">
<p>Currently, the <code>execute-snapshot</code> action type triggers <a href="../configuration/signalling.html#debezium-signaling-incremental-snapshots" class="xref page">incremental snapshots</a> only.
For more information, see <a href="#debezium-mysql-incremental-snapshots">Incremental snapshots</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-incremental-snapshots"><a class="anchor" href="#mysql-incremental-snapshots"></a>Incremental snapshots</h3>
<div class="paragraph">
<p>To provide flexibility in managing snapshots, Debezium includes a supplementary snapshot mechanism, known as <em>incremental snapshotting</em>.
Incremental snapshots rely on the Debezium mechanism for <a href="../configuration/signalling.html#sending-signals-to-a-debezium-connector" class="xref page">sending signals to a Debezium connector</a>.
Incremental snapshots are based on the <a href="https://github.com/debezium/debezium-design-documents/blob/main/DDD-3.md">DDD-3</a> design document.</p>
</div>
<div class="paragraph">
<p>In an incremental snapshot, instead of capturing the full state of a database all at once, as in an initial snapshot, Debezium captures each table in phases, in a series of configurable chunks.
You can specify the tables that you want the snapshot to capture and the <a href="#mysql-property-incremental-snapshot-chunk-size">size of each chunk</a>.
The chunk size determines the number of rows that the snapshot collects during each fetch operation on the database.
The default chunk size for incremental snapshots is 1024 rows.</p>
</div>
<div class="paragraph">
<p>As an incremental snapshot proceeds, Debezium uses watermarks to track its progress, maintaining a record of each table row that it captures.
This phased approach to capturing data provides the following advantages over the standard initial snapshot process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can run incremental snapshots in parallel with streamed data capture, instead of postponing streaming until the snapshot completes.
The connector continues to capture near real-time events from the change log throughout the snapshot process, and neither operation blocks the other.</p>
</li>
<li>
<p>If the progress of an incremental snapshot is interrupted, you can resume it without losing any data.
After the process resumes, the snapshot begins at the point where it stopped, rather than recapturing the table from the beginning.</p>
</li>
<li>
<p>You can run an incremental snapshot on demand at any time, and repeat the process as needed to adapt to database updates.
For example, you might re-run a snapshot after you modify the connector configuration to add a table to its <a href="#mysql-property-table-include-list"><code>table.include.list</code></a> property.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Incremental snapshot process</div>
<p>When you run an incremental snapshot, Debezium sorts each table by primary key and then splits the table into chunks based on the <a href="#mysql-property-incremental-snapshot-chunk-size">configured chunk size</a>.
Working chunk by chunk, it then captures each table row in a chunk.
For each row that it captures, the snapshot emits a <code>READ</code> event.
That event represents the value of the row when the snapshot for the chunk began.</p>
</div>
<div class="paragraph">
<p>As a snapshot proceeds, it’s likely that other processes continue to access the database, potentially modifying table records.
To reflect such changes, <code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code> operations are committed to the transaction log as per usual.
Similarly, the ongoing Debezium streaming process continues to detect these change events and emits corresponding change event records to Kafka.</p>
</div>
<div class="paragraph">
<div class="title">How Debezium resolves collisions among records with the same primary key</div>
<p>In some cases, the <code>UPDATE</code> or <code>DELETE</code> events that the streaming process emits are received out of sequence.
That is, the streaming process might emit an event that modifies a table row before the snapshot captures the chunk that contains the <code>READ</code> event for that row.
When the snapshot eventually emits the corresponding <code>READ</code> event for the row, its value is already superseded.
To ensure that incremental snapshot events that arrive out of sequence are processed in the correct logical order, Debezium employs a buffering scheme for resolving collisions.
Only after collisions between the snapshot events and the streamed events are resolved does Debezium emit an event record to Kafka.</p>
</div>
<div class="paragraph">
<div class="title">Snapshot window</div>
<p>To assist in resolving collisions between late-arriving <code>READ</code> events and streamed events that modify the same table row, Debezium employs a so-called <em>snapshot window</em>.
The snapshot windows demarcates the interval during which an incremental snapshot captures data for a specified table chunk.
Before the snapshot window for a chunk opens, Debezium follows its usual behavior and emits events from the transaction log directly downstream to the target Kafka topic.
But from the moment that the snapshot for a particular chunk opens, until it closes, Debezium performs a de-duplication step to resolve collisions between events that have the same primary key..</p>
</div>
<div class="paragraph">
<p>For each data collection, the Debezium emits two types of events, and stores the records for them both in a single destination Kafka topic.
The snapshot records that it  captures directly from a table are emitted as <code>READ</code> operations.
Meanwhile, as users continue to update records in the data collection, and the transaction log is updated to reflect each commit, Debezium emits <code>UPDATE</code> or <code>DELETE</code> operations for each change.</p>
</div>
<div class="paragraph">
<p>As the snapshot window opens, and Debezium begins processing a snapshot chunk, it delivers snapshot records to a memory buffer.
During the snapshot windows, the primary keys of the <code>READ</code> events in the buffer are compared to the primary keys of the incoming streamed events.
If no match is found, the streamed event record is sent directly to Kafka.
If Debezium detects a match, it discards the buffered <code>READ</code> event, and writes the streamed record to the destination topic, because the streamed event logically supersede the static snapshot event.
After the snapshot window for the chunk closes, the buffer contains only <code>READ</code> events for which no related transaction log events exist.
Debezium emits these remaining <code>READ</code> events to the table&#8217;s Kafka topic.</p>
</div>
<div class="paragraph">
<p>The connector repeats the process for each snapshot chunk.</p>
</div>
<div class="sect3">
<h4 id="mysql-triggering-an-incremental-snapshot"><a class="anchor" href="#mysql-triggering-an-incremental-snapshot"></a>Triggering an incremental snapshot</h4>
<div class="paragraph">
<p>Currently, the only way to initiate an incremental snapshot is to send an <a href="../configuration/signalling.html#debezium-signaling-ad-hoc-snapshots" class="xref page">ad hoc snapshot signal</a> to the signaling table on the source database.</p>
</div>
<div class="paragraph">
<p>You submit a signal to the signaling table as SQL <code>INSERT</code> queries.</p>
</div>
<div class="paragraph">
<p>After Debezium detects the change in the signaling table, it reads the signal, and runs the requested snapshot operation.</p>
</div>
<div class="paragraph">
<p>The query that you submit specifies the tables to include in the snapshot, and, optionally, specifies the kind of snapshot operation.
Currently, the only valid option for snapshots operations is the default value, <code>incremental</code>.</p>
</div>
<div class="paragraph">
<p>To specify the tables to include in the snapshot, provide a <code>data-collections</code> array that lists the tables or an array of regular expressions used to match tables, for example,<br></p>
</div>
<div class="paragraph">
<p><code>{"data-collections": ["public.MyFirstTable", "public.MySecondTable"]}</code><br></p>
</div>
<div class="paragraph">
<p>The <code>data-collections</code> array for an incremental snapshot signal has no default value.
If the <code>data-collections</code> array is empty, Debezium detects that no action is required and does not perform a snapshot.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the name of a table that you want to include in a snapshot contains a dot (<code>.</code>) in the name of the database, schema, or table, to add the table to the <code>data-collections</code> array, you must escape each part of the name in double quotes.<br>
<br>
For example, to include a table that exists in the <code><strong>public</strong></code> schema and that has the name <code><strong>My.Table</strong></code>, use the following format: <code><strong>"public"."My.Table"</strong></code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="../configuration/signalling.html#debezium-signaling-enabling-source-signaling-channel" class="xref page">Signaling is enabled</a>.<br></p>
<div class="ulist">
<ul>
<li>
<p>A signaling data collection exists on the source database.</p>
</li>
<li>
<p>The signaling data collection is specified in the <a href="#mysql-property-signal-data-collection"><code>signal.data.collection</code></a> property.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Using a source signaling channel to trigger an incremental snapshot</div>
<ol class="arabic">
<li>
<p>Send a SQL query to add the ad hoc incremental snapshot request to the signaling table:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO <em>&lt;signalTable&gt;</em> (id, type, data) VALUES (<em>'&lt;id&gt;'</em>, <em>'&lt;snapshotType&gt;'</em>, '{"data-collections": ["<em>&lt;tableName&gt;</em>","<em>&lt;tableName&gt;</em>"],"type":"<em>&lt;snapshotType&gt;</em>","additional-condition":"<em>&lt;additional-condition&gt;</em>"}');</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO myschema.debezium_signal (id, type, data) <i class="conum" data-value="1"></i><b>(1)</b>
values ('ad-hoc-1',   <i class="conum" data-value="2"></i><b>(2)</b>
    'execute-snapshot',  <i class="conum" data-value="3"></i><b>(3)</b>
    '{"data-collections": ["schema1.table1", "schema2.table2"], <i class="conum" data-value="4"></i><b>(4)</b>
    "type":"incremental"}, <i class="conum" data-value="5"></i><b>(5)</b>
    "additional-condition":"color=blue"}'); <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>The values of the <code>id</code>,<code>type</code>, and <code>data</code> parameters in the command correspond to the <a href="../configuration/signalling.html#debezium-signaling-description-of-required-structure-of-a-signaling-data-collection" class="xref page">fields of the signaling table</a>.</p>
</div>
<div class="paragraph">
<p>The following table describes the parameters in the example:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Descriptions of fields in a SQL command for sending an incremental snapshot signal to the signaling table</caption>
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 22.2222%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myschema.debezium_signal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the fully-qualified name of the signaling table on the source database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ad-hoc-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>id</code> parameter specifies an arbitrary string that is assigned as the <code>id</code> identifier for the signal request.<br>
Use this string to identify logging messages to entries in the signaling table.
Debezium does not use this string.
Rather, during the snapshot, Debezium generates its own <code>id</code> string as a watermarking signal.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>execute-snapshot</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>type</code> parameter specifies the operation that the signal is intended to trigger.<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data-collections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A required component of the <code>data</code> field of a signal that specifies an array of table names or regular expressions to match table names to include in the snapshot.<br>
The array lists regular expressions which match tables by their fully-qualified names, using the same format as you use to specify the name of the connector&#8217;s signaling table in the <a href="#mysql-property-signal-data-collection"><code>signal.data.collection</code></a> configuration property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>incremental</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional <code>type</code> component of the <code>data</code> field of a signal that specifies the kind of snapshot operation to run.<br>
Currently, the only valid option is the default value, <code>incremental</code>.<br>
If you do not specify a value, the connector runs an incremental snapshot.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>additional-condition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional string, which specifies a condition based on the column(s) of the table(s), to capture a
subset of the contents of the tables.
For more information about the <code>additional-condition</code> parameter, see <a href="#mysql-incremental-snapshots-additional-condition">Ad hoc incremental snapshots with <code>additional-condition</code></a>.</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
<div id="mysql-incremental-snapshots-additional-condition" class="paragraph">
<div class="title">Ad hoc incremental snapshots with <code>additional-condition</code></div>
<p>If you want a snapshot to include only a subset of the content in a table, you can modify the signal request by appending an <code>additional-condition</code> parameter to the snapshot signal.</p>
</div>
<div class="paragraph">
<p>The SQL query for a typical snapshot takes the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM <em>&lt;tableName&gt;</em> ....</code></pre>
</div>
</div>
<div class="paragraph">
<p>By adding an <code>additional-condition</code> parameter, you append a <code>WHERE</code> condition to the SQL query, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT * FROM <em>&lt;tableName&gt;</em> WHERE <em>&lt;additional-condition&gt;</em> ....</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows a SQL query to send an ad hoc incremental snapshot request with an additional condition to the signaling table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO <em>&lt;signalTable&gt;</em> (id, type, data) VALUES (<em>'&lt;id&gt;'</em>, <em>'&lt;snapshotType&gt;'</em>, '{"data-collections": ["<em>&lt;tableName&gt;</em>","<em>&lt;tableName&gt;</em>"],"type":"<em>&lt;snapshotType&gt;</em>","additional-condition":"<em>&lt;additional-condition&gt;</em>"}');</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, suppose you have a <code>products</code> table that contains the following columns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code> (primary key)</p>
</li>
<li>
<p><code>color</code></p>
</li>
<li>
<p><code>quantity</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want an incremental snapshot of the <code>products</code> table to include only the data items where <code>color=blue</code>, you can use the following SQL statement to trigger the snapshot:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO myschema.debezium_signal (id, type, data) VALUES('ad-hoc-1', 'execute-snapshot', '{"data-collections": ["schema1.products"],"type":"incremental", "additional-condition":"color=blue"}');</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>additional-condition</code> parameter also enables you to pass conditions that are based on more than one column.
For example, using the <code>products</code> table from the previous example, you can submit a query that triggers an incremental snapshot that includes the data of only those items for which <code>color=blue</code> and <code>quantity&gt;10</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO myschema.debezium_signal (id, type, data) VALUES('ad-hoc-1', 'execute-snapshot', '{"data-collections": ["schema1.products"],"type":"incremental", "additional-condition":"color=blue AND quantity&gt;10"}');</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example, shows the JSON for an incremental snapshot event that is captured by a connector.</p>
</div>
<div class="listingblock">
<div class="title">Example: Incremental snapshot event message</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "before":null,
    "after": {
        "pk":"1",
        "value":"New data"
    },
    "source": {
        ...
        "snapshot":"incremental" <i class="conum" data-value="1"></i><b>(1)</b>
    },
    "op":"r", <i class="conum" data-value="2"></i><b>(2)</b>
    "ts_ms":"1620393591654",
    "transaction":null
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>snapshot</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the type of snapshot operation to run.<br>
Currently, the only valid option is the default value, <code>incremental</code>.<br>
Specifying a <code>type</code> value in the SQL query that you submit to the signaling table is optional.<br>
If you do not specify a value, the connector runs an incremental snapshot.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>op</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the event type.<br>
The value for snapshot events is <code>r</code>, signifying a <code>READ</code> operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="mysql-triggering-an-incremental-snapshot-kafka"><a class="anchor" href="#mysql-triggering-an-incremental-snapshot-kafka"></a>Using the Kafka signaling channel to trigger an incremental snapshot</h4>
<div class="paragraph">
<p>You can send a message to the <a href="../configuration/signalling.html#debezium-signaling-enabling-kafka-signaling-channel" class="xref page">configured Kafka topic</a> to request the connector to run an ad hoc incremental snapshot.</p>
</div>
<div class="paragraph">
<p>The key of the Kafka message must match the value of the <code>topic.prefix</code> connector configuration option.</p>
</div>
<div class="paragraph">
<p>The value of the message is a JSON object with <code>type</code> and <code>data</code> fields.</p>
</div>
<div class="paragraph">
<p>The signal type is <code>execute-snapshot</code>, and the <code>data</code> field must have the following fields:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Execute snapshot data fields</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>incremental</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the snapshot to be executed.
Currently Debezium supports only the <code>incremental</code> type. <br>
See the next section for more details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data-collections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>N/A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An array of comma-separated regular expressions that match the fully-qualified names of tables to include in the snapshot.<br>
Specify the names by using the same format as is required for the <a href="#mysql-property-signal-data-collection">signal.data.collection</a> configuration option.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>additional-condition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>N/A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional string that specifies a condition that the connector evaluates to designate a subset of columns to include in a snapshot.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example of the execute-snapshot Kafka message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Key = `test_connector`

Value = `{"type":"execute-snapshot","data": {"data-collections": ["schema1.table1", "schema1.table2"], "type": "INCREMENTAL"}}`</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Ad hoc incremental snapshots with additional-condition</div>
<p>Debezium uses the <code>additional-condition</code> field to select a subset of a table&#8217;s content.</p>
</div>
<div class="paragraph">
<p>Typically, when Debezium runs a snapshot, it runs a SQL query such as:</p>
</div>
<div class="paragraph">
<p><code>SELECT * FROM <em>&lt;tableName&gt;</em> &#8230;&#8203;.</code></p>
</div>
<div class="paragraph">
<p>When the snapshot request includes an <code>additional-condition</code>, the <code>additional-condition</code> is appended to the SQL query, for example:</p>
</div>
<div class="paragraph">
<p><code>SELECT * FROM <em>&lt;tableName&gt;</em> WHERE <em>&lt;additional-condition&gt;</em> &#8230;&#8203;.</code></p>
</div>
<div class="paragraph">
<p>For example, given a <code>products</code> table with the columns <code>id</code> (primary key), <code>color</code>, and <code>brand</code>, if you want a snapshot to include only content for which <code>color='blue'</code>, when you request the snapshot, you could append an <code>additional-condition</code> statement to filter the content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Key = `test_connector`

Value = `{"type":"execute-snapshot","data": {"data-collections": ["schema1.products"], "type": "INCREMENTAL", "additional-condition":"color='blue'"}}`</pre>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>additional-condition</code> statement to pass conditions based on multiple columns.
For example, using the same <code>products</code> table as in the previous example, if you want a snapshot to include only the content from the <code>products</code> table for which <code>color='blue'</code>, and <code>brand='MyBrand'</code>, you could send the following request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Key = `test_connector`

Value = `{"type":"execute-snapshot","data": {"data-collections": ["schema1.products"], "type": "INCREMENTAL", "additional-condition":"color='blue' AND brand='MyBrand'"}}`</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mysql-stopping-an-incremental-snapshot"><a class="anchor" href="#mysql-stopping-an-incremental-snapshot"></a>Stopping an incremental snapshot</h4>
<div class="paragraph">
<p>You can also stop an incremental snapshot by sending a signal to the table on the source database.
You submit a stop snapshot signal to the table by sending a SQL <code>INSERT</code> query.</p>
</div>
<div class="paragraph">
<p>After Debezium detects the change in the signaling table, it reads the signal, and stops the incremental snapshot operation if it&#8217;s in progress.</p>
</div>
<div class="paragraph">
<p>The query that you submit specifies the snapshot operation of <code>incremental</code>, and, optionally, the tables of the current running snapshot to be removed.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="../configuration/signalling.html#debezium-signaling-enabling-source-signaling-channel" class="xref page">Signaling is enabled</a>.<br></p>
<div class="ulist">
<ul>
<li>
<p>A signaling data collection exists on the source database.</p>
</li>
<li>
<p>The signaling data collection is specified in the <a href="#mysql-property-signal-data-collection"><code>signal.data.collection</code></a> property.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Using a source signaling channel to stop an incremental snapshot</div>
<ol class="arabic">
<li>
<p>Send a SQL query to stop the ad hoc incremental snapshot to the signaling table:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO <em>&lt;signalTable&gt;</em> (id, type, data) values (<em>'&lt;id&gt;'</em>, 'stop-snapshot', '{"data-collections": ["<em>&lt;tableName&gt;</em>","<em>&lt;tableName&gt;</em>"],"type":"incremental"}');</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO myschema.debezium_signal (id, type, data) <i class="conum" data-value="1"></i><b>(1)</b>
values ('ad-hoc-1',   <i class="conum" data-value="2"></i><b>(2)</b>
    'stop-snapshot',  <i class="conum" data-value="3"></i><b>(3)</b>
    '{"data-collections": ["schema1.table1", "schema2.table2"], <i class="conum" data-value="4"></i><b>(4)</b>
    "type":"incremental"}'); <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>The values of the <code>id</code>, <code>type</code>, and <code>data</code> parameters in the signal command correspond to the <a href="../configuration/signalling.html#debezium-signaling-description-of-required-structure-of-a-signaling-data-collection" class="xref page">fields of the signaling table</a>.</p>
</div>
<div class="paragraph">
<p>The following table describes the parameters in the example:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Descriptions of fields in a SQL command for sending a stop incremental snapshot signal to the signaling table</caption>
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 22.2222%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myschema.debezium_signal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the fully-qualified name of the signaling table on the source database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ad-hoc-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>id</code> parameter specifies an arbitrary string that is assigned as the <code>id</code> identifier for the signal request.<br>
Use this string to identify logging messages to entries in the signaling table.
Debezium does not use this string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stop-snapshot</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies <code>type</code> parameter specifies the operation that the signal is intended to trigger.<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data-collections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional component of the <code>data</code> field of a signal that specifies an array of table names or regular expressions to match table names to remove from the snapshot.<br>
The array lists regular expressions which match tables by their fully-qualified names, using the same format as you use to specify the name of the connector&#8217;s signaling table in the <a href="#mysql-property-signal-data-collection"><code>signal.data.collection</code></a> configuration property.
If this component of the <code>data</code> field is omitted, the signal stops the entire incremental snapshot that is in progress.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>incremental</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A required component of the <code>data</code> field of a signal that specifies the kind of snapshot operation that is to be stopped.<br>
Currently, the only valid option is <code>incremental</code>.<br>
If you do not specify a <code>type</code> value, the signal fails to stop the incremental snapshot.</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="mysql-stopping-an-incremental-snapshot-kafka"><a class="anchor" href="#mysql-stopping-an-incremental-snapshot-kafka"></a>Using the Kafka signaling channel to stop an incremental snapshot</h4>
<div class="paragraph">
<p>You can send a signal message to the <a href="../configuration/signalling.html#debezium-signaling-enabling-kafka-signaling-channel" class="xref page">configured Kafka signaling topic</a> to stop an ad hoc incremental snapshot.</p>
</div>
<div class="paragraph">
<p>The key of the Kafka message must match the value of the <code>topic.prefix</code> connector configuration option.</p>
</div>
<div class="paragraph">
<p>The value of the message is a JSON object with <code>type</code> and <code>data</code> fields.</p>
</div>
<div class="paragraph">
<p>The signal type is <code>stop-snapshot</code>, and the <code>data</code> field must have the following fields:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Execute snapshot data fields</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>incremental</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the snapshot to be executed.
Currently Debezium supports only the <code>incremental</code> type. <br>
See the next section for more details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data-collections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>N/A</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional array of comma-separated regular expressions that match the fully-qualified names of the tables to include in the snapshot.<br>
Specify the names by using the same format as is required for the <a href="#mysql-property-signal-data-collection">signal.data.collection</a> configuration option.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example shows a typical <code>stop-snapshot</code> Kafka message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Key = `test_connector`

Value = `{"type":"stop-snapshot","data": {"data-collections": ["schema1.table1", "schema1.table2"], "type": "INCREMENTAL"}}`</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mysql-read-only-incremental-snapshots"><a class="anchor" href="#mysql-read-only-incremental-snapshots"></a>Read-only incremental snapshots</h4>
<div class="paragraph">
<p>The MySQL connector allows for running incremental snapshots with a read-only connection to the database.
To run an incremental snapshot with read-only access, the connector uses the executed global transaction IDs (GTID) set as high and low watermarks.
The state of a chunk&#8217;s window is updated by comparing the GTIDs of binary log (binlog) events or the server&#8217;s heartbeats against low and high watermarks.</p>
</div>
<div class="paragraph">
<p>To switch to a read-only implementation, set the value of the <a href="#mysql-property-read-only"><code>read.only</code></a> property to <code>true</code>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="#enable-mysql-gtids">Enable MySQL GTIDs</a>.</p>
</li>
<li>
<p>If the connector reads from a multi-threaded replica (that is, a replica for which the value of <code>replica_parallel_workers</code> is greater than <code>0</code>)
you must set one of the following options:</p>
<div class="ulist">
<ul>
<li>
<p><code>replica_preserve_commit_order=ON</code></p>
</li>
<li>
<p><code>slave_preserve_commit_order=ON</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_ad_hoc_read_only_incremental_snapshots"><a class="anchor" href="#_ad_hoc_read_only_incremental_snapshots"></a>Ad hoc read-only incremental snapshots</h4>
<div class="paragraph">
<p>When the MySQL connection is read-only, you can use the <a href="../configuration/signalling.html#debezium-signaling-enabling-kafka-signaling-channel" class="xref page">kafka signaling channel</a> to send messages to Kafka topic.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mysql-snapshot-events"><a class="anchor" href="#mysql-snapshot-events"></a>Operation type of snapshot events</h3>
<div class="paragraph">
<p>The MySQL connector emits snapshot events as <code>READ</code> operations <code>("op" : "r")</code>.
If you prefer that the connector emits snapshot events as <code>CREATE</code> (<code>c</code>) events, configure the Debezium <code>ReadToInsertEvent</code> single message transform (SMT) to modify the event type.</p>
</div>
<div class="paragraph">
<p>The following example shows how to configure the SMT:</p>
</div>
<div class="listingblock">
<div class="title">Example: Using the <code>ReadToInsertEvent</code> SMT to change the type of snapshot events</div>
<div class="content">
<pre>transforms=snapshotasinsert,...
transforms.snapshotasinsert.type=io.debezium.connector.mysql.transforms.ReadToInsertEvent</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mysql-topic-names"><a class="anchor" href="#mysql-topic-names"></a>Topic names</h3>
<div class="paragraph">
<p>By default, the MySQL connector writes change events for all of the <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> operations that occur in a table to a single Apache Kafka topic that is specific to that table.</p>
</div>
<div class="paragraph">
<p>The connector uses the following convention to name change event topics:</p>
</div>
<div class="paragraph">
<p><em>topicPrefix.databaseName.tableName</em></p>
</div>
<div class="paragraph">
<p>Suppose that <code>fulfillment</code> is the topic prefix, <code>inventory</code> is the database name, and the database contains tables named <code>orders</code>, <code>customers</code>, and <code>products</code>.
The Debezium MySQL connector emits events to three Kafka topics, one for each table in the database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>fulfillment.inventory.orders
fulfillment.inventory.customers
fulfillment.inventory.products</pre>
</div>
</div>
<div class="paragraph">
<p>The following list provides definitions for the components of the default name:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>topicPrefix</em></dt>
<dd>
<p>The topic prefix as specified by the <a href="#mysql-property-topic-prefix"><code>topic.prefix</code></a> connector configuration property.</p>
</dd>
<dt class="hdlist1"><em>schemaName</em></dt>
<dd>
<p>The name of the schema in which the operation occurred.</p>
</dd>
<dt class="hdlist1"><em>tableName</em></dt>
<dd>
<p>The name of the table in which the operation occurred.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The connector applies similar naming conventions to label its internal database schema history topics, <a href="#mysql-schema-change-topic">schema change topics</a>, and <a href="#mysql-transaction-metadata">transaction metadata topics</a>.</p>
</div>
<div class="paragraph">
<p>If the default topic name do not meet your requirements, you can configure custom topic names.
To configure custom topic names, you specify regular expressions in the logical topic routing SMT.
For more information about using the logical topic routing SMT to customize topic naming, see <a href="../transformations/topic-routing.html#topic-routing" class="xref page">Topic routing</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-transaction-metadata"><a class="anchor" href="#mysql-transaction-metadata"></a>Transaction metadata</h3>
<div class="paragraph">
<p>Debezium can generate events that represent transaction boundaries and that enrich data change event messages.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Limits on when Debezium receives transaction metadata</div>
<div class="paragraph">
<p>Debezium registers and receives metadata only for transactions that occur after you deploy the connector.
Metadata for transactions that occur before you deploy the connector is not available.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Debezium generates transaction boundary events for the <code>BEGIN</code> and <code>END</code> delimiters in every transaction.
Transaction boundary events contain the following fields:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>status</code></dt>
<dd>
<p><code>BEGIN</code> or <code>END</code>.</p>
</dd>
<dt class="hdlist1"><code>id</code></dt>
<dd>
<p>String representation of the unique transaction identifier.</p>
</dd>
<dt class="hdlist1"><code>ts_ms</code></dt>
<dd>
<p>The time of a transaction boundary event (<code>BEGIN</code> or <code>END</code> event) at the data source.
If the data source does not provide Debezium with the event time, then the field instead represents the time at which Debezium processes the event.</p>
</dd>
<dt class="hdlist1"><code>event_count</code> (for <code>END</code> events)</dt>
<dd>
<p>Total number of events emitted by the transaction.</p>
</dd>
<dt class="hdlist1"><code>data_collections</code> (for <code>END</code> events)</dt>
<dd>
<p>An array of pairs of <code>data_collection</code> and <code>event_count</code> elements that indicates the number of events that the connector emits for changes that originate from a data collection.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "status": "BEGIN",
  "id": "0e4d5dcd-a33b-11ea-80f1-02010a22a99e:10",
  "ts_ms": 1486500577125,
  "event_count": null,
  "data_collections": null
}

{
  "status": "END",
  "id": "0e4d5dcd-a33b-11ea-80f1-02010a22a99e:10",
  "ts_ms": 1486500577691,
  "event_count": 2,
  "data_collections": [
    {
      "data_collection": "s1.a",
      "event_count": 1
    },
    {
      "data_collection": "s2.a",
      "event_count": 1
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unless overridden via the <a href="#mysql-property-topic-transaction"><code>topic.transaction</code></a> option,
the connector emits transaction events to the <a href="#mysql-property-topic-prefix"><code><em>&lt;topic.prefix&gt;</em></code></a><code>.transaction</code> topic.</p>
</div>
<div class="paragraph">
<div class="title">Change data event enrichment</div>
<p>When transaction metadata is enabled the data message <code>Envelope</code> is enriched with a new <code>transaction</code> field.
This field provides information about every event in the form of a composite of fields:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>id</code></dt>
<dd>
<p>String representation of unique transaction identifier.</p>
</dd>
<dt class="hdlist1"><code>total_order</code></dt>
<dd>
<p>The absolute position of the event among all events generated by the transaction.</p>
</dd>
<dt class="hdlist1"><code>data_collection_order</code></dt>
<dd>
<p>The per-data collection position of the event among all events that were emitted by the transaction.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Following is an example of a message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "before": null,
  "after": {
    "pk": "2",
    "aa": "1"
  },
  "source": {
...
  },
  "op": "c",
  "ts_ms": "1580390884335",
  "transaction": {
    "id": "0e4d5dcd-a33b-11ea-80f1-02010a22a99e:10",
    "total_order": "1",
    "data_collection_order": "1"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For systems which don&#8217;t have GTID enabled, the transaction identifier is constructed using the combination of binlog filename and binlog position. For example, if the binlog filename and position corresponding to the transaction BEGIN event are mysql-bin.000002 and 1913 respectively then the Debezium constructed transaction identifier would be <code>file=mysql-bin.000002,pos=1913</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mysql-events"><a class="anchor" href="#mysql-events"></a>Data change events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Debezium MySQL connector generates a data change event for each row-level <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code> operation. Each event contains a key and a value. The structure of the key and the value depends on the table that was changed.</p>
</div>
<div class="paragraph">
<p>Debezium and Kafka Connect are designed around <em>continuous streams of event messages</em>. However, the structure of these events may change over time, which can be difficult for consumers to handle. To address this, each event contains the schema for its content or, if you are using a schema registry, a schema ID that a consumer can use to obtain the schema from the registry. This makes each event self-contained.</p>
</div>
<div class="paragraph">
<p>The following skeleton JSON shows the basic four parts of a change event. However, how you configure the Kafka Connect converter that you choose to use in your application determines the representation of these four parts in change events. A <code>schema</code> field is in a change event only when you configure the converter to produce it. Likewise, the event key and event payload are in a change event only if you configure a converter to produce it. If you use the JSON converter and you configure it to produce all four basic change event parts, change events have this structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "schema": { <i class="conum" data-value="1"></i><b>(1)</b>
   ...
  },
 "payload": { <i class="conum" data-value="2"></i><b>(2)</b>
   ...
 },
 "schema": { <i class="conum" data-value="3"></i><b>(3)</b>
   ...
 },
 "payload": { <i class="conum" data-value="4"></i><b>(4)</b>
   ...
 },
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Overview of change event basic content</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schema</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The first <code>schema</code> field is part of the event key. It specifies a Kafka Connect schema that describes what is in the event key&#8217;s <code>payload</code> portion. In other words, the first <code>schema</code> field describes the structure of the primary key, or the unique key if the table does not have a primary key, for the table that was changed.<br>
<br>
It is possible to override the table&#8217;s primary key by setting the <a href="#mysql-property-message-key-columns"><code>message.key.columns</code> connector configuration property</a>. In this case, the first schema field describes the structure of the key identified by that property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The first <code>payload</code> field is part of the event key. It has the structure described by the previous <code>schema</code> field and it contains the key for the row that was changed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schema</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The second <code>schema</code> field is part of the event value. It specifies the Kafka Connect schema that describes what is in the event value&#8217;s <code>payload</code> portion. In other words, the second <code>schema</code> describes the structure of the row that was changed. Typically, this schema contains nested schemas.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The second <code>payload</code> field is part of the event value. It has the structure described by the previous <code>schema</code> field and it contains the actual data for the row that was changed.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>By default, the connector streams change event records to topics with names that are the same as the event&#8217;s originating table. See <a href="#mysql-topic-names">topic names</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The MySQL connector ensures that all Kafka Connect schema names adhere to the <a href="http://avro.apache.org/docs/current/spec.html#names">Avro schema name format</a>. This means that the logical server name must start with a Latin letter or an underscore, that is, a-z, A-Z, or _. Each remaining character in the logical server name and each character in the database and table names must be a Latin letter, a digit, or an underscore, that is, a-z, A-Z, 0-9, or _. If there is an invalid character it is replaced with an underscore character.</p>
</div>
<div class="paragraph">
<p>This can lead to unexpected conflicts if the logical server name, a database name, or a table name contains invalid characters, and the only characters that distinguish names from one another are invalid and thus replaced with underscores.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="mysql-change-event-keys"><a class="anchor" href="#mysql-change-event-keys"></a>Change event keys</h3>
<div class="paragraph">
<p>A change event&#8217;s key contains the schema for the changed table&#8217;s key and the changed row&#8217;s actual key. Both the schema and its corresponding payload contain a field for each column in the changed table&#8217;s <code>PRIMARY KEY</code> (or unique constraint) at the time the connector created the event.</p>
</div>
<div class="paragraph">
<p>Consider the following <code>customers</code> table, which is followed by an example of a change event key for this table.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE customers (
  id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
  first_name VARCHAR(255) NOT NULL,
  last_name VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE KEY
) AUTO_INCREMENT=1001;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Every change event that captures a change to the <code>customers</code> table has the same event key schema. For as long as the <code>customers</code> table has the previous definition, every change event that captures a change to the <code>customers</code> table has the following key structure. In JSON, it looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "schema": { <i class="conum" data-value="1"></i><b>(1)</b>
    "type": "struct",
    "name": "mysql-server-1.inventory.customers.Key", <i class="conum" data-value="2"></i><b>(2)</b>
    "optional": false, <i class="conum" data-value="3"></i><b>(3)</b>
    "fields": [ <i class="conum" data-value="4"></i><b>(4)</b>
      {
        "field": "id",
        "type": "int32",
        "optional": false
      }
    ]
  },
 "payload": { <i class="conum" data-value="5"></i><b>(5)</b>
    "id": 1001
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Description of change event key</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schema</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The schema portion of the key specifies a Kafka Connect schema that describes what is in the key&#8217;s <code>payload</code> portion.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mysql-server-1.inventory.customers.Key</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of the schema that defines the structure of the key&#8217;s payload. This schema describes the structure of the primary key for the table that was changed. Key schema names have the format <em>connector-name</em>.<em>database-name</em>.<em>table-name</em>.<code>Key</code>. In this example:<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mysql-server-1</code> is the name of the connector that generated this event.<br></p>
</li>
<li>
<p><code>inventory</code> is the database that contains the table that was changed.<br></p>
</li>
<li>
<p><code>customers</code> is the table that was updated.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>optional</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates whether the event key must contain a value in its <code>payload</code> field. In this example, a value in the key&#8217;s payload is required. A value in the key&#8217;s payload field is optional when a table does not have a primary key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fields</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies each field that is expected in the <code>payload</code>, including each field&#8217;s name, type, and whether it is required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the key for the row for which this change event was generated. In this example, the key, contains a single <code>id</code> field whose value is <code>1001</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="mysql-change-event-values"><a class="anchor" href="#mysql-change-event-values"></a>Change event values</h3>
<div class="paragraph">
<p>The value in a change event is a bit more complicated than the key. Like the key, the value has a <code>schema</code> section and a <code>payload</code> section. The <code>schema</code> section contains the schema that describes the <code>Envelope</code> structure of the <code>payload</code> section, including its nested fields. Change events for operations that create, update or delete data all have a value payload with an envelope structure.</p>
</div>
<div class="paragraph">
<p>Consider the same sample table that was used to show an example of a change event key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE customers (
  id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
  first_name VARCHAR(255) NOT NULL,
  last_name VARCHAR(255) NOT NULL,
  email VARCHAR(255) NOT NULL UNIQUE KEY
) AUTO_INCREMENT=1001;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value portion of a change event for a change to this table is described for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#mysql-create-events"><em>create</em> events</a></p>
</li>
<li>
<p><a href="#mysql-update-events"><em>update</em> events</a></p>
</li>
<li>
<p><a href="#mysql-primary-key-updates">Primary key updates</a></p>
</li>
<li>
<p><a href="#mysql-delete-events"><em>delete</em> events</a></p>
</li>
<li>
<p><a href="#mysql-tombstone-events">Tombstone events</a></p>
</li>
<li>
<p><a href="#mysql-truncate-events"><em>truncate</em> events</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mysql-create-events"><a class="anchor" href="#mysql-create-events"></a><em>create</em> events</h3>
<div class="paragraph">
<p>The following example shows the value portion of a change event that the connector generates for an operation that creates data in the <code>customers</code> table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "schema": { <i class="conum" data-value="1"></i><b>(1)</b>
    "type": "struct",
    "fields": [
      {
        "type": "struct",
        "fields": [
          {
            "type": "int32",
            "optional": false,
            "field": "id"
          },
          {
            "type": "string",
            "optional": false,
            "field": "first_name"
          },
          {
            "type": "string",
            "optional": false,
            "field": "last_name"
          },
          {
            "type": "string",
            "optional": false,
            "field": "email"
          }
        ],
        "optional": true,
        "name": "mysql-server-1.inventory.customers.Value", <i class="conum" data-value="2"></i><b>(2)</b>
        "field": "before"
      },
      {
        "type": "struct",
        "fields": [
          {
            "type": "int32",
            "optional": false,
            "field": "id"
          },
          {
            "type": "string",
            "optional": false,
            "field": "first_name"
          },
          {
            "type": "string",
            "optional": false,
            "field": "last_name"
          },
          {
            "type": "string",
            "optional": false,
            "field": "email"
          }
        ],
        "optional": true,
        "name": "mysql-server-1.inventory.customers.Value",
        "field": "after"
      },
      {
        "type": "struct",
        "fields": [
          {
            "type": "string",
            "optional": false,
            "field": "version"
          },
          {
            "type": "string",
            "optional": false,
            "field": "connector"
          },
          {
            "type": "string",
            "optional": false,
            "field": "name"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "ts_ms"
          },
          {
            "type": "boolean",
            "optional": true,
            "default": false,
            "field": "snapshot"
          },
          {
            "type": "string",
            "optional": false,
            "field": "db"
          },
          {
            "type": "string",
            "optional": true,
            "field": "table"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "server_id"
          },
          {
            "type": "string",
            "optional": true,
            "field": "gtid"
          },
          {
            "type": "string",
            "optional": false,
            "field": "file"
          },
          {
            "type": "int64",
            "optional": false,
            "field": "pos"
          },
          {
            "type": "int32",
            "optional": false,
            "field": "row"
          },
          {
            "type": "int64",
            "optional": true,
            "field": "thread"
          },
          {
            "type": "string",
            "optional": true,
            "field": "query"
          }
        ],
        "optional": false,
        "name": "io.debezium.connector.mysql.Source", <i class="conum" data-value="3"></i><b>(3)</b>
        "field": "source"
      },
      {
        "type": "string",
        "optional": false,
        "field": "op"
      },
      {
        "type": "int64",
        "optional": true,
        "field": "ts_ms"
      }
    ],
    "optional": false,
    "name": "mysql-server-1.inventory.customers.Envelope" <i class="conum" data-value="4"></i><b>(4)</b>
  },
  "payload": { <i class="conum" data-value="5"></i><b>(5)</b>
    "op": "c", <i class="conum" data-value="6"></i><b>(6)</b>
    "ts_ms": 1465491411815, <i class="conum" data-value="7"></i><b>(7)</b>
    "before": null, <i class="conum" data-value="8"></i><b>(8)</b>
    "after": { <i class="conum" data-value="9"></i><b>(9)</b>
      "id": 1004,
      "first_name": "Anne",
      "last_name": "Kretchmar",
      "email": "annek@noanswer.org"
    },
    "source": { <i class="conum" data-value="10"></i><b>(10)</b>
      "version": "2.3.7.Final",
      "connector": "mysql",
      "name": "mysql-server-1",
      "ts_ms": 0,
      "snapshot": false,
      "db": "inventory",
      "table": "customers",
      "server_id": 0,
      "gtid": null,
      "file": "mysql-bin.000003",
      "pos": 154,
      "row": 0,
      "thread": 7,
      "query": "INSERT INTO customers (first_name, last_name, email) VALUES ('Anne', 'Kretchmar', 'annek@noanswer.org')"
    }
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Descriptions of <em>create</em> event value fields</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>schema</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value&#8217;s schema, which describes the structure of the value&#8217;s payload. A change event&#8217;s value schema is the same in every change event that the connector generates for a particular table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>In the <code>schema</code> section, each <code>name</code> field specifies the schema for a field in the value&#8217;s payload.<br>
<br>
<code>mysql-server-1.inventory.customers.Value</code> is the schema for the payload&#8217;s <code>before</code> and <code>after</code> fields. This schema is specific to the <code>customers</code> table.<br>
<br>
Names of schemas for <code>before</code> and <code>after</code> fields are of the form <code><em>logicalName</em>.<em>tableName</em>.Value</code>, which ensures that the schema name is unique in the database.
This means that when using the <a href="../configuration/avro.html#avro-serialization" class="xref page">Avro converter</a>, the resulting Avro schema for each table in each logical source has its own evolution and history.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>io.debezium.connector.mysql.Source</code> is the schema for the payload&#8217;s <code>source</code> field. This schema is specific to the MySQL connector. The connector uses it for all events that it generates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mysql-server-1.inventory.customers.Envelope</code> is the schema for the overall structure of the payload, where <code>mysql-server-1</code> is the connector name, <code>inventory</code> is the database, and <code>customers</code> is the table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>payload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value&#8217;s actual data. This is the information that the change event is providing.<br>
<br>
It may appear that the JSON representations of the events are much larger than the rows they describe. This is because the JSON representation must include the schema and the payload portions of the message.
However, by using the <a href="../configuration/avro.html#avro-serialization" class="xref page">Avro converter</a>, you can significantly decrease the size of the messages that the connector streams to Kafka topics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>op</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory string that describes the type of operation that caused the connector to generate the event. In this example, <code>c</code> indicates that the operation created a row. Valid values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>c</code> = create</p>
</li>
<li>
<p><code>u</code> = update</p>
</li>
<li>
<p><code>d</code> = delete</p>
</li>
<li>
<p><code>r</code> = read (applies to only snapshots)</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ts_ms</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional field that displays the time at which the connector processed the event. The time is based on the system clock in the JVM running the Kafka Connect task. <br>
<br>
In the <code>source</code> object, <code>ts_ms</code> indicates the time that the change was made in the database. By comparing the value for <code>payload.source.ts_ms</code> with the value for <code>payload.ts_ms</code>, you can determine the lag between the source database update and Debezium.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>before</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional field that specifies the state of the row before the event occurred. When the <code>op</code> field is <code>c</code> for create, as it is in this example, the <code>before</code> field is <code>null</code> since this change event is for new content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>after</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional field that specifies the state of the row after the event occurred. In this example, the <code>after</code> field contains the values of the new row&#8217;s <code>id</code>, <code>first_name</code>, <code>last_name</code>, and <code>email</code> columns.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory field that describes the source metadata for the event. This field contains information that you can use to compare this event with other events, with regard to the origin of the events, the order in which the events occurred, and whether events were part of the same transaction. The source metadata includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debezium version</p>
</li>
<li>
<p>Connector name</p>
</li>
<li>
<p>binlog name where the event was recorded</p>
</li>
<li>
<p>binlog position</p>
</li>
<li>
<p>Row within the event</p>
</li>
<li>
<p>If the event was part of a snapshot</p>
</li>
<li>
<p>Name of the database and table that contain the new row</p>
</li>
<li>
<p>ID of the MySQL thread that created the event (non-snapshot only)</p>
</li>
<li>
<p>MySQL server ID (if available)</p>
</li>
<li>
<p>Timestamp for when the change was made in the database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="#enable-query-log-events"><code>binlog_rows_query_log_events</code></a> MySQL configuration option is enabled and the connector configuration <code>include.query</code> property is enabled, the <code>source</code> field also provides the <code>query</code> field, which contains the original SQL statement that caused the change event.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="mysql-update-events"><a class="anchor" href="#mysql-update-events"></a><em>update</em> events</h3>
<div class="paragraph">
<p>The value of a change event for an update in the sample <code>customers</code> table has the same schema as a <em>create</em> event for that table. Likewise, the event value&#8217;s payload has the same structure. However, the event value payload contains different values in an <em>update</em> event. Here is an example of a change event value in an event that the connector generates for an update in the <code>customers</code> table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "schema": { ... },
  "payload": {
    "before": { <i class="conum" data-value="1"></i><b>(1)</b>
      "id": 1004,
      "first_name": "Anne",
      "last_name": "Kretchmar",
      "email": "annek@noanswer.org"
    },
    "after": { <i class="conum" data-value="2"></i><b>(2)</b>
      "id": 1004,
      "first_name": "Anne Marie",
      "last_name": "Kretchmar",
      "email": "annek@noanswer.org"
    },
    "source": { <i class="conum" data-value="3"></i><b>(3)</b>
      "version": "2.3.7.Final",
      "name": "mysql-server-1",
      "connector": "mysql",
      "name": "mysql-server-1",
      "ts_ms": 1465581029100,
      "snapshot": false,
      "db": "inventory",
      "table": "customers",
      "server_id": 223344,
      "gtid": null,
      "file": "mysql-bin.000003",
      "pos": 484,
      "row": 0,
      "thread": 7,
      "query": "UPDATE customers SET first_name='Anne Marie' WHERE id=1004"
    },
    "op": "u", <i class="conum" data-value="4"></i><b>(4)</b>
    "ts_ms": 1465581029523 <i class="conum" data-value="5"></i><b>(5)</b>
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Descriptions of <em>update</em> event value fields</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>before</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional field that specifies the state of the row before the event occurred. In an <em>update</em> event value, the <code>before</code> field contains a field for each table column and the value that was in that column before the database commit. In this example, the <code>first_name</code> value is <code>Anne.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>after</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional field that specifies the state of the row after the event occurred. You can compare the <code>before</code> and <code>after</code> structures to determine what the update to this row was. In the example, the <code>first_name</code> value is now <code>Anne Marie</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory field that describes the source metadata for the event. The <code>source</code> field structure has the same fields as in a <em>create</em> event, but some values are different, for example, the sample <em>update</em> event is from a different position in the binlog. The source metadata includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debezium version</p>
</li>
<li>
<p>Connector name</p>
</li>
<li>
<p>binlog name where the event was recorded</p>
</li>
<li>
<p>binlog position</p>
</li>
<li>
<p>Row within the event</p>
</li>
<li>
<p>If the event was part of a snapshot</p>
</li>
<li>
<p>Name of the database and table that contain the updated row</p>
</li>
<li>
<p>ID of the MySQL thread that created the event (non-snapshot only)</p>
</li>
<li>
<p>MySQL server ID (if available)</p>
</li>
<li>
<p>Timestamp for when the change was made in the database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="#enable-query-log-events"><code>binlog_rows_query_log_events</code></a> MySQL configuration option is enabled and the connector configuration <code>include.query</code> property is enabled, the <code>source</code> field also provides the <code>query</code> field, which contains the original SQL statement that caused the change event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>op</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory string that describes the type of operation. In an <em>update</em> event value, the <code>op</code> field value is <code>u</code>, signifying that this row changed because of an update.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ts_ms</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional field that displays the time at which the connector processed the event. The time is based on the system clock in the JVM running the Kafka Connect task. <br>
<br>
In the <code>source</code> object, <code>ts_ms</code> indicates the time that the change was made in the database. By comparing the value for <code>payload.source.ts_ms</code> with the value for <code>payload.ts_ms</code>, you can determine the lag between the source database update and Debezium.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Updating the columns for a row&#8217;s primary/unique key changes the value of the row&#8217;s key. When a key changes, Debezium outputs <em>three</em> events: a <code>DELETE</code> event and a <a href="#mysql-tombstone-events">tombstone event</a> with the old key for the row, followed by an event with the new key for the row. Details are in the next section.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="mysql-primary-key-updates"><a class="anchor" href="#mysql-primary-key-updates"></a>Primary key updates</h3>
<div class="paragraph">
<p>An <code>UPDATE</code> operation that changes a row&#8217;s primary key field(s) is known
as a primary key change. For a primary key change, in place of an <code>UPDATE</code> event record, the connector emits a <code>DELETE</code> event record for the old key and a <code>CREATE</code> event record for the new (updated) key. These events have the usual structure and content, and in addition, each one has a message header related to the primary key change:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>DELETE</code> event record has <code>__debezium.newkey</code> as a message header. The value of this header is the new primary key for the updated row.</p>
</li>
<li>
<p>The <code>CREATE</code> event record has <code>__debezium.oldkey</code> as a message header. The value of this header is the previous (old) primary key that the updated row had.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mysql-delete-events"><a class="anchor" href="#mysql-delete-events"></a><em>delete</em> events</h3>
<div class="paragraph">
<p>The value in a <em>delete</em> change event has the same <code>schema</code> portion as <em>create</em> and <em>update</em> events for the same table. The <code>payload</code> portion in a <em>delete</em> event for the sample <code>customers</code> table looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "schema": { ... },
  "payload": {
    "before": { <i class="conum" data-value="1"></i><b>(1)</b>
      "id": 1004,
      "first_name": "Anne Marie",
      "last_name": "Kretchmar",
      "email": "annek@noanswer.org"
    },
    "after": null, <i class="conum" data-value="2"></i><b>(2)</b>
    "source": { <i class="conum" data-value="3"></i><b>(3)</b>
      "version": "2.3.7.Final",
      "connector": "mysql",
      "name": "mysql-server-1",
      "ts_ms": 1465581902300,
      "snapshot": false,
      "db": "inventory",
      "table": "customers",
      "server_id": 223344,
      "gtid": null,
      "file": "mysql-bin.000003",
      "pos": 805,
      "row": 0,
      "thread": 7,
      "query": "DELETE FROM customers WHERE id=1004"
    },
    "op": "d", <i class="conum" data-value="4"></i><b>(4)</b>
    "ts_ms": 1465581902461 <i class="conum" data-value="5"></i><b>(5)</b>
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Descriptions of <em>delete</em> event value fields</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>before</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that specifies the state of the row before the event occurred. In a <em>delete</em> event value, the <code>before</code> field contains the values that were in the row before it was deleted with the database commit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>after</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional field that specifies the state of the row after the event occurred. In a <em>delete</em> event value, the <code>after</code> field is <code>null</code>, signifying that the row no longer exists.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory field that describes the source metadata for the event. In a <em>delete</em> event value, the <code>source</code> field structure is the same as for <em>create</em> and <em>update</em> events for the same table. Many <code>source</code> field values are also the same. In a <em>delete</em> event value, the <code>ts_ms</code> and <code>pos</code> field values, as well as other values, might have changed. But the <code>source</code> field in a <em>delete</em> event value provides the same metadata:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debezium version</p>
</li>
<li>
<p>Connector name</p>
</li>
<li>
<p>binlog name where the event was recorded</p>
</li>
<li>
<p>binlog position</p>
</li>
<li>
<p>Row within the event</p>
</li>
<li>
<p>If the event was part of a snapshot</p>
</li>
<li>
<p>Name of the database and table that contain the updated row</p>
</li>
<li>
<p>ID of the MySQL thread that created the event (non-snapshot only)</p>
</li>
<li>
<p>MySQL server ID (if available)</p>
</li>
<li>
<p>Timestamp for when the change was made in the database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <a href="#enable-query-log-events"><code>binlog_rows_query_log_events</code></a> MySQL configuration option is enabled and the connector configuration <code>include.query</code> property is enabled, the <code>source</code> field also provides the <code>query</code> field, which contains the original SQL statement that caused the change event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>op</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory string that describes the type of operation. The <code>op</code> field value is <code>d</code>, signifying that this row was deleted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ts_ms</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional field that displays the time at which the connector processed the event. The time is based on the system clock in the JVM running the Kafka Connect task. <br>
<br>
In the <code>source</code> object, <code>ts_ms</code> indicates the time that the change was made in the database. By comparing the value for <code>payload.source.ts_ms</code> with the value for <code>payload.ts_ms</code>, you can determine the lag between the source database update and Debezium.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A <em>delete</em> change event record provides a consumer with the information it needs to process the removal of this row. The old values are included because some consumers might require them in order to properly handle the removal.</p>
</div>
<div class="paragraph">
<p>MySQL connector events are designed to work with <a href="https://kafka.apache.org/documentation/#compaction">Kafka log compaction</a>. Log compaction enables removal of some older messages as long as at least the most recent message for every key is kept. This lets Kafka reclaim storage space while ensuring that the topic contains a complete data set and can be used for reloading key-based state.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-tombstone-events"><a class="anchor" href="#mysql-tombstone-events"></a>Tombstone events</h3>
<div class="paragraph">
<p>When a row is deleted, the <em>delete</em> event value still works with log compaction, because Kafka can remove all earlier messages that have that same key. However, for Kafka to remove all messages that have that same key, the message value must be <code>null</code>. To make this possible, after Debezium’s MySQL connector emits a <em>delete</em> event, the connector emits a special tombstone event that has the same key but a <code>null</code> value.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-truncate-events"><a class="anchor" href="#mysql-truncate-events"></a><em>truncate</em> events</h3>
<div class="paragraph">
<p>A  <em>truncate</em> change event signals that a table has been truncated.
The message key is <code>null</code> in this case, the message value looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "schema": { ... },
    "payload": {
        "source": { <i class="conum" data-value="1"></i><b>(1)</b>
            "version": "2.3.7.Final",
            "name": "mysql-server-1",
            "connector": "mysql",
            "name": "mysql-server-1",
            "ts_ms": 1465581029100,
            "snapshot": false,
            "db": "inventory",
            "table": "customers",
            "server_id": 223344,
            "gtid": null,
            "file": "mysql-bin.000003",
            "pos": 484,
            "row": 0,
            "thread": 7,
            "query": "UPDATE customers SET first_name='Anne Marie' WHERE id=1004"
        },
        "op": "t", <i class="conum" data-value="2"></i><b>(2)</b>
        "ts_ms": 1465581029523 <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Descriptions of <em>truncate</em> event value fields</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>source</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory field that describes the source metadata for the event. In a <em>truncate</em> event value, the <code>source</code> field structure is the same as for <em>create</em>, <em>update</em>, and <em>delete</em> events for the same table, provides this metadata:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debezium version</p>
</li>
<li>
<p>Connector type and name</p>
</li>
<li>
<p>Binlog name where the event was recorded</p>
</li>
<li>
<p>Binlog position</p>
</li>
<li>
<p>Row within the event</p>
</li>
<li>
<p>If the event was part of a snapshot</p>
</li>
<li>
<p>Name of the database and table</p>
</li>
<li>
<p>ID of the MySQL thread that truncated the event (non-snapshot only)</p>
</li>
<li>
<p>MySQL server ID (if available)</p>
</li>
<li>
<p>Timestamp for when the change was made in the database</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>op</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Mandatory string that describes the type of operation. The <code>op</code> field value is <code>t</code>, signifying that this table was truncated.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ts_ms</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optional field that displays the time at which the connector processed the event. The time is based on the system clock in the JVM running the Kafka Connect task. <br></p>
</div>
<div class="paragraph">
<p>+
In the <code>source</code> object, <code>ts_ms</code> indicates the time that the change was made in the database. By comparing the value for <code>payload.source.ts_ms</code> with the value for <code>payload.ts_ms</code>, you can determine the lag between the source database update and Debezium.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In case a single <code>TRUNCATE</code> statement applies to multiple tables,
one <em>truncate</em> change event record for each truncated table will be emitted.</p>
</div>
<div class="paragraph">
<p>Note that since <em>truncate</em> events represent a change made to an entire table and don&#8217;t have a message key,
unless you&#8217;re working with topics with a single partition,
there are no ordering guarantees for the change events pertaining to a table (<em>create</em>, <em>update</em>, etc.) and <em>truncate</em> events for that table.
For instance a consumer may receive an <em>update</em> event only after a <em>truncate</em> event for that table,
when those events are read from different partitions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mysql-data-types"><a class="anchor" href="#mysql-data-types"></a>Data type mappings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Debezium MySQL connector represents changes to rows with events that are structured like the table in which the row exists. The event contains a field for each column value. The MySQL data type of that column dictates how Debezium represents the value in the event.</p>
</div>
<div class="paragraph">
<p>Columns that store strings are defined in MySQL with a character set and collation. The MySQL connector uses the column&#8217;s character set when reading the binary representation of the column values in the binlog events.</p>
</div>
<div class="paragraph">
<p>The connector can map MySQL data types to both <em>literal</em> and <em>semantic</em> types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Literal type</strong>: how the value is represented using Kafka Connect schema types.</p>
</li>
<li>
<p><strong>Semantic type</strong>: how the Kafka Connect schema captures the meaning of the field (schema name).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the default data type conversions do not meet your needs, you can <a href="../development/converters.html#custom-converters" class="xref page">create a custom converter</a> for the connector.</p>
</div>
<div class="sect2">
<h3 id="mysql-basic-types"><a class="anchor" href="#mysql-basic-types"></a>Basic types</h3>
<div class="paragraph">
<p>The following table shows how the connector maps basic MySQL data types.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Descriptions of basic type mappings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 55%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BOOLEAN, BOOL</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BOOLEAN</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BIT(1)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BOOLEAN</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BIT(&gt;1)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.Bits</code><br>
The <code>length</code> schema parameter contains an integer that represents the number of bits. The <code>byte[]</code> contains the bits in <em>little-endian</em> form and is sized to contain the specified number of bits. For example, where <code>n</code> is bits:<br>
<code>numBytes = n/8 + (n%8== 0 ? 0 : 1)</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TINYINT</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT16</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>SMALLINT[(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT16</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MEDIUMINT[(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT32</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT, INTEGER[(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT32</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BIGINT[(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>REAL[(M,D)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>FLOAT32</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>FLOAT[(P)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>FLOAT32</code> or <code>FLOAT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The precision is used only to determine storage size.
A precision <code>P</code> from 0 to 23 results in a 4-byte single-precision <code>FLOAT32</code> column.
A precision <code>P</code> from 24 to 53 results in an 8-byte double-precision <code>FLOAT64</code> column.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>FLOAT(M,D)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>FLOAT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>As of MySQL 8.0.17, the nonstandard FLOAT(M,D) and DOUBLE(M,D) syntax is deprecated, and should expect support for it be removed in a future version of MySQL, set <code>FLOAT64</code> as default.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DOUBLE[(M,D)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>FLOAT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>CHAR(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>VARCHAR(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BINARY(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code> or <code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em><br>
Either the raw bytes (the default), a base64-encoded String, or a base64-url-safe-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode"><code>binary.handling.mode</code></a> connector configuration property setting.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>VARBINARY(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code> or <code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em><br>
Either the raw bytes (the default), a base64-encoded String, or a base64-url-safe-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode"><code>binary.handling.mode</code></a> connector configuration property setting.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TINYBLOB</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code> or <code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em><br>
Either the raw bytes (the default), a base64-encoded String, or a base64-url-safe-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode"><code>binary.handling.mode</code></a> connector configuration property setting.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TINYTEXT</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BLOB</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code> or <code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em><br>
Either the raw bytes (the default), a base64-encoded String, or a base64-url-safe-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode"><code>binary.handling.mode</code></a> connector configuration property setting.<br>
Only values with a size of up to 2GB are supported. It is recommended to externalize large column values, using the claim check pattern.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TEXT</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em><br>
Only values with a size of up to 2GB are supported. It is recommended to externalize large column values, using the claim check pattern.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MEDIUMBLOB</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code> or <code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em><br>
Either the raw bytes (the default), a base64-encoded String, or a base64-url-safe-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode"><code>binary.handling.mode</code></a> connector configuration property setting.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>MEDIUMTEXT</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>LONGBLOB</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code> or <code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em><br>
Either the raw bytes (the default), a base64-encoded String, or a base64-url-safe-encoded String, or a hex-encoded String, based on the <a href="#mysql-property-binary-handling-mode"><code>binary.handling.mode</code></a> connector configuration property setting.<br>
Only values with a size of up to 2GB are supported. It is recommended to externalize large column values, using the claim check pattern.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>LONGTEXT</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em><br>
Only values with a size of up to 2GB are supported. It is recommended to externalize large column values, using the claim check pattern.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>JSON</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.Json</code><br>
Contains the string representation of a <code>JSON</code> document, array, or scalar.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>ENUM</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.Enum</code><br>
The <code>allowed</code> schema parameter contains the comma-separated list of allowed values.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>SET</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.EnumSet</code><br>
The <code>allowed</code> schema parameter contains the comma-separated list of allowed values.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>YEAR[(2|4)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT32</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.Year</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TIMESTAMP[(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.ZonedTimestamp</code><br>
In <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a> format with microsecond precision. MySQL allows <code>M</code> to be in the range of <code>0-6</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="mysql-temporal-types"><a class="anchor" href="#mysql-temporal-types"></a>Temporal types</h3>
<div class="paragraph">
<p>Excluding the <code>TIMESTAMP</code> data type, MySQL temporal types depend on the value of the <code>time.precision.mode</code> connector configuration property. For <code>TIMESTAMP</code> columns whose default value is specified as <code>CURRENT_TIMESTAMP</code> or <code>NOW</code>, the value <code>1970-01-01 00:00:00</code> is used as the default value in the Kafka Connect schema.</p>
</div>
<div class="paragraph">
<p>MySQL allows zero-values for <code>DATE</code>, <code>DATETIME</code>, and <code>TIMESTAMP</code> columns because zero-values are sometimes preferred over null values. The MySQL connector represents zero-values as null values when the column definition allows null values, or as the epoch day when the column does not allow null values.</p>
</div>
<div class="paragraph">
<div class="title">Temporal values without time zones</div>
<p>The <code>DATETIME</code> type represents a local date and time such as "2018-01-13 09:48:27". As you can see, there is no time zone information. Such columns are converted into epoch milliseconds or microseconds based on the column’s precision by using UTC. The <code>TIMESTAMP</code> type represents a timestamp without time zone information. It is converted by MySQL from the server (or session’s) current time zone into UTC when writing and from UTC into the server (or session&#8217;s) current time zone when reading back the value. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DATETIME</code> with a value of <code>2018-06-20 06:37:03</code> becomes <code>1529476623000</code>.</p>
</li>
<li>
<p><code>TIMESTAMP</code> with a value of <code>2018-06-20 06:37:03</code> becomes <code>2018-06-20T13:37:03Z</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Such columns are converted into an equivalent <code>io.debezium.time.ZonedTimestamp</code> in UTC based on the server (or session’s) current time zone. The time zone will be queried from the server by default. If this fails, it must be specified explicitly by the database <code>connectionTimeZone</code> MySQL configuration option. For example, if the database’s time zone (either globally or configured for the connector by means of the <code>connectionTimeZone</code> option) is "America/Los_Angeles", the TIMESTAMP value "2018-06-20 06:37:03" is represented by a <code>ZonedTimestamp</code> with the value "2018-06-20T13:37:03Z".</p>
</div>
<div class="paragraph">
<p>The time zone of the JVM running Kafka Connect and Debezium does not affect these conversions.</p>
</div>
<div class="paragraph">
<p>More details about properties related to temporal values are in the documentation for <a href="#mysql-connector-properties">MySQL connector configuration properties</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">time.precision.mode=adaptive_time_microseconds(default)</dt>
<dd>
<p>The MySQL connector determines the literal type and semantic type based on the column&#8217;s data type definition so that events represent exactly the values in the database. All time fields are in microseconds. Only positive <code>TIME</code> field values in the range of <code>00:00:00.000000</code> to <code>23:59:59.999999</code> can be captured correctly.</p>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Mappings when <code>time.precision.mode=adaptive_time_microseconds</code></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 55%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DATE</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT32</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.Date</code><br>
Represents the number of days since the epoch.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TIME[(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.MicroTime</code><br>
Represents the time value in microseconds and does not include time zone information. MySQL allows <code>M</code> to be in the range of <code>0-6</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DATETIME, DATETIME(0), DATETIME(1), DATETIME(2), DATETIME(3)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.Timestamp</code><br>
Represents the number of milliseconds past the epoch and does not include time zone information.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DATETIME(4), DATETIME(5), DATETIME(6)</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.time.MicroTimestamp</code><br>
Represents the number of microseconds past the epoch and does not include time zone information.</p>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">time.precision.mode=connect</dt>
<dd>
<p>The MySQL connector uses defined Kafka Connect logical types. This approach is less precise than the default approach and the events could be less precise if the database column has a <em>fractional second precision</em> value of greater than <code>3</code>. Values in only the range of <code>00:00:00.000</code> to <code>23:59:59.999</code> can be handled. Set <code>time.precision.mode=connect</code> only if you can ensure that the <code>TIME</code> values in your tables never exceed the supported ranges. The <code>connect</code> setting is expected to be removed in a future version of Debezium.</p>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Mappings when <code>time.precision.mode=connect</code></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 55%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DATE</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT32</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Date</code><br>
Represents the number of days since the epoch.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>TIME[(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Time</code><br>
Represents the time value in microseconds since midnight and does not include time zone information.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DATETIME[(M)]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>INT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Timestamp</code><br>
Represents the number of milliseconds since the epoch, and does not include time zone information.</p>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="mysql-decimal-types"><a class="anchor" href="#mysql-decimal-types"></a>Decimal types</h3>
<div class="paragraph">
<p>Debezium connectors handle decimals according to the setting of the <a href="#mysql-property-decimal-handling-mode"><code>decimal.handling.mode</code> connector configuration property</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">decimal.handling.mode=precise</dt>
<dd>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Mappings when <code>decimal.handling.mode=precise</code></caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 15%;">
<col style="width: 55%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>NUMERIC[(M[,D])]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Decimal</code><br>
The <code>scale</code> schema parameter contains an integer that represents how many digits the decimal point shifted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DECIMAL[(M[,D])]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>BYTES</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>org.apache.kafka.connect.data.Decimal</code><br>
The <code>scale</code> schema parameter contains an integer that represents how many digits the decimal point shifted.</p>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">decimal.handling.mode=double</dt>
<dd>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Mappings when <code>decimal.handling.mode=double</code></caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>NUMERIC[(M[,D])]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>FLOAT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DECIMAL[(M[,D])]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>FLOAT64</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
<dt class="hdlist1">decimal.handling.mode=string</dt>
<dd>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Mappings when <code>decimal.handling.mode=string</code></caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>NUMERIC[(M[,D])]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>DECIMAL[(M[,D])]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRING</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="mysql-boolean-values"><a class="anchor" href="#mysql-boolean-values"></a>Boolean values</h3>
<div class="paragraph">
<p>MySQL handles the <code>BOOLEAN</code> value internally in a specific way.
The <code>BOOLEAN</code> column is internally mapped to the <code>TINYINT(1)</code> data type.
When the table is created during streaming then it uses proper <code>BOOLEAN</code> mapping as Debezium receives the original DDL.
During snapshots, Debezium executes <code>SHOW CREATE TABLE</code> to obtain table definitions that return <code>TINYINT(1)</code> for both <code>BOOLEAN</code> and <code>TINYINT(1)</code> columns. Debezium then has no way to obtain the original type mapping and so maps to <code>TINYINT(1)</code>.</p>
</div>
<div class="paragraph">
<p>To enable you to convert source columns to Boolean data types, Debezium provides a <code>TinyIntOneToBooleanConverter</code> <a href="../development/converters.html#custom-converters" class="xref page">custom converter</a> that you can use in one of the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Map all <code>TINYINT(1)</code> or <code>TINYINT(1) UNSIGNED</code> columns to <code>BOOLEAN</code> types.</p>
</li>
<li>
<p>Enumerate a subset of columns by using a comma-separated list of regular expressions.<br>
To use this type of conversion, you must set the <a href="#mysql-property-converters"><code>converters</code></a> configuration property with the <code>selector</code> parameter, as shown in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">converters=boolean
boolean.type=io.debezium.connector.mysql.converters.TinyIntOneToBooleanConverter
boolean.selector=db1.table1.*, db1.table2.column1</code></pre>
</div>
</div>
</li>
<li>
<p>NOTE: MySQL8 not showing the length of <code>tinyint unsigned</code> type when snapshot executes <code>SHOW CREATE TABLE</code>, which means this converter doesn&#8217;t work. The new option <code>length.checker</code> can solve this issue, the default value is <code>true</code>. Disable the <code>length.checker</code> and specify the columns that need to be converted to <code>selector</code> property instead of converting all columns based on type, as shown in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">converters=boolean
boolean.type=io.debezium.connector.mysql.converters.TinyIntOneToBooleanConverter
boolean.length.checker=false
boolean.selector=db1.table1.*, db1.table2.column1</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mysql-spatial-types"><a class="anchor" href="#mysql-spatial-types"></a>Spatial types</h3>
<div class="paragraph">
<p>Currently, the Debezium MySQL connector supports the following spatial data types.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. Description of spatial type mappings</caption>
<colgroup>
<col style="width: 35%;">
<col style="width: 15%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MySQL type</th>
<th class="tableblock halign-left valign-top">Literal type</th>
<th class="tableblock halign-left valign-top">Semantic type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>GEOMETRY,<br>
LINESTRING,<br>
POLYGON,<br>
MULTIPOINT,<br>
MULTILINESTRING,<br>
MULTIPOLYGON,<br>
GEOMETRYCOLLECTION</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>STRUCT</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.data.geometry.Geometry</code><br>
Contains a structure with two fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>srid (INT32</code>: spatial reference system ID that defines the type of geometry object stored in the structure</p>
</li>
<li>
<p><code>wkb (BYTES)</code>: binary representation of the geometry object encoded in the Well-Known-Binary (wkb) format. See the <a href="https://www.opengeospatial.org/standards/sfa">Open Geospatial Consortium</a> for more details.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-mysql"><a class="anchor" href="#setting-up-mysql"></a>Setting up MySQL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some MySQL setup tasks are required before you can install and run a Debezium connector.</p>
</div>
<div class="sect2">
<h3 id="mysql-creating-user"><a class="anchor" href="#mysql-creating-user"></a>Creating a user</h3>
<div class="paragraph">
<p>A Debezium MySQL connector requires a MySQL user account. This MySQL user must have appropriate permissions on all databases for which the Debezium MySQL connector captures changes.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A MySQL server.</p>
</li>
<li>
<p>Basic knowledge of SQL commands.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create the MySQL user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; CREATE USER 'user'@'localhost' IDENTIFIED BY 'password';</code></pre>
</div>
</div>
</li>
<li>
<p>Grant the required permissions to the user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; GRANT SELECT, RELOAD, SHOW DATABASES, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'user' IDENTIFIED BY 'password';</code></pre>
</div>
</div>
<div class="paragraph">
<p>The table below describes the permissions.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If using a hosted option such as Amazon RDS or Amazon Aurora that does not allow a global read lock, table-level locks are used to create the <em>consistent snapshot</em>. In this case, you need to also grant <code>LOCK TABLES</code> permissions to the user that you create. See <a href="#mysql-snapshots">snapshots</a> for more details.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Finalize the user&#8217;s permissions:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; FLUSH PRIVILEGES;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<table id="permissions-explained-mysql-connector" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Descriptions of user permissions</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the connector to select rows from tables in databases. This is used only when performing a snapshot.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RELOAD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the connector the use of the <code>FLUSH</code> statement to clear or reload internal caches, flush tables, or acquire locks. This is used only when performing a snapshot.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SHOW DATABASES</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the connector to see database names by issuing the <code>SHOW DATABASE</code> statement. This is used only when performing a snapshot.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPLICATION SLAVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the connector to connect to and read the MySQL server binlog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>REPLICATION CLIENT</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Enables the connector the use of the following statements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SHOW MASTER STATUS</code></p>
</li>
<li>
<p><code>SHOW SLAVE STATUS</code></p>
</li>
<li>
<p><code>SHOW BINARY LOGS</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The connector always requires this.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ON</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the database to which the permissions apply.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TO 'user'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the user to grant the permissions to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IDENTIFIED BY 'password'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the user&#8217;s MySQL password.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="enable-mysql-binlog"><a class="anchor" href="#enable-mysql-binlog"></a>Enabling the binlog</h3>
<div class="paragraph">
<p>You must enable binary logging for MySQL replication. The binary logs record transaction updates for replication tools to propagate changes.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A MySQL server.</p>
</li>
<li>
<p>Appropriate MySQL user privileges.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Check whether the <code>log-bin</code> option is already on:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">// for MySql 5.x
mysql&gt; SELECT variable_value as "BINARY LOGGING STATUS (log-bin) ::"
FROM information_schema.global_variables WHERE variable_name='log_bin';
// for MySql 8.x
mysql&gt; SELECT variable_value as "BINARY LOGGING STATUS (log-bin) ::"
FROM performance_schema.global_variables WHERE variable_name='log_bin';</code></pre>
</div>
</div>
</li>
<li>
<p>If it is <code>OFF</code>, configure your MySQL server configuration file with the following properties, which are described in the table below:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">server-id         = 223344 # Querying variable is called server_id, e.g. SELECT variable_value FROM information_schema.global_variables WHERE variable_name='server_id';
log_bin           = mysql-bin
binlog_format     = ROW
binlog_row_image  = FULL
expire_logs_days  = 10</code></pre>
</div>
</div>
</li>
<li>
<p>Confirm your changes by checking the binlog status once more:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">// for MySql 5.x
mysql&gt; SELECT variable_value as "BINARY LOGGING STATUS (log-bin) ::"
FROM information_schema.global_variables WHERE variable_name='log_bin';
// for MySql 8.x
mysql&gt; SELECT variable_value as "BINARY LOGGING STATUS (log-bin) ::"
FROM performance_schema.global_variables WHERE variable_name='log_bin';</code></pre>
</div>
</div>
</li>
</ol>
</div>
<table id="binlog-configuration-properties-mysql-connector" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. Descriptions of MySQL binlog configuration properties</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>server-id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value for the <code>server-id</code> must be unique for each server and replication client in the MySQL cluster. During MySQL connector set up, Debezium assigns a unique server ID to the connector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log_bin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value of <code>log_bin</code> is the base name of the sequence of binlog files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binlog_format</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>binlog-format</code> must be set to <code>ROW</code> or <code>row</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binlog_row_image</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>binlog_row_image</code> must be set to <code>FULL</code> or <code>full</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>expire_logs_days</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is the number of days for automatic binlog file removal. The default is <code>0</code>, which means no automatic removal. Set the value to match the needs of your environment. See <a href="#mysql-purges-binlog-files-used-by-debezium">MySQL purges binlog files</a>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="enable-mysql-gtids"><a class="anchor" href="#enable-mysql-gtids"></a>Enabling GTIDs</h3>
<div class="paragraph">
<p>Global transaction identifiers (GTIDs) uniquely identify transactions that occur on a server within a cluster. Though not required for a Debezium MySQL connector, using GTIDs simplifies replication and enables you to more easily confirm if primary and replica servers are consistent.</p>
</div>
<div class="paragraph">
<p>GTIDs are available in MySQL 5.6.5 and later. See the <a href="https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html#option_mysqld_gtid-mode">MySQL documentation</a> for more details.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A MySQL server.</p>
</li>
<li>
<p>Basic knowledge of SQL commands.</p>
</li>
<li>
<p>Access to the MySQL configuration file.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Enable <code>gtid_mode</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; gtid_mode=ON</code></pre>
</div>
</div>
</li>
<li>
<p>Enable <code>enforce_gtid_consistency</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; enforce_gtid_consistency=ON</code></pre>
</div>
</div>
</li>
<li>
<p>Confirm the changes:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; show global variables like '%GTID%';</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Result</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| enforce_gtid_consistency | ON    |
| gtid_mode                | ON    |
+--------------------------+-------+</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Descriptions of GTID options</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gtid_mode</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean that specifies whether GTID mode of the MySQL server is enabled or not.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ON</code> = enabled</p>
</li>
<li>
<p><code>OFF</code> = disabled</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enforce_gtid_consistency</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean that specifies whether the server enforces GTID consistency by allowing the execution of statements that can be logged in a transactionally safe manner. Required when using GTIDs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ON</code> = enabled</p>
</li>
<li>
<p><code>OFF</code> = disabled</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="mysql-session-timeouts"><a class="anchor" href="#mysql-session-timeouts"></a>Configuring session timeouts</h3>
<div class="paragraph">
<p>When an initial consistent snapshot is made for large databases, your established connection could timeout while the tables are being read. You can prevent this behavior by configuring <code>interactive_timeout</code> and <code>wait_timeout</code> in your MySQL configuration file.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A MySQL server.</p>
</li>
<li>
<p>Basic knowledge of SQL commands.</p>
</li>
<li>
<p>Access to the MySQL configuration file.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Configure <code>interactive_timeout</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; interactive_timeout=&lt;duration-in-seconds&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Configure <code>wait_timeout</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; wait_timeout=&lt;duration-in-seconds&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Descriptions of MySQL session timeout options</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interactive_timeout</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of seconds the server waits for activity on an interactive connection before closing it. See <a href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_interactive_timeout">MySQL&#8217;s documentation</a> for more details.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>wait_timeout</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of seconds the server waits for activity on a non-interactive connection before closing it. See <a href="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_wait_timeout">MySQL&#8217;s documentation</a> for more details.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="enable-query-log-events"><a class="anchor" href="#enable-query-log-events"></a>Enabling query log events</h3>
<div class="paragraph">
<p>You might want to see the original <code>SQL</code> statement for each binlog event. Enabling the <code>binlog_rows_query_log_events</code> option in the MySQL configuration file allows you to do this.</p>
</div>
<div class="paragraph">
<p>This option is available in MySQL 5.6 and later.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A MySQL server.</p>
</li>
<li>
<p>Basic knowledge of SQL commands.</p>
</li>
<li>
<p>Access to the MySQL configuration file.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Enable <code>binlog_rows_query_log_events</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; binlog_rows_query_log_events=ON</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>binlog_rows_query_log_events</code> is set to a value that enables/disables support for including the original <code>SQL</code> statement in the binlog entry.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ON</code> = enabled</p>
</li>
<li>
<p><code>OFF</code> = disabled</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="validate-binlog-row-value-options"><a class="anchor" href="#validate-binlog-row-value-options"></a>Validating binlog row value options</h3>
<div class="paragraph">
<p>Check <code>binlog_row_value_options</code> variable, and make sure that value is <strong>not</strong> set to <code>PARTIAL_JSON</code>, since in such case connector might fail to consume <strong>UPDATE</strong> events.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A MySQL server.</p>
</li>
<li>
<p>Basic knowledge of SQL commands.</p>
</li>
<li>
<p>Access to the MySQL configuration file.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Check current variable value</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; show global variables where variable_name = 'binlog_row_value_options';</code></pre>
</div>
</div>
</li>
<li>
<p>Result</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| binlog_row_value_options |       |
+--------------------------+-------+</code></pre>
</div>
</div>
</li>
<li>
<p>In case value is <code>PARTIAL_JSON</code>, unset this variable by:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-SQL hljs" data-lang="SQL">mysql&gt; set @@global.binlog_row_value_options="" ;</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mysql-deploying-a-connector"><a class="anchor" href="#mysql-deploying-a-connector"></a>Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To deploy a Debezium MySQL connector, you install the Debezium MySQL connector archive, configure the connector, and start the connector by adding its configuration to Kafka Connect.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://zookeeper.apache.org/">Apache Zookeeper</a>, <a href="http://kafka.apache.org/">Apache Kafka</a>, and <a href="https://kafka.apache.org/documentation.html#connect">Kafka Connect</a> are installed.</p>
</li>
<li>
<p>MySQL Server is installed and is <a href="#setting-up-mysql">set up to work with the Debezium connector</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download the Debezium <a href="https://repo1.maven.org/maven2/io/debezium/debezium-connector-mysql/2.3.7.Final/debezium-connector-mysql-2.3.7.Final-plugin.tar.gz">MySQL connector plug-in</a>.</p>
</li>
<li>
<p>Extract the files into your Kafka Connect environment.</p>
</li>
<li>
<p>Add the directory with the JAR files to <a href="https://kafka.apache.org/documentation/#connectconfigs">Kafka Connect&#8217;s <code>plugin.path</code></a>.</p>
</li>
<li>
<p><a href="#mysql-example-configuration">Configure the connector</a> and <a href="#mysql-adding-configuration">add the configuration to your Kafka Connect cluster.</a></p>
</li>
<li>
<p>Restart your Kafka Connect process to pick up the new JAR files.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you are working with immutable containers, see <a href="https://quay.io/organization/debezium">Debezium&#8217;s Container images</a> for Apache Zookeeper, Apache Kafka, MySQL, and Kafka Connect with the MySQL connector already installed and ready to run.</p>
</div>
<div class="paragraph">
<p>You can also <a href="../operations/openshift.html" class="xref page">run Debezium on Kubernetes and OpenShift</a>.</p>
</div>
<div class="sect2">
<h3 id="mysql-example-configuration"><a class="anchor" href="#mysql-example-configuration"></a>MySQL connector configuration example</h3>
<div class="paragraph">
<p>Following is an example of the configuration for a connector instance that captures data from a MySQL server on port 3306 at 192.168.99.100, which we logically name <code>fullfillment</code>.
Typically, you configure the Debezium MySQL connector in a JSON file by setting the configuration properties that are available for the connector.</p>
</div>
<div class="paragraph">
<p>You can choose to produce events for a subset of the schemas and tables in a database.
Optionally, you can ignore, mask, or truncate columns that contain sensitive data, that are larger than a specified size, or that you do not need.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "name": "inventory-connector", <i class="conum" data-value="1"></i><b>(1)</b>
    "config": {
        "connector.class": "io.debezium.connector.mysql.MySqlConnector", <i class="conum" data-value="2"></i><b>(2)</b>
        "database.hostname": "192.168.99.100", <i class="conum" data-value="3"></i><b>(3)</b>
        "database.port": "3306", <i class="conum" data-value="4"></i><b>(4)</b>
        "database.user": "debezium-user", <i class="conum" data-value="5"></i><b>(5)</b>
        "database.password": "debezium-user-pw", <i class="conum" data-value="6"></i><b>(6)</b>
        "database.server.id": "184054", <i class="conum" data-value="7"></i><b>(7)</b>
        "topic.prefix": "fullfillment", <i class="conum" data-value="8"></i><b>(8)</b>
        "database.include.list": "inventory", <i class="conum" data-value="9"></i><b>(9)</b>
        "schema.history.internal.kafka.bootstrap.servers": "kafka:9092", <i class="conum" data-value="10"></i><b>(10)</b>
        "schema.history.internal.kafka.topic": "schemahistory.fullfillment", <i class="conum" data-value="11"></i><b>(11)</b>
        "include.schema.changes": "true" <i class="conum" data-value="12"></i><b>(12)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Connector&#8217;s name when registered with the Kafka Connect service.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Connector&#8217;s class name.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>MySQL server address.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>MySQL server port number.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>MySQL user with the appropriate privileges.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>MySQL user&#8217;s password.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Unique ID of the connector.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Topic prefix for the MySQL server or cluster.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>List of databases hosted by the specified server.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>List of Kafka brokers that the connector uses to write and recover DDL statements to the database schema history topic.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Name of the database schema history topic. This topic is for internal use only and should not be used by consumers.</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Flag that specifies if the connector should generate events for DDL changes and emit them to the <code>fulfillment</code> schema change topic for use by consumers.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the complete list of the configuration properties that you can set for the Debezium MySQL connector,
see <a href="#mysql-connector-properties">MySQL connector configuration properties</a>.</p>
</div>
<div class="paragraph">
<p>You can send this configuration with a <code>POST</code> command to a running Kafka Connect service.
The service records the configuration and starts one connector task that performs the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Connects to the MySQL database.</p>
</li>
<li>
<p>Reads change-data tables for tables in capture mode.</p>
</li>
<li>
<p>Streams change event records to Kafka topics.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mysql-adding-configuration"><a class="anchor" href="#mysql-adding-configuration"></a>Adding connector configuration</h3>
<div class="paragraph">
<p>To start running a MySQL connector, configure a connector configuration, and add the configuration to your Kafka Connect cluster.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="#setting-up-mysql">MySQL is set up to work with a Debezium connector</a>.</p>
</li>
<li>
<p>The Debezium MySQL connector is installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a configuration for the MySQL connector.</p>
</li>
<li>
<p>Use the <a href="https://kafka.apache.org/documentation/#connect_rest">Kafka Connect REST API</a> to add that connector configuration to your Kafka Connect cluster.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Results</div>
<p>After the connector starts, it <a href="#mysql-snapshots">performs a consistent snapshot</a> of the MySQL databases that the connector is configured for.
The connector then starts generating data change events for row-level operations and streaming change event records to Kafka topics.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-connector-properties"><a class="anchor" href="#mysql-connector-properties"></a>Connector properties</h3>
<div class="paragraph">
<p>The Debezium MySQL connector has numerous configuration properties that you can use to achieve the right connector behavior for your application.
Many properties have default values.
Information about the properties is organized as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#mysql-required-connector-configuration-properties">Required connector configuration properties</a></p>
</li>
<li>
<p><a href="#mysql-advanced-connector-configuration-properties">Advanced connector configuration properties</a></p>
</li>
<li>
<p><a href="#debezium-mysql-connector-database-history-configuration-properties">Database schema history connector configuration properties</a> that control how Debezium processes events that it reads from the database schema history topic.</p>
<div class="ulist">
<ul>
<li>
<p><a href="#mysql-pass-through-database-history-properties-for-configuring-producer-and-consumer-clients">Pass-through database schema history properties</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#debezium-mysql-connector-pass-through-database-driver-configuration-properties">Pass-through database driver properties</a> that control the behavior of the database driver.</p>
</li>
</ul>
</div>
<div id="mysql-required-connector-configuration-properties" class="paragraph">
<p>The following configuration properties are <em>required</em> unless a default value is available.</p>
</div>
<div class="sect3">
<h4 id="_required_debezium_mysql_connector_configuration_properties"><a class="anchor" href="#_required_debezium_mysql_connector_configuration_properties"></a>Required Debezium MySQL connector configuration properties</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-name"></a><a href="#mysql-property-name"><code>name</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Unique name for the connector. Attempting to register again with the same name fails. This property is required by all Kafka Connect connectors.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-connector-class"></a><a href="#mysql-property-connector-class"><code>connector.class</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The name of the Java class for the connector. Always specify  <code>io.debezium.connector.mysql.MySqlConnector</code> for the MySQL connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-tasks-max"></a><a href="#mysql-property-tasks-max"><code>tasks.max</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The maximum number of tasks that should be created for this connector. The MySQL connector always uses a single task and therefore does not use this value, so the default is always acceptable.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-hostname"></a><a href="#mysql-property-database-hostname"><code>database.hostname</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>IP address or host name of the MySQL database server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-port"></a><a href="#mysql-property-database-port"><code>database.port</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>3306</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Integer port number of the MySQL database server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-user"></a><a href="#mysql-property-database-user"><code>database.user</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of the MySQL user to use when connecting to the MySQL database server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-password"></a><a href="#mysql-property-database-password"><code>database.password</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Password to use when connecting to the MySQL database server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-topic-prefix"></a><a href="#mysql-property-topic-prefix"><code>topic.prefix</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Topic prefix that provides a namespace for the particular MySQL database server/cluster in which Debezium is capturing changes. The topic prefix should be unique across all other connectors, since it is used as a prefix for all Kafka topic names that receive events emitted by this connector.
Only alphanumeric characters, hyphens, dots and underscores must be used in the database server logical name.<br>
<br></p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not change the value of this property.
If you change the name value, after a restart, instead of continuing to emit events to the original topics, the connector emits subsequent events to topics whose names are based on the new value.
The connector is also unable to recover its database schema history topic.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-server-id"></a><a href="#mysql-property-database-server-id"><code>database.server.id</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A numeric ID of this database client, which must be unique across all currently-running database processes in the MySQL cluster. This connector joins the MySQL database cluster as another server (with this unique ID) so it can read the binlog.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-include-list"></a><a href="#mysql-property-database-include-list"><code>database.include.list</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>empty string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the names of the databases for which to capture changes.
The connector does not capture changes in any database whose name is not in <code>database.include.list</code>.
By default, the connector captures changes in all databases.<br></p>
</div>
<div class="paragraph">
<p>To match the name of a database, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the database; it does not match substrings that might be present in a database name.<br>
If you include this property in the configuration, do not also set the <code>database.exclude.list</code> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-exclude-list"></a><a href="#mysql-property-database-exclude-list"><code>database.exclude.list</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>empty string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the names of databases for which you do not want to capture changes.
The connector captures changes in any database whose name is not in the <code>database.exclude.list</code>.<br></p>
</div>
<div class="paragraph">
<p>To match the name of a database, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the database; it does not match substrings that might be present in a database name.<br>
If you include this property in the configuration, do not also set the <code>database.include.list</code> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-table-include-list"></a><a href="#mysql-property-table-include-list"><code>table.include.list</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>empty string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match fully-qualified table identifiers of tables whose changes you want to capture.
The connector does not capture changes in any table that is not included in <code>table.include.list</code>.
Each identifier is of the form <em>databaseName</em>.<em>tableName</em>.
By default, the connector captures changes in every non-system table in each database whose changes are being captured.<br></p>
</div>
<div class="paragraph">
<p>To match the name of a table, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the table; it does not match substrings that might be present in a table name.<br>
If you include this property in the configuration, do not also set the <code>table.exclude.list</code> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-table-exclude-list"></a><a href="#mysql-property-table-exclude-list"><code>table.exclude.list</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>empty string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match fully-qualified table identifiers for tables whose changes you do not want to capture.
The connector captures changes in any table that is not included in <code>table.exclude.list</code>.
Each identifier is of the form <em>databaseName</em>.<em>tableName</em>.<br></p>
</div>
<div class="paragraph">
<p>To match the name of a column, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the table; it does not match substrings that might be present in a table name.<br>
If you include this property in the configuration, do not also set the <code>table.include.list</code> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-column-exclude-list"></a><a href="#mysql-property-column-exclude-list"><code>column.exclude.list</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>empty string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the fully-qualified names of columns to exclude from change event record values.
Fully-qualified names for columns are of the form <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.<br></p>
</div>
<div class="paragraph">
<p>To match the name of a column, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the column; it does not match substrings that might be present in a column name.
If you include this property in the configuration, do not also set the <code>column.include.list</code> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-column-include-list"></a><a href="#mysql-property-column-include-list"><code>column.include.list</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>empty string</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the fully-qualified names of columns to include in change event record values.
Fully-qualified names for columns are of the form <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.<br></p>
</div>
<div class="paragraph">
<p>To match the name of a column, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the column; it does not match substrings that might be present in a column name.<br>
If you include this property in the configuration, do not set the <code>column.exclude.list</code> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-skip-messages-without-change"></a><a href="#mysql-property-skip-messages-without-change"><code>skip.messages.without.change</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies whether to skip publishing messages when there is no change in included columns. This would essentially filter messages if there is no change in columns included as per <code>column.include.list</code> or <code>column.exclude.list</code> properties.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-column-truncate-to-length-chars"></a><a href="#mysql-property-column-truncate-to-length-chars"><code>column.truncate.to.<em>length</em>.chars</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the fully-qualified names of character-based columns.
Set this property if you want to truncate the data in a set of columns when it exceeds the number of characters specified by the <em>length</em> in the property name.
Set <code>length</code> to a positive integer value, for example, <code>column.truncate.to.20.chars</code>.</p>
</div>
<div class="paragraph">
<p>The fully-qualified name of a column observes the following format: <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.
To match the name of a column, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the column; the expression does not match substrings that might be present in a column name.</p>
</div>
<div class="paragraph">
<p>You can specify multiple properties with different lengths in a single configuration.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-column-mask-with-length-chars"></a><a href="#mysql-property-column-mask-with-length-chars"><code>column.mask.with.<em>length</em>.chars</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the fully-qualified names of character-based columns.
Set this property if you want the connector to mask the values for a set of columns, for example, if they contain sensitive data.
Set <code><em>length</em></code> to a positive integer to replace data in the specified columns with the number of asterisk (<code>*</code>) characters specified by the <em>length</em> in the property name.
Set <em>length</em> to <code>0</code> (zero) to replace data in the specified columns with an empty string.</p>
</div>
<div class="paragraph">
<p>The fully-qualified name of a column observes the following format: <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>.
To match the name of a column, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the column; the expression does not match substrings that might be present in a column name.</p>
</div>
<div class="paragraph">
<p>You can specify multiple properties with different lengths in a single configuration.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-column-mask-hash"></a><a href="#mysql-property-column-mask-hash"><code>column.mask.hash.<em>hashAlgorithm</em>.with.salt.<em>salt</em></code></a>;
<a id="mysql-property-column-mask-hash-v2"></a><a href="#mysql-property-column-mask-hash-v2"><code>column.mask.hash.v2.<em>hashAlgorithm</em>.with.salt.<em>salt</em></code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the fully-qualified names of character-based columns.
Fully-qualified names for columns are of the form <code><em>&lt;databaseName&gt;</em>.<em>&lt;tableName&gt;</em>.<em>&lt;columnName&gt;</em></code>.<br>
To match the name of a column Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the column; the expression does not match substrings that might be present in a column name.
In the resulting change event record, the values for the specified columns are replaced with pseudonyms.<br></p>
</div>
<div class="paragraph">
<p>A pseudonym consists of the hashed value that results from applying the specified <em>hashAlgorithm</em> and <em>salt</em>.
Based on the hash function that is used, referential integrity is maintained, while column values are replaced with pseudonyms.
Supported hash functions are described in the <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/security/StandardNames.html#MessageDigest">MessageDigest section</a> of the Java Cryptography Architecture Standard Algorithm Name Documentation.<br>
<br>
In the following example, <code>CzQMA0cB5K</code> is a randomly selected salt.<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre>column.mask.hash.SHA-256.with.salt.CzQMA0cB5K = inventory.orders.customerName, inventory.shipment.customerName</pre>
</div>
</div>
<div class="paragraph">
<p>If necessary, the pseudonym is automatically shortened to the length of the column.
The connector configuration can include multiple properties that specify different hash algorithms and salts.<br>
<br>
Depending on the <em>hashAlgorithm</em> used, the <em>salt</em> selected, and the actual data set, the resulting data set might not be completely masked.<br>
<br>
Hashing strategy version 2 should be used to ensure fidelity if the value is being hashed in different places or systems.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-column-propagate-source-type"></a><a href="#mysql-property-column-propagate-source-type"><code>column.propagate.source.type</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the fully-qualified names of columns for which you want the connector to emit extra parameters that represent column metadata.
When this property is set, the connector adds the following fields to the schema of event records:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>__debezium.source.column.type</code><br></p>
</li>
<li>
<p><code>__debezium.source.column.length</code><br></p>
</li>
<li>
<p><code>__debezium.source.column.scale</code><br></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These parameters propagate a column&#8217;s original type name and length (for variable-width types), respectively.<br>
Enabling the connector to emit this extra data can assist in properly sizing specific numeric or character-based columns in sink databases.</p>
</div>
<div class="paragraph">
<p>The fully-qualified name of a column observes one of the following formats: <em>databaseName</em>.<em>tableName</em>.<em>columnName</em>, or <em>databaseName</em>.<em>schemaName</em>.<em>tableName</em>.<em>columnName</em>.<br>
To match the name of a column, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the column; the expression does not match substrings that might be present in a column name.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-datatype-propagate-source-type"></a><a href="#mysql-property-datatype-propagate-source-type"><code>datatype.propagate.source.type</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that specify the fully-qualified names of data types that are defined for columns in a database.
When this property is set, for columns with matching data types, the connector emits event records that include the following extra fields in their schema:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>__debezium.source.column.type</code><br></p>
</li>
<li>
<p><code>__debezium.source.column.length</code><br></p>
</li>
<li>
<p><code>__debezium.source.column.scale</code><br></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These parameters propagate a column&#8217;s original type name and length (for variable-width types), respectively.<br>
Enabling the connector to emit this extra data can assist in properly sizing specific numeric or character-based columns in sink databases.</p>
</div>
<div class="paragraph">
<p>The fully-qualified name of a column observes one of the following formats: <em>databaseName</em>.<em>tableName</em>.<em>typeName</em>, or <em>databaseName</em>.<em>schemaName</em>.<em>tableName</em>.<em>typeName</em>.<br>
To match the name of a data type, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the data type; the expression does not match substrings that might be present in a type name.</p>
</div>
<div class="paragraph">
<p>For the list of MySQL-specific data type names, see the <a href="#mysql-data-types">MySQL data type mappings</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-time-precision-mode"></a><a href="#mysql-property-time-precision-mode"><code>time.precision.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>adaptive_time_microseconds</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Time, date, and timestamps can be represented with different kinds of precision, including:<br>
<br>
<code>adaptive_time_microseconds</code> (the default) captures the date, datetime and timestamp values exactly as in the database using either millisecond, microsecond, or nanosecond precision values based on the database column&#8217;s type, with the exception of TIME type fields, which are always captured as microseconds.<br>
<br>
<code>adaptive</code> (deprecated) captures the time and timestamp values exactly as in the database using either millisecond, microsecond, or nanosecond precision values based on the database column&#8217;s type.<br>
<br>
<code>connect</code> always represents time and timestamp values using Kafka Connect&#8217;s built-in representations for Time, Date, and Timestamp, which use millisecond precision regardless of the database columns' precision.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-decimal-handling-mode"></a><a href="#mysql-property-decimal-handling-mode"><code>decimal.handling.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>precise</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how the connector should handle values for <code>DECIMAL</code> and <code>NUMERIC</code> columns:<br>
<br>
<code>precise</code> (the default) represents them precisely using <code>java.math.BigDecimal</code> values represented in change events in a binary form.<br>
<br>
<code>double</code> represents them using <code>double</code> values, which may result in a loss of precision but is easier to use.<br>
<br>
<code>string</code> encodes values as formatted strings, which is easy to consume but  semantic information about the real type is lost.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-bigint-unsigned-handling-mode"></a><a href="#mysql-property-bigint-unsigned-handling-mode"><code>bigint.unsigned.handling.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how BIGINT UNSIGNED columns should be represented in change events. Possible settings are:<br>
<br>
 <code>long</code> represents values by using Java&#8217;s <code>long</code>, which might not offer the precision but which is easy to use in consumers. <code>long</code> is usually the preferred setting.<br>
<br>
<code>precise</code> uses <code>java.math.BigDecimal</code> to represent values, which are encoded in the change events by using a binary representation and Kafka Connect&#8217;s <code>org.apache.kafka.connect.data.Decimal</code> type. Use this setting when working with values larger than 2^63, because these values cannot be conveyed by using <code>long</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-include-schema-changes"></a><a href="#mysql-property-include-schema-changes"><code>include.schema.changes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>true</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean value that specifies whether the connector should publish changes in the database schema to a Kafka topic with the same name as the database server ID. Each schema change is recorded by using a key that contains the database name and whose value includes the DDL statement(s). This is independent of how the connector internally records database schema history.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-include-schema-comments"></a><a href="#mysql-property-include-schema-comments"><code>include.schema.comments</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean value that specifies whether the connector should parse and publish table and column comments on metadata objects. Enabling this option will bring the implications on memory usage. The number and size of logical schema objects is what largely impacts how much memory is consumed by the Debezium connectors, and adding potentially large string data to each of them can potentially be quite expensive.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-include-query"></a><a href="#mysql-property-include-query"><code>include.query</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean value that specifies whether the connector should include the original SQL query that generated the change event.<br>
<br>
If you set this option to <code>true</code> then you must also configure MySQL with the <code>binlog_rows_query_log_events</code> option set to <code>ON</code>. When <code>include.query</code> is <code>true</code>, the query is not present for events that the snapshot process generates.<br>
<br>
Setting <code>include.query</code> to <code>true</code> might expose tables or fields that are explicitly excluded or masked by including the original SQL statement in the change event. For this reason, the default setting is <code>false</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-event-deserialization-failure-handling-mode"></a><a href="#mysql-property-event-deserialization-failure-handling-mode"><code>event.deserialization.failure.handling.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>fail</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how the connector should react to exceptions during deserialization of binlog events.
This option is deprecated, please use <a href="#mysql-property-event-processing-failure-handling-mode"><code>event.processing.failure.handling.mode</code></a> option instead.<br>
<br>
<code>fail</code> propagates the exception, which indicates the problematic event and its binlog offset, and causes the connector to stop.<br>
<br>
<code>warn</code> logs the problematic event and its binlog offset and then skips the event.<br>
<br>
<code>ignore</code> passes over the problematic event and does not log anything.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-inconsistent-schema-handling-mode"></a><a href="#mysql-property-inconsistent-schema-handling-mode"><code>inconsistent.schema.handling.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>fail</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how the connector should react to binlog events that relate to tables that are not present in internal schema representation. That is, the internal representation is not consistent with the database.<br>
<br>
<code>fail</code> throws an exception that indicates the problematic event and its binlog offset, and causes the connector to stop.<br>
<br>
<code>warn</code> logs the problematic event and its binlog offset and skips the event.<br>
<br>
<code>skip</code> passes over the problematic event and does not log anything.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-max-batch-size"></a><a href="#mysql-property-max-batch-size"><code>max.batch.size</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>2048</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Positive integer value that specifies the maximum size of each batch of events that should be processed during each iteration of this connector. Defaults to 2048.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-max-queue-size"></a><a href="#mysql-property-max-queue-size"><code>max.queue.size</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>8192</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Positive integer value that specifies the maximum number of records that the blocking queue can hold.
When Debezium reads events streamed from the database, it places the events in the blocking queue before it writes them to Kafka.
The blocking queue can provide backpressure for reading change events from the database
in cases where the connector ingests messages faster than it can write them to Kafka, or when Kafka becomes unavailable.
Events that are held in the queue are disregarded when the connector periodically records offsets.
Always set the value of <code>max.queue.size</code> to be larger than the value of <a href="#mysql-property-max-batch-size"><code>max.batch.size</code></a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-max-queue-size-in-bytes"></a><a href="#mysql-property-max-queue-size-in-bytes"><code>max.queue.size.in.bytes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>0</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A long integer value that specifies the maximum volume of the blocking queue in bytes.
By default, volume limits are not specified for the blocking queue.
To specify the number of bytes that the queue can consume, set this property to a positive long value.<br>
If <a href="#mysql-property-max-queue-size"><code>max.queue.size</code></a> is also set, writing to the queue is blocked when the size of the queue reaches the limit specified by either property.
For example, if you set <code>max.queue.size=1000</code>, and <code>max.queue.size.in.bytes=5000</code>, writing to the queue is blocked after the queue contains 1000 records, or after the volume of the records in the queue reaches 5000 bytes.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-poll-interval-ms"></a><a href="#mysql-property-poll-interval-ms"><code>poll.interval.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>500</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Positive integer value that specifies the number of milliseconds the connector should wait for new change events to appear before it starts processing a batch of events. Defaults to 500 milliseconds, or 0.5 second.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-connect-timeout-ms"></a><a href="#mysql-property-connect-timeout-ms"><code>connect.timeout.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>30000</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A positive integer value that specifies the maximum time in milliseconds this connector should wait after trying to connect to the MySQL database server before timing out. Defaults to 30 seconds.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-gtid-source-includes"></a><a href="#mysql-property-gtid-source-includes"><code>gtid.source.includes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A comma-separated list of regular expressions that match source UUIDs in the GTID set used that the connector uses to find the binlog position on the MySQL server.
When this property is set, the connector uses only the GTID ranges that have source UUIDs that match one of the specified <code>include</code> patterns.</p>
</div>
<div class="paragraph">
<p>To match the value of a GTID, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire UUID string; it does not match substrings that might be present in the UUID.<br>
If you include this property in the configuration, do not also set the <code>gtid.source.excludes</code> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-gtid-source-excludes"></a><a href="#mysql-property-gtid-source-excludes"><code>gtid.source.excludes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A comma-separated list of regular expressions that match source UUIDs in the GTID set that the connector uses to find the binlog position on the MySQL server.
When this property is set, the connector uses only the GTID ranges that have source UUIDs that do not match any of the specified <code>exclude</code> patterns.</p>
</div>
<div class="paragraph">
<p>To match the value of a GTID, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire UUID string; it does not match substrings that might be present in the UUID.<br>
If you include this property in the configuration, do not also set the <code>gtid.source.includes</code> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-tombstones-on-delete"></a><a href="#mysql-property-tombstones-on-delete"><code>tombstones.on.delete</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>true</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Controls whether a <em>delete</em> event is followed by a tombstone event.<br>
<br>
<code>true</code> - a delete operation is represented by a <em>delete</em> event and a subsequent tombstone event. <br>
<br>
<code>false</code> - only a <em>delete</em> event is emitted.<br>
<br>
After a source record is deleted, emitting a tombstone event (the default behavior) allows Kafka to completely delete all events that pertain to the key of the deleted row in case <a href="https://kafka.apache.org/documentation/#compaction">log compaction</a> is enabled for the topic.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-message-key-columns"></a><a href="#mysql-property-message-key-columns"><code>message.key.columns</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><em>n/a</em></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A list of expressions that specify the columns that the connector uses to form custom message keys for change event records that it publishes to the Kafka topics for specified tables.</p>
</div>
<div class="paragraph">
<p>By default, Debezium uses the primary key column of a table as the message key for records that it emits.
In place of the default, or to specify a key for tables that lack a primary key, you can configure custom message keys based on one or more columns.<br>
<br>
To establish a custom message key for a table, list the table, followed by the columns to use as the message key.
Each list entry takes the following format:<br>
<br>
<code><em>&lt;fully-qualified_tableName&gt;</em>:<em>&lt;keyColumn&gt;</em>,<em>&lt;keyColumn&gt;</em></code><br>
<br>
To base a table key on multiple column names, insert commas between the column names.</p>
</div>
<div class="paragraph">
<p>Each fully-qualified table name is a regular expression in the following format:<br>
<br>
<code><em>&lt;databaseName&gt;</em>.<em>&lt;tableName&gt;</em></code><br>
<br>
The property can include entries for multiple tables.
Use a semicolon to separate table entries in the list.<br>
<br>
The following example sets the message key for the tables <code>inventory.customers</code> and <code>purchase.orders</code>:<br>
<br>
<code>inventory.customers:pk1,pk2;(.*).purchaseorders:pk3,pk4</code><br>
<br>
For the table <code>inventory.customer</code>, the columns <code>pk1</code> and <code>pk2</code> are specified as the message key.
For the <code>purchaseorders</code> tables in any database, the columns <code>pk3</code> and <code>pk4</code> server as the message key.</p>
</div>
<div class="paragraph">
<p>There is no limit to the number of columns that you use to create custom message keys.
However, it&#8217;s best to use the minimum number that are required to specify a unique key.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-binary-handling-mode"></a><a href="#mysql-property-binary-handling-mode"><code>binary.handling.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>bytes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how binary columns, for example, <code>blob</code>, <code>binary</code>, <code>varbinary</code>, should be represented in change events. Possible settings: <br>
<br>
<code>bytes</code> represents binary data as a byte array.<br>
<br>
<code>base64</code> represents binary data as a base64-encoded String.<br>
<br>
<code>base64-url-safe</code> represents binary data as a base64-url-safe-encoded String.<br>
<br>
<code>hex</code> represents binary data as a hex-encoded (base16) String.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-schema-name-adjustment-mode"></a><a href="#mysql-property-schema-name-adjustment-mode"><code>schema.name.adjustment.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>none</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how schema names should be adjusted for compatibility with the message converter used by the connector. Possible settings: <br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>none</code> does not apply any adjustment.<br></p>
</li>
<li>
<p><code>avro</code> replaces the characters that cannot be used in the Avro type name with underscore.<br></p>
</li>
<li>
<p><code>avro_unicode</code> replaces the underscore or characters that cannot be used in the Avro type name with corresponding unicode like _uxxxx. Note: _ is an escape sequence like backslash in Java<br></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-field-name-adjustment-mode"></a><a href="#mysql-property-field-name-adjustment-mode"><code>field.name.adjustment.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>none</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how field names should be adjusted for compatibility with the message converter used by the connector. Possible settings: <br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>none</code> does not apply any adjustment.<br></p>
</li>
<li>
<p><code>avro</code> replaces the characters that cannot be used in the Avro type name with underscore.<br></p>
</li>
<li>
<p><code>avro_unicode</code> replaces the underscore or characters that cannot be used in the Avro type name with corresponding unicode like _uxxxx. Note: _ is an escape sequence like backslash in Java<br></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="../configuration/avro.html#avro-naming" class="xref page">Avro naming</a> for more details.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="mysql-advanced-connector-configuration-properties"><a class="anchor" href="#mysql-advanced-connector-configuration-properties"></a>Advanced MySQL connector configuration properties</h4>
<div class="paragraph">
<p>The following table describes <a href="#mysql-advanced-connector-configuration-properties">advanced MySQL connector properties</a>. The default values for these properties rarely need to be changed. Therefore, you do not need to specify them in the connector configuration.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. Descriptions of MySQL connector advanced configuration properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-connect-keep-alive"></a><a href="#mysql-property-connect-keep-alive"><code>connect.keep.alive</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>true</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A Boolean value that specifies whether a separate thread should be used to ensure that the connection to the MySQL server/cluster is kept alive.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-converters"></a><a href="#mysql-property-converters"><code>converters</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Enumerates a comma-separated list of the symbolic names of the <a href="../development/converters.html#custom-converters" class="xref page">custom converter</a> instances that the connector can use.<br>
For example, <code>boolean</code>.<br>
This property is required to enable the connector to use a custom converter.</p>
</div>
<div class="paragraph">
<p>For each converter that you configure for a connector, you must also add a <code>.type</code> property, which specifies the fully-qualifed name of the class that implements the converter interface.
The <code>.type</code> property uses the following format:<br></p>
</div>
<div class="paragraph">
<p><code><em>&lt;converterSymbolicName&gt;</em>.type</code><br></p>
</div>
<div class="paragraph">
<p>For example,<br></p>
</div>
<div class="literalblock">
<div class="content">
<pre>boolean.type: io.debezium.connector.mysql.converters.TinyIntOneToBooleanConverter</pre>
</div>
</div>
<div class="paragraph">
<p>If you want to further control the behavior of a configured converter, you can add one or more configuration parameters to pass values to the converter.
To associate these additional configuration parameter with a converter, prefix the paraemeter name with the symbolic name of the converter.<br>
<br>
For example, to define a <code>selector</code> parameter that specifies the subset of columns that the <code>boolean</code> converter processes, add the following property:<br></p>
</div>
<div class="literalblock">
<div class="content">
<pre>boolean.selector=db1.table1.*, db1.table2.column1</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-table-ignore-builtin"></a><a href="#mysql-property-table-ignore-builtin"><code>table.ignore.builtin</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>true</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A Boolean value that specifies whether built-in system tables should be ignored. This applies regardless of the table include and exclude lists. By default, system tables are excluded from having their changes captured, and no events are generated when changes are made to any system tables.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-ssl-mode"></a><a href="#mysql-property-database-ssl-mode"><code>database.ssl.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>preferred</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies whether to use an encrypted connection. Possible settings are:<br>
<br>
<code>disabled</code> specifies the use of an unencrypted connection.<br>
<br>
<code>preferred</code> establishes an encrypted connection if the server supports secure connections. If the server does not support secure connections, falls back to an unencrypted connection.<br>
<br>
<code>required</code> establishes an encrypted connection or fails if one cannot be made for any reason.<br>
<br>
<code>verify_ca</code> behaves like <code>required</code> but additionally it verifies the server TLS certificate against the configured Certificate Authority (CA) certificates and fails if the server TLS certificate does not match any valid CA certificates.<br>
<br>
<code>verify_identity</code> behaves like <code>verify_ca</code> but additionally verifies that the server certificate matches the host of the remote connection.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-binlog-buffer-size"></a><a href="#mysql-property-binlog-buffer-size"><code>binlog.buffer.size</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>0</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The size of a look-ahead buffer used by the binlog reader. The default setting of <code>0</code> disables buffering.<br>
<br>
Under specific conditions, it is possible that the MySQL binlog contains uncommitted data finished by a <code>ROLLBACK</code> statement.
Typical examples are using savepoints or mixing temporary and regular table changes in a single transaction.<br>
<br>
When a beginning of a transaction is detected then Debezium tries to roll forward the binlog position and find either <code>COMMIT</code> or <code>ROLLBACK</code> so it can determine whether to stream the changes from the transaction.
The size of the binlog buffer defines the maximum number of changes in the transaction that Debezium can buffer while searching for transaction boundaries.
If the size of the transaction is larger than the buffer then Debezium must rewind and re-read the events that have not fit into the buffer while streaming.<br>
<br>
NOTE: This feature is incubating. Feedback is encouraged. It is expected that this feature is not completely polished.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-mode"></a><a href="#mysql-property-snapshot-mode"><code>snapshot.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>initial</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies the criteria for running a snapshot when the connector starts. Possible settings are:<br>
<br>
<code>initial</code> - the connector runs a snapshot only when no offsets have been recorded for the logical server name.<br>
<br>
<code>initial_only</code> - the connector runs a snapshot only when no offsets have been recorded for the logical server name and then stops; i.e. it will not read change events from the binlog.<br>
<br>
<code>when_needed</code> - the connector runs a snapshot upon startup whenever it deems it necessary. That is, when no offsets are available, or when a previously recorded offset specifies a binlog location or GTID that is not available in the server.<br>
<br>
<code>never</code> - the connector never uses snapshots. Upon first startup with a logical server name, the connector reads from the beginning of the binlog. Configure this behavior with care. It is valid only when the binlog is guaranteed to contain the entire history of the database.<br>
<br>
<code>schema_only</code> - the connector runs a snapshot of the schemas and not the data. This setting is useful when you do not need the topics to contain a consistent snapshot of the data but need them to have only the changes since the connector was started.<br>
<br>
<code>schema_only_recovery</code> - this is a recovery setting for a connector that has already been capturing changes. When you restart the connector, this setting enables recovery of a corrupted or lost database schema history topic. You might set it periodically to "clean up" a database schema history topic that has been growing unexpectedly. Database schema history topics require infinite retention.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-locking-mode"></a><a href="#mysql-property-snapshot-locking-mode"><code>snapshot.locking.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>minimal</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Controls whether and how long the connector holds the global MySQL read lock, which prevents any updates to the database, while the connector is performing a snapshot. Possible settings are:<br>
<br>
<code>minimal</code> - the connector holds the global read lock for only the initial portion of the snapshot during which the connector reads the database schemas and other metadata. The remaining work in a snapshot involves selecting all rows from each table. The connector can do this in a consistent fashion by using a REPEATABLE READ transaction. This is the case even when the global read lock is no longer held and other MySQL clients are updating the database.<br>
<br>
<code>minimal_percona</code> - the connector holds <a href="https://www.percona.com/doc/percona-server/5.7/management/backup_locks.html">the global backup lock</a> for only the initial portion of the snapshot during which the connector reads the database schemas and other metadata. The remaining work in a snapshot involves selecting all rows from each table. The connector can do this in a consistent fashion by using a REPEATABLE READ transaction. This is the case even when the global backup lock is no longer held and other MySQL clients are updating the database. This mode does not flush tables to disk, is not blocked by long-running reads, and is available only in Percona Server.<br>
<br>
<code>extended</code> - blocks all writes for the duration of the snapshot. Use this setting if there are clients that are submitting operations that MySQL excludes from REPEATABLE READ semantics.<br>
<br>
<code>none</code> - prevents the connector from acquiring any table locks during the snapshot. While this setting is allowed with all snapshot modes, it is safe to use if and <em>only</em> if no schema changes are happening while the snapshot is running. For tables defined with MyISAM engine, the tables would still be locked despite this property being set as MyISAM acquires a table lock. This behavior is unlike InnoDB engine, which acquires row level locks.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-include-collection-list"></a><a href="#mysql-property-snapshot-include-collection-list"><code>snapshot.include.collection.list</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>All tables specified in <code>table.include.list</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An optional, comma-separated list of regular expressions that match the fully-qualified names (<code><em>&lt;databaseName&gt;.&lt;tableName&gt;</em></code>) of the tables to include in a snapshot.
The specified items must be named in the connector&#8217;s <a href="#mysql-property-table-include-list"><code>table.include.list</code></a> property.
This property takes effect only if the connector&#8217;s <a href="#mysql-property-snapshot-mode"><code>snapshot.mode</code></a> property is set to a value other than <code>never</code>.<br>
This property does not affect the behavior of incremental snapshots.<br></p>
</div>
<div class="paragraph">
<p>To match the name of a table, Debezium applies the regular expression that you specify as an <em>anchored</em> regular expression.
That is, the specified expression is matched against the entire name string of the table; it does not match substrings that might be present in a table name.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-select-statement-overrides"></a><a href="#mysql-property-snapshot-select-statement-overrides"><code>snapshot.select.statement.overrides</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies the table rows to include in a snapshot.
Use the property if you want a snapshot to include only a subset of the rows in a table.
This property affects snapshots only.
It does not apply to events that the connector reads from the log.</p>
</div>
<div class="paragraph">
<p>The property contains a comma-separated list of fully-qualified table names in the form <code><em>&lt;databaseName&gt;.&lt;tableName&gt;</em></code>. For example,<br>
<br>
<code>"snapshot.select.statement.overrides": "inventory.products,customers.orders"</code><br>
<br>
For each table in the list, add a further configuration property that specifies the <code>SELECT</code> statement for the connector to run on the table when it takes a snapshot.
The specified <code>SELECT</code> statement determines the subset of table rows to include in the snapshot.
Use the following format to specify the name of this <code>SELECT</code> statement property:<br>
<br>
<code>snapshot.select.statement.overrides.<em>&lt;databaseName&gt;</em>.<em>&lt;tableName&gt;</em></code>.
For example,
<code>snapshot.select.statement.overrides.customers.orders</code>.<br>
<br>
Example:</p>
</div>
<div class="paragraph">
<p>From a <code>customers.orders</code> table that includes the soft-delete column, <code>delete_flag</code>, add the following properties if you want a snapshot to include only those records that are not soft-deleted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"snapshot.select.statement.overrides": "customer.orders",
"snapshot.select.statement.overrides.customer.orders": "SELECT * FROM [customers].[orders] WHERE delete_flag = 0 ORDER BY id DESC"</pre>
</div>
</div>
<div class="paragraph">
<p>In the resulting snapshot, the connector includes only the records for which <code>delete_flag = 0</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-min-row-count-to-stream-results"></a><a href="#mysql-property-min-row-count-to-stream-results"><code>min.row.count.to.stream.results</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>1000</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>During a snapshot, the connector queries each table for which the connector is configured to capture changes. The connector uses each query result to produce a read event that contains data for all rows in that table. This property determines whether the MySQL connector puts results for a table into memory, which is fast but requires large amounts of memory, or streams the results, which can be slower but work for very large tables. The setting of this property specifies the minimum number of rows a table must contain before the connector streams results.<br>
<br>
To skip all table size checks and always stream all results during a snapshot, set this property to <code>0</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-heartbeat-interval-ms"></a><a href="#mysql-property-heartbeat-interval-ms"><code>heartbeat.interval.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>0</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Controls how frequently the connector sends heartbeat messages to a Kafka topic. The default behavior is that the connector does not send heartbeat messages.<br>
<br>
Heartbeat messages are useful for monitoring whether the connector is receiving change events from the database. Heartbeat messages might help decrease the number of change events that need to be re-sent when a connector restarts. To send heartbeat messages, set this property to a positive integer, which indicates the number of milliseconds between heartbeat messages.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-heartbeat-action-query"></a><a href="#mysql-property-heartbeat-action-query"><code>heartbeat.action.query</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies a query that the connector executes on the source database when the connector sends a heartbeat message.<br>
<br>
For example, this can be used to periodically capture the state of the executed GTID set in the source database.<br>
<br>
<code>INSERT INTO gtid_history_table (select * from mysql.gtid_executed)</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-initial-statements"></a><a href="#mysql-property-database-initial-statements"><code>database.initial.statements</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A semicolon separated list of SQL statements to be executed when a JDBC connection, not the connection that is reading the transaction log, to the database is established.
To specify a semicolon as a character in a SQL statement and not as a delimiter, use two semicolons, (<code>;;</code>).<br>
<br>
The connector might establish JDBC connections at its own discretion, so this property is ony for configuring session parameters. It is not for executing DML statements.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-delay-ms"></a><a href="#mysql-property-snapshot-delay-ms"><code>snapshot.delay.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An interval in milliseconds that the connector should wait before performing a snapshot when the connector starts. If you are starting multiple connectors in a cluster, this property is useful for avoiding snapshot interruptions, which might cause re-balancing of connectors.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-fetch-size"></a><a href="#mysql-property-snapshot-fetch-size"><code>snapshot.fetch.size</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>During a snapshot, the connector reads table content in batches of rows. This property specifies the maximum number of rows in a batch.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-lock-timeout-ms"></a><a href="#mysql-property-snapshot-lock-timeout-ms"><code>snapshot.lock.timeout.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>10000</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Positive integer that specifies the maximum amount of time (in milliseconds) to wait to obtain table locks when performing a snapshot. If the connector cannot acquire table locks in this time interval, the snapshot fails. See <a href="#mysql-snapshots">how MySQL connectors perform database snapshots</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-enable-time-adjuster"></a><a href="#mysql-property-enable-time-adjuster"><code>enable.time.adjuster</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>true</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Boolean value that indicates whether the connector converts a 2-digit year specification to 4 digits. Set to <code>false</code> when conversion is fully delegated to the database.<br>
<br>
MySQL allows users to insert year values with either 2-digits or 4-digits. For 2-digit values, the value gets mapped to a year in the range 1970 - 2069. The default behavior is that the connector does the conversion.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-source-struct-version"></a><a href="#mysql-property-source-struct-version"><code>source.struct.version</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>v2</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Schema version for the <code>source</code> block in Debezium events.  Debezium 0.10 introduced a few breaking changes to the structure of the <code>source</code> block in order to unify the exposed structure across all the connectors.<br>
<br>
By setting this option to <code>v1</code>, the structure used in earlier versions can be produced. However, this setting is not recommended and is planned for removal in a future Debezium version.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-skipped-operations"></a><a href="#mysql-property-skipped-operations"><code>skipped.operations</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>t</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A comma-separated list of operation types that will be skipped during streaming.
The operations include: <code>c</code> for inserts/create, <code>u</code> for updates, <code>d</code> for deletes, <code>t</code> for truncates, and <code>none</code> to not skip any operations.
By default, truncate operations are skipped.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-signal-data-collection"></a><a href="#mysql-property-signal-data-collection"><code>signal.data.collection</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default value</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Fully-qualified name of the data collection that is used to send <a href="../configuration/signalling.html#debezium-signaling-enabling-source-signaling-channel" class="xref page">signals</a> to the connector.<br>
Use the following format to specify the collection name:<br>
<code><em>&lt;databaseName&gt;</em>.<em>&lt;tableName&gt;</em></code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-signal-enabled-channels"></a><a href="#mysql-property-signal-enabled-channels"><code>signal.enabled.channels</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>source</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List of the signaling channel names that are enabled for the connector.
By default, the following channels are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>source</code></p>
</li>
<li>
<p><code>kafka</code></p>
</li>
<li>
<p><code>file</code></p>
</li>
<li>
<p><code>jmx</code>
Optionally, you can also implement a <a href="../configuration/signalling.html#debezium-signaling-enabling-custom-signaling-channel" class="xref page">custom signaling channel</a>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-notification-enabled-channels"></a><a href="#mysql-property-notification-enabled-channels"><code>notification.enabled.channels</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>List of notification channel names that are enabled for the connector.
By default, the following channels are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sink</code></p>
</li>
<li>
<p><code>log</code></p>
</li>
<li>
<p><code>jmx</code>
Optionally, you can also implement a <a href="../configuration/notification.html#debezium-notification-custom-channel" class="xref page">custom notification channel</a>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-incremental-snapshot-allow-schema-changes"></a><a href="#mysql-property-incremental-snapshot-allow-schema-changes"><code>incremental.snapshot.allow.schema.changes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Allow schema changes during an incremental snapshot. When enabled the connector will detect schema change during an incremental snapshot and re-select a current chunk to avoid locking DDLs.<br>
<br>
Note that changes to a primary key are not supported and can cause incorrect results if performed during an incremental snapshot. Another limitation is that if a schema change affects only columns' default values, then the change won&#8217;t be detected until the DDL is processed from the binlog stream. This doesn&#8217;t affect the snapshot events' values, but the schema of snapshot events may have outdated defaults.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-incremental-snapshot-chunk-size"></a><a href="#mysql-property-incremental-snapshot-chunk-size"><code>incremental.snapshot.chunk.size</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>1024</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The maximum number of rows that the connector fetches and reads into memory during an incremental snapshot chunk.
Increasing the chunk size provides greater efficiency, because the snapshot runs fewer snapshot queries of a greater size.
However, larger chunk sizes also require more memory to buffer the snapshot data.
Adjust the chunk size to a value that provides the best performance in your environment.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-read-only"></a><a href="#mysql-property-read-only"><code>read.only</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Switch to alternative incremental snapshot watermarks implementation to avoid writes to signal data collection</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-provide-transaction-metadata"></a><a href="#mysql-property-provide-transaction-metadata"><code>provide.transaction.metadata</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Determines whether the connector generates events with transaction boundaries and enriches change event envelopes with transaction metadata. Specify <code>true</code> if you want the connector to do this. See <a href="#mysql-transaction-metadata">Transaction metadata</a> for details.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-event-processing-failure-handling-mode"></a><a href="#mysql-property-event-processing-failure-handling-mode"><code>event.processing.failure.handling.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>fail</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specify how failures during processing of events (i.e. when encountering a corrupted event) should be handled. By default, <code>fail</code> mode raises an exception indicating the problematic event and its position, causing the connector to be stopped. <code>warn</code> mode does not raise the exception, instead the problematic event and its position will be logged and the event will be skipped. <code>ignore</code> mode ignores the problematic event completely with no logging.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-topic-naming-strategy"></a><a href="#mysql-property-topic-naming-strategy"><code>topic.naming.strategy</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>io.debezium.schema.DefaultTopicNamingStrategy</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The name of the TopicNamingStrategy class that should be used to determine the topic name for data change, schema change, transaction, heartbeat event etc., defaults to <code>DefaultTopicNamingStrategy</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-topic-delimiter"></a><a href="#mysql-property-topic-delimiter"><code>topic.delimiter</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>.</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specify the delimiter for topic name, defaults to <code>.</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-topic-cache-size"></a><a href="#mysql-property-topic-cache-size"><code>topic.cache.size</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>10000</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The size used for holding the topic names in bounded concurrent hash map. This cache will help to determine the topic name corresponding to a given data collection.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-topic-heartbeat-prefix"></a><a href="#mysql-property-topic-heartbeat-prefix"><code>topic.heartbeat.prefix</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>__debezium-heartbeat</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Controls the name of the topic to which the connector sends heartbeat messages. The topic name has this pattern:<br>
<br>
<em>topic.heartbeat.prefix</em>.<em>topic.prefix</em><br>
<br>
For example, if the topic prefix is <code>fulfillment</code>, the default topic name is <code>__debezium-heartbeat.fulfillment</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-topic-transaction"></a><a href="#mysql-property-topic-transaction"><code>topic.transaction</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>transaction</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Controls the name of the topic to which the connector sends transaction metadata messages. The topic name has this pattern:<br>
<br>
<em>topic.prefix</em>.<em>topic.transaction</em><br>
<br>
For example, if the topic prefix is <code>fulfillment</code>, the default topic name is <code>fulfillment.transaction</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-max-threads"></a><a href="#mysql-property-snapshot-max-threads"><code>snapshot.max.threads</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies the number of threads that the connector uses when performing an initial snapshot.
To enable parallel initial snapshots, set the property to a value greater than 1.
In a parallel initial snapshot, the connector processes multiple tables concurrently.
This feature is incubating.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-snapshot-tables-order-by-row-count"></a><a href="#mysql-property-snapshot-tables-order-by-row-count"><code>snapshot.tables.order.by.row.count</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Controls the order in which the connector processes tables when it performs an initial snapshot.
Specify one of the following options:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>descending</code></dt>
<dd>
<p>The connector snapshots tables in order, based on the number of rows from the highest to the lowest.</p>
</dd>
<dt class="hdlist1"><code>ascending</code></dt>
<dd>
<p>The connector snapshots tables in order, based on the number of rows, from lowest to highest.</p>
</dd>
<dt class="hdlist1"><code>disabled</code></dt>
<dd>
<p>The connector disregards row count when performing an initial snapshot.</p>
</dd>
</dl>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-errors-max-retires"></a><a href="#mysql-property-errors-max-retires"><code>errors.max.retries</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>-1</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The maximum number of retries on retriable errors (e.g. connection errors) before failing (-1 = no limit, 0 = disabled, &gt; 0 = num of retries).</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="debezium-mysql-connector-database-history-configuration-properties"><a class="anchor" href="#debezium-mysql-connector-database-history-configuration-properties"></a>Debezium connector database schema history configuration properties</h4>
<div class="paragraph">
<p>Debezium provides a set of <code>schema.history.internal.*</code> properties that control how the connector interacts with the schema history topic.</p>
</div>
<div class="paragraph">
<p>The following table describes the <code>schema.history.internal</code> properties for configuring the Debezium connector.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. Connector database schema history configuration properties</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-kafka-topic"></a><a href="#mysql-property-database-history-kafka-topic"><code>schema.history.internal.kafka.topic</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The full name of the Kafka topic where the connector stores the database schema history.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-kafka-bootstrap-servers"></a><a href="#mysql-property-database-history-kafka-bootstrap-servers"><code>schema.history.internal.kafka.bootstrap.servers</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A list of host/port pairs that the connector uses for establishing an initial connection to the Kafka cluster. This connection is used for retrieving the database schema history previously stored by the connector, and for writing each DDL statement read from the source database. Each pair should point to the same Kafka cluster used by the Kafka Connect process.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-kafka-recovery-poll-interval-ms"></a><a href="#mysql-property-database-history-kafka-recovery-poll-interval-ms"><code>schema.history.internal.kafka.recovery.poll.interval.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>100</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An integer value that specifies the maximum number of milliseconds the connector should wait during startup/recovery while polling for persisted data. The default is 100ms.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-kafka-query-timeout-ms"></a><a href="#mysql-property-database-history-kafka-query-timeout-ms"><code>schema.history.internal.kafka.query.timeout.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>3000</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An integer value that specifies the maximum number of milliseconds the connector should wait while fetching cluster information using Kafka admin client.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-kafka-create-timeout-ms"></a><a href="#mysql-property-database-history-kafka-create-timeout-ms"><code>schema.history.internal.kafka.create.timeout.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>30000</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An integer value that specifies the maximum number of milliseconds the connector should wait while create kafka history topic using Kafka admin client.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-kafka-recovery-attempts"></a><a href="#mysql-property-database-history-kafka-recovery-attempts"><code>schema.history.internal.kafka.recovery.attempts</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>100</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The maximum number of times that the connector should try to read persisted history data before the connector recovery fails with an error. The maximum amount of time to wait after receiving no data is <code>recovery.attempts</code> × <code>recovery.poll.interval.ms</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-skip-unparseable-ddl"></a><a href="#mysql-property-database-history-skip-unparseable-ddl"><code>schema.history.internal.skip.unparseable.ddl</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A Boolean value that specifies whether the connector should ignore malformed or unknown database statements or stop processing so a human can fix the issue.
The safe default is <code>false</code>.
Skipping should be used only with care as it can lead to data loss or mangling when the binlog is being processed.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-store-only-captured-tables-ddl"></a><a href="#mysql-property-database-history-store-only-captured-tables-ddl"><code>schema.history.internal.store.only.captured.tables.ddl</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A Boolean value that specifies whether the connector records schema structures from all tables in a schema or database, or only from tables that are designated for capture.<br>
Specify one of the following values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>false</code> (default)</dt>
<dd>
<p>During a database snapshot, the connector records the schema data for all non-system tables in the database, including tables that are not designated for capture.
It&#8217;s best to retain the default setting.
If you later decide to capture changes from tables that you did not originally designate for capture, the connector can easily begin to capture data from those tables, because their schema structure is already stored in the schema history topic.
Debezium requires the schema history of a table so that it can identify the structure that was present at the time that a change event occurred.</p>
</dd>
<dt class="hdlist1"><code>true</code></dt>
<dd>
<p>During a database snapshot, the connector records the table schemas only for the tables from which Debezium captures change events.
If you change the default value, and you later configure the connector to capture data from other tables in the database, the connector lacks the schema information that it requires to capture change events from the tables.<br></p>
</dd>
</dl>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-database-history-store-only-captured-databases-ddl"></a><a href="#mysql-property-database-history-store-only-captured-databases-ddl"><code>schema.history.internal.store.only.captured.databases.ddl</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>false</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A Boolean value that specifies whether the connector records schema structures from all logical databases in the database instance.<br>
Specify one of the following values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>true</code></dt>
<dd>
<p>The connector records schema structures only for tables in the logical database and schema from which Debezium captures change events.</p>
</dd>
<dt class="hdlist1"><code>false</code></dt>
<dd>
<p>The connector records schema structures for all logical databases.<br></p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The default value is <code>true</code> for MySQL Connector<br>
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<div id="mysql-pass-through-database-history-properties-for-configuring-producer-and-consumer-clients" class="paragraph">
<div class="title">Pass-through database schema history properties for configuring producer and consumer clients</div>
<p><br>
Debezium relies on a Kafka producer to write schema changes to database schema history topics.
Similarly, it relies on a Kafka consumer to read from database schema history topics when a connector starts.
You define the configuration for the Kafka producer and consumer clients by assigning values to a set of pass-through configuration properties that begin with the <code>schema.history.internal.producer.*</code> and <code>schema.history.internal.consumer.*</code> prefixes.
The pass-through producer and consumer database schema history properties control a range of behaviors, such as how these clients secure connections with the Kafka broker, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">schema.history.internal.producer.security.protocol=SSL
schema.history.internal.producer.ssl.keystore.location=/var/private/ssl/kafka.server.keystore.jks
schema.history.internal.producer.ssl.keystore.password=test1234
schema.history.internal.producer.ssl.truststore.location=/var/private/ssl/kafka.server.truststore.jks
schema.history.internal.producer.ssl.truststore.password=test1234
schema.history.internal.producer.ssl.key.password=test1234

schema.history.internal.consumer.security.protocol=SSL
schema.history.internal.consumer.ssl.keystore.location=/var/private/ssl/kafka.server.keystore.jks
schema.history.internal.consumer.ssl.keystore.password=test1234
schema.history.internal.consumer.ssl.truststore.location=/var/private/ssl/kafka.server.truststore.jks
schema.history.internal.consumer.ssl.truststore.password=test1234
schema.history.internal.consumer.ssl.key.password=test1234</code></pre>
</div>
</div>
<div class="paragraph">
<p>Debezium strips the prefix from the property name before it passes the property to the Kafka client.</p>
</div>
<div class="paragraph">
<p>See the Kafka documentation for more details about <a href="https://kafka.apache.org/documentation.html#producerconfigs">Kafka producer configuration properties</a> and <a href="https://kafka.apache.org/documentation.html#consumerconfigs">Kafka consumer configuration properties</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="debezium-mysql-connector-kafka-signals-configuration-properties"><a class="anchor" href="#debezium-mysql-connector-kafka-signals-configuration-properties"></a>Debezium connector Kafka signals configuration properties</h4>
<div class="paragraph">
<p>Debezium provides a set of <code>signal.*</code> properties that control how the connector interacts with the Kafka signals topic.</p>
</div>
<div class="paragraph">
<p>The following table describes the Kafka <code>signal</code> properties.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. Kafka signals configuration properties</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-signal-kafka-topic"></a><a href="#mysql-property-signal-kafka-topic"><code>signal.kafka.topic</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&lt;topic.prefix&gt;-signal</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The name of the Kafka topic that the connector monitors for ad hoc signals.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If <a href="../configuration/topic-auto-create-config.html#topic-auto-create-config" class="xref page">automatic topic creation</a> is disabled, you must manually create the required signaling topic.
A signaling topic is required to preserve signal ordering.
The signaling topic must have a single partition.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-signal-kafka-groupId"></a><a href="#mysql-property-signal-kafka-groupId"><code>signal.kafka.groupId</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>kafka-signal</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The name of the group ID  that is used by Kafka consumers.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-signal-kafka-bootstrap-servers"></a><a href="#mysql-property-signal-kafka-bootstrap-servers"><code>signal.kafka.bootstrap.servers</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A list of host/port pairs that the connector uses for establishing an initial connection to the Kafka cluster.
Each pair references the Kafka cluster that is used by the Debezium Kafka Connect process.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-signal-kafka-poll-timeout-ms"></a><a href="#mysql-property-signal-kafka-poll-timeout-ms"><code>signal.kafka.poll.timeout.ms</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>100</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An integer value that specifies the maximum number of milliseconds that the connector waits when polling signals.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="debezium-mysql-connector-pass-through-signals-kafka-consumer-configuration-properties"><a class="anchor" href="#debezium-mysql-connector-pass-through-signals-kafka-consumer-configuration-properties"></a>Debezium connector pass-through signals Kafka consumer client configuration properties</h4>
<div class="paragraph">
<p>The Debezium connector provides for pass-through configuration of the signals Kafka consumer.
Pass-through signals properties begin with the prefix <code>signals.consumer.*</code>.
For example, the connector passes properties such as <code>signal.consumer.security.protocol=SSL</code> to the Kafka consumer.</p>
</div>
<div class="paragraph">
<p>Debezium strips the prefixes from the properties before it passes the properties to the Kafka signals consumer.</p>
</div>
</div>
<div class="sect3">
<h4 id="debezium-mysql-connector-kafka-notifications-configuration-properties"><a class="anchor" href="#debezium-mysql-connector-kafka-notifications-configuration-properties"></a>Debezium connector sink notifications configuration properties</h4>
<div class="paragraph">
<p>The following table describes the <code>notification</code> properties.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. Sink notification configuration properties</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="mysql-property-notification-sink-topic-name"></a><a href="#mysql-property-notification-sink-topic-name"><code>notification.sink.topic.name</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>No default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The name of the topic that receives notifications from Debezium.
This property is required when you configure the <a href="#mysql-property-notification-enabled-channels"><code>notification.enabled.channels</code></a> property to include <code>sink</code> as one of the enabled notification channels.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="debezium-mysql-connector-pass-through-database-driver-configuration-properties"><a class="anchor" href="#debezium-mysql-connector-pass-through-database-driver-configuration-properties"></a>Debezium connector pass-through database driver configuration properties</h4>
<div class="paragraph">
<p>The Debezium connector provides for pass-through configuration of the database driver.
Pass-through database properties begin with the prefix <code>driver.*</code>.
For example, the connector passes properties such as <code>driver.foobar=false</code> to the JDBC URL.</p>
</div>
<div class="paragraph">
<p>As is the case with the <a href="#mysql-pass-through-database-history-properties-for-configuring-producer-and-consumer-clients">pass-through properties for database schema history clients</a>, Debezium strips the prefixes from the properties before it passes them to the database driver.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mysql-monitoring"><a class="anchor" href="#mysql-monitoring"></a>Monitoring</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Debezium MySQL connector provides three types of metrics that are in addition to the built-in support for JMX metrics that Zookeeper, Kafka, and Kafka Connect provide.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#mysql-snapshot-metrics">Snapshot metrics</a> provide information about connector operation while performing a snapshot.</p>
</li>
<li>
<p><a href="#mysql-streaming-metrics">Streaming metrics</a> provide information about connector operation when the connector is reading the binlog.</p>
</li>
<li>
<p><a href="#mysql-schema-history-metrics">Schema history metrics</a> provide information about the status of the connector&#8217;s schema history.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="../operations/monitoring.html#monitoring-debezium" class="xref page">Debezium monitoring documentation</a> provides details for how to expose these metrics by using JMX.</p>
</div>
<div class="sect2">
<h3 id="mysql-snapshot-metrics"><a class="anchor" href="#mysql-snapshot-metrics"></a>Snapshot metrics</h3>
<div class="paragraph">
<p>The <strong>MBean</strong> is <code>debezium.mysql:type=connector-metrics,context=snapshot,server=<em>&lt;topic.prefix&gt;</em></code>.</p>
</div>
<div class="paragraph">
<p>Snapshot metrics are not exposed unless a snapshot operation is active, or if a snapshot has occurred since the last connector start.</p>
</div>
<div class="paragraph">
<p>The following table lists the shapshot metrics that are available.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 45%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attributes</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-lastevent_mysql"></a><a href="#connectors-snaps-metric-lastevent_mysql"><code>LastEvent</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The last snapshot event that the connector has read.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-millisecondssincelastevent_mysql"></a><a href="#connectors-snaps-metric-millisecondssincelastevent_mysql"><code>MilliSecondsSinceLastEvent</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds since the connector has read and processed the most recent event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-totalnumberofeventsseen_mysql"></a><a href="#connectors-snaps-metric-totalnumberofeventsseen_mysql"><code>TotalNumberOfEventsSeen</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of events that this connector has seen since last started or reset.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-numberofeventsfiltered_mysql"></a><a href="#connectors-snaps-metric-numberofeventsfiltered_mysql"><code>NumberOfEventsFiltered</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of events that have been filtered by include/exclude list filtering rules configured on the connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-capturedtables_mysql"></a><a href="#connectors-snaps-metric-capturedtables_mysql"><code>CapturedTables</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string[]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The list of tables that are captured by the connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-queuetotalcapacity_mysql"></a><a href="#connectors-snaps-metric-queuetotalcapacity_mysql"><code>QueueTotalCapacity</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The length the queue used to pass events between the snapshotter and the main Kafka Connect loop.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-queueremainingcapacity_mysql"></a><a href="#connectors-snaps-metric-queueremainingcapacity_mysql"><code>QueueRemainingCapacity</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The free capacity of the queue used to pass events between the snapshotter and the main Kafka Connect loop.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-totaltablecount_mysql"></a><a href="#connectors-snaps-metric-totaltablecount_mysql"><code>TotalTableCount</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of tables that are being included in the snapshot.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-remainingtablecount_mysql"></a><a href="#connectors-snaps-metric-remainingtablecount_mysql"><code>RemainingTableCount</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of tables that the snapshot has yet to copy.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotrunning_mysql"></a><a href="#connectors-snaps-metric-snapshotrunning_mysql"><code>SnapshotRunning</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether the snapshot was started.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotpaused_mysql"></a><a href="#connectors-snaps-metric-snapshotpaused_mysql"><code>SnapshotPaused</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether the snapshot was paused.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotaborted_mysql"></a><a href="#connectors-snaps-metric-snapshotaborted_mysql"><code>SnapshotAborted</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether the snapshot was aborted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotcompleted_mysql"></a><a href="#connectors-snaps-metric-snapshotcompleted_mysql"><code>SnapshotCompleted</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether the snapshot completed.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotdurationinseconds_mysql"></a><a href="#connectors-snaps-metric-snapshotdurationinseconds_mysql"><code>SnapshotDurationInSeconds</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of seconds that the snapshot has taken so far, even if not complete. Includes also time when snapshot was paused.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-snapshotpauseddurationinseconds_mysql"></a><a href="#connectors-snaps-metric-snapshotpauseddurationinseconds_mysql"><code>SnapshotPausedDurationInSeconds</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of seconds that the snapshot was paused. If the snapshot was paused several times, the paused time adds up.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-rowsscanned_mysql"></a><a href="#connectors-snaps-metric-rowsscanned_mysql"><code>RowsScanned</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Map&lt;String, Long&gt;</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Map containing the number of rows scanned for each table in the snapshot.
Tables are incrementally added to the Map during processing.
Updates every 10,000 rows scanned and upon completing a table.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-maxqueuesizeinbytes_mysql"></a><a href="#connectors-snaps-metric-maxqueuesizeinbytes_mysql"><code>MaxQueueSizeInBytes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The maximum buffer of the queue in bytes. This metric is available if <a href="#mysql-property-max-queue-size-in-bytes"><code>max.queue.size.in.bytes</code></a> is set to a positive long value.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-snaps-metric-currentqueuesizeinbytes_mysql"></a><a href="#connectors-snaps-metric-currentqueuesizeinbytes_mysql"><code>CurrentQueueSizeInBytes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The current volume, in bytes, of records in the queue.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The connector also provides the following additional snapshot metrics when an incremental snapshot is executed:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 45%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attributes</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-insnap-metric-chunkid_mysql"></a><a href="#connectors-insnap-metric-chunkid_mysql"><code>ChunkId</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The identifier of the current snapshot chunk.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-insnap-metric-chunkfrom_mysql"></a><a href="#connectors-insnap-metric-chunkfrom_mysql"><code>ChunkFrom</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The lower bound of the primary key set defining the current chunk.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-insnap-metric-chunkto_mysql"></a><a href="#connectors-insnap-metric-chunkto_mysql"><code>ChunkTo</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The upper bound of the primary key set defining the current chunk.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-insnap-metric-tablefrom_mysql"></a><a href="#connectors-insnap-metric-tablefrom_mysql"><code>TableFrom</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The lower bound of the primary key set of the currently snapshotted table.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-insnap-metric-tableto_mysql"></a><a href="#connectors-insnap-metric-tableto_mysql"><code>TableTo</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The upper bound of the primary key set of the currently snapshotted table.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Debezium MySQL connector also provides the <code>HoldingGlobalLock</code> custom snapshot metric. This metric is set to a Boolean value that indicates whether the connector currently holds a global or table write lock.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-streaming-metrics"><a class="anchor" href="#mysql-streaming-metrics"></a>Streaming metrics</h3>
<div class="paragraph">
<p>Transaction-related attributes are available only if binlog event buffering is enabled.
See <a href="#mysql-property-binlog-buffer-size"><code>binlog.buffer.size</code></a> in the advanced connector configuration properties for more details.
:leveloffset: +1</p>
</div>
<div class="paragraph">
<p>The <strong>MBean</strong> is <code>debezium.mysql:type=connector-metrics,context=streaming,server=<em>&lt;topic.prefix&gt;</em></code>.</p>
</div>
<div class="paragraph">
<p>The following table lists the streaming metrics that are available.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 45%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attributes</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-lastevent_mysql"></a><a href="#connectors-strm-metric-lastevent_mysql"><code>LastEvent</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The last streaming event that the connector has read.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-millisecondssincelastevent_mysql"></a><a href="#connectors-strm-metric-millisecondssincelastevent_mysql"><code>MilliSecondsSinceLastEvent</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds since the connector has read and processed the most recent event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-totalnumberofeventsseen_mysql"></a><a href="#connectors-strm-metric-totalnumberofeventsseen_mysql"><code>TotalNumberOfEventsSeen</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of events that this connector has seen since the last start or metrics reset.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-totalnumberofcreateeventsseen_mysql"></a><a href="#connectors-strm-metric-totalnumberofcreateeventsseen_mysql"><code>TotalNumberOfCreateEventsSeen</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of create events that this connector has seen since the last start or metrics reset.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-totalnumberofupdateeventsseen_mysql"></a><a href="#connectors-strm-metric-totalnumberofupdateeventsseen_mysql"><code>TotalNumberOfUpdateEventsSeen</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of update events that this connector has seen since the last start or metrics reset.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-totalnumberofdeleteeventsseen_mysql"></a><a href="#connectors-strm-metric-totalnumberofdeleteeventsseen_mysql"><code>TotalNumberOfDeleteEventsSeen</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The total number of delete events that this connector has seen since the last start or metrics reset.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-numberofeventsfiltered_mysql"></a><a href="#connectors-strm-metric-numberofeventsfiltered_mysql"><code>NumberOfEventsFiltered</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of events that have been filtered by include/exclude list filtering rules configured on the connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-capturedtables_mysql"></a><a href="#connectors-strm-metric-capturedtables_mysql"><code>CapturedTables</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string[]</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The list of tables that are captured by the connector.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-queuetotalcapacity_mysql"></a><a href="#connectors-strm-metric-queuetotalcapacity_mysql"><code>QueueTotalCapacity</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The length the queue used to pass events between the streamer and the main Kafka Connect loop.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-queueremainingcapacity_mysql"></a><a href="#connectors-strm-metric-queueremainingcapacity_mysql"><code>QueueRemainingCapacity</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>int</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The free capacity of the queue used to pass events between the streamer and the main Kafka Connect loop.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-connected_mysql"></a><a href="#connectors-strm-metric-connected_mysql"><code>Connected</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>boolean</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Flag that denotes whether the connector is currently connected to the database server.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-millisecondsbehindsource_mysql"></a><a href="#connectors-strm-metric-millisecondsbehindsource_mysql"><code>MilliSecondsBehindSource</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds between the last change event&#8217;s timestamp and the connector processing it.
The values will incoporate any differences between the clocks on the machines where the database server and the connector are running.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-numberofcommittedtransactions_mysql"></a><a href="#connectors-strm-metric-numberofcommittedtransactions_mysql"><code>NumberOfCommittedTransactions</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of processed transactions that were committed.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-sourceeventposition_mysql"></a><a href="#connectors-strm-metric-sourceeventposition_mysql"><code>SourceEventPosition</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>Map&lt;String, String&gt;</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The coordinates of the last received event.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-lasttransactionid_mysql"></a><a href="#connectors-strm-metric-lasttransactionid_mysql"><code>LastTransactionId</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Transaction identifier of the last processed transaction.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-maxqueuesizeinbytes_mysql"></a><a href="#connectors-strm-metric-maxqueuesizeinbytes_mysql"><code>MaxQueueSizeInBytes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The maximum buffer of the queue in bytes. This metric is available if <a href="#mysql-property-max-queue-size-in-bytes"><code>max.queue.size.in.bytes</code></a> is set to a positive long value.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-strm-metric-currentqueuesizeinbytes_mysql"></a><a href="#connectors-strm-metric-currentqueuesizeinbytes_mysql"><code>CurrentQueueSizeInBytes</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The current volume, in bytes, of records in the queue.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Debezium MySQL connector also provides the following additional streaming metrics:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. Descriptions of additional streaming metrics</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="binlog-filename"></a><a href="#binlog-filename"><code>BinlogFilename</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the binlog file that the connector has most recently read.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="binlog-position"></a><a href="#binlog-position"><code>BinlogPosition</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The most recent position (in bytes) within the binlog that the connector has read.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="is-gtid-mode-enabled"></a><a href="#is-gtid-mode-enabled"><code>IsGtidModeEnabled</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flag that denotes whether the connector is currently tracking GTIDs from MySQL server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="gtid-set"></a><a href="#gtid-set"><code>GtidSet</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The string representation of the most recent GTID set processed by the connector when reading the binlog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="number-of-skipped-events"></a><a href="#number-of-skipped-events"><code>NumberOfSkippedEvents</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of events that have been skipped by the MySQL connector. Typically events are skipped due to a malformed or unparseable event from MySQL&#8217;s binlog.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="number-of-disconnects"></a><a href="#number-of-disconnects"><code>NumberOfDisconnects</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of disconnects by the MySQL connector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="number-of-rolled-back-transactions"></a><a href="#number-of-rolled-back-transactions"><code>NumberOfRolledBackTransactions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of processed transactions that were rolled back and not streamed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="number-of-not-well-formed-transactions"></a><a href="#number-of-not-well-formed-transactions"><code>NumberOfNotWellFormedTransactions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of transactions that have not conformed to the expected protocol of <code>BEGIN</code> + <code>COMMIT</code>/<code>ROLLBACK</code>. This value should be <code>0</code> under normal conditions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="number-of-large-transactions"></a><a href="#number-of-large-transactions"><code>NumberOfLargeTransactions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of transactions that have not fit into the look-ahead buffer. For optimal performance, this value should be significantly smaller than <code>NumberOfCommittedTransactions</code> and <code>NumberOfRolledBackTransactions</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="mysql-schema-history-metrics"><a class="anchor" href="#mysql-schema-history-metrics"></a>Schema history metrics</h3>
<div class="paragraph">
<p>The <strong>MBean</strong> is <code>debezium.mysql:type=connector-metrics,context=schema-history,server=<em>&lt;topic.prefix&gt;</em></code>.</p>
</div>
<div class="paragraph">
<p>The following table lists the schema history metrics that are available.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 45%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attributes</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-status_mysql"></a><a href="#connectors-shist-metric-status_mysql"><code>Status</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>One of <code>STOPPED</code>, <code>RECOVERING</code> (recovering history from the storage), <code>RUNNING</code> describing the state of the database schema history.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-recoverystarttime_mysql"></a><a href="#connectors-shist-metric-recoverystarttime_mysql"><code>RecoveryStartTime</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The time in epoch seconds at what recovery has started.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-changesrecovered_mysql"></a><a href="#connectors-shist-metric-changesrecovered_mysql"><code>ChangesRecovered</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of changes that were read during recovery phase.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-changesapplied_mysql"></a><a href="#connectors-shist-metric-changesapplied_mysql"><code>ChangesApplied</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the total number of schema changes applied during recovery and runtime.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-millisecondssincelastrecoveredchange_mysql"></a><a href="#connectors-shist-metric-millisecondssincelastrecoveredchange_mysql"><code>MilliSecondsSinceLast&#8203;RecoveredChange</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds that elapsed since the last change was recovered from the history store.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-millisecondssincelastappliedchange_mysql"></a><a href="#connectors-shist-metric-millisecondssincelastappliedchange_mysql"><code>MilliSecondsSinceLast&#8203;AppliedChange</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>long</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of milliseconds that elapsed since the last change was applied.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-lastrecoveredchange_mysql"></a><a href="#connectors-shist-metric-lastrecoveredchange_mysql"><code>LastRecoveredChange</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The string representation of the last change recovered from the history store.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="connectors-shist-metric-lastappliedchange_mysql"></a><a href="#connectors-shist-metric-lastappliedchange_mysql"><code>LastAppliedChange</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>string</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The string representation of the last applied change.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mysql-when-things-go-wrong"><a class="anchor" href="#mysql-when-things-go-wrong"></a>Behavior when things go wrong</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Debezium is a distributed system that captures all changes in multiple upstream databases; it never misses or loses an event. When the system is operating normally or being managed carefully then Debezium provides <em>exactly once</em> delivery of every change event record.</p>
</div>
<div class="paragraph">
<p>If a fault does happen then the system does not lose any events. However, while it is recovering from the fault, it might repeat some change events. In these abnormal situations, Debezium, like Kafka, provides <em>at least once</em> delivery of change events.</p>
</div>
<div class="paragraph">
<p>The rest of this section describes how Debezium handles various kinds of faults and problems.</p>
</div>
<div class="sect2">
<h3 id="debezium-mysql-connector-configuration-and-startup-errors"><a class="anchor" href="#debezium-mysql-connector-configuration-and-startup-errors"></a>Configuration and startup errors</h3>
<div class="paragraph">
<p>In the following situations, the connector fails when trying to start, reports an error or exception in the log, and stops running:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The connector&#8217;s configuration is invalid.</p>
</li>
<li>
<p>The connector cannot successfully connect to the MySQL server by using the specified connection parameters.</p>
</li>
<li>
<p>The connector is attempting to restart at a position in the binlog for which MySQL no longer has the history available.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In these cases, the error message has details about the problem and possibly a suggested workaround. After you correct the configuration or address the MySQL problem, restart the connector.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-becomes-unavailable-while-debezium-is-running"><a class="anchor" href="#mysql-becomes-unavailable-while-debezium-is-running"></a>MySQL becomes unavailable</h3>
<div class="paragraph">
<p>If your MySQL server becomes unavailable, the Debezium MySQL connector fails with an error and the connector stops. When the server is available again, restart the connector.</p>
</div>
<div class="paragraph">
<p>However, if GTIDs are enabled for a highly available MySQL cluster, you can restart the connector immediately. It will connect to a different MySQL server in the cluster, find the location in the server&#8217;s binlog that represents the last transaction, and begin reading the new server&#8217;s binlog from that specific location.</p>
</div>
<div class="paragraph">
<p>If GTIDs are not enabled, the connector records the binlog position of only the MySQL server to which it was connected. To restart from the correct binlog position, you must reconnect to that specific server.</p>
</div>
</div>
<div class="sect2">
<h3 id="debezium-mysql-kafka-connect-process-stops-gracefully"><a class="anchor" href="#debezium-mysql-kafka-connect-process-stops-gracefully"></a>Kafka Connect stops gracefully</h3>
<div class="paragraph">
<p>When Kafka Connect stops gracefully, there is a short delay while the Debezium MySQL connector tasks are stopped and restarted on new Kafka Connect processes.</p>
</div>
</div>
<div class="sect2">
<h3 id="debezium-mysql-kafka-connect-process-crashes"><a class="anchor" href="#debezium-mysql-kafka-connect-process-crashes"></a>Kafka Connect process crashes</h3>
<div class="paragraph">
<p>If Kafka Connect crashes, the process stops and any Debezium MySQL connector tasks terminate without their most recently-processed offsets being recorded. In distributed mode, Kafka Connect restarts the connector tasks on other processes. However, the MySQL connector resumes from the last offset recorded by the earlier processes. This means that the replacement tasks might generate some of the same events processed prior to the crash, creating duplicate events.</p>
</div>
<div class="paragraph">
<p>Each change event message includes source-specific information that you can use to identify duplicate events, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Event origin</p>
</li>
<li>
<p>MySQL server&#8217;s event time</p>
</li>
<li>
<p>The binlog file name and position</p>
</li>
<li>
<p>GTIDs (if used)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="debezium-mysql-kafka-process-becomes-unavailable"><a class="anchor" href="#debezium-mysql-kafka-process-becomes-unavailable"></a>Kafka becomes unavailable</h3>
<div class="paragraph">
<p>The Kafka Connect framework records Debezium change events in Kafka by using the Kafka producer API. If the Kafka brokers become unavailable, the Debezium MySQL connector pauses until the connection is reestablished and the connector resumes where it left off.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-purges-binlog-files-used-by-debezium"><a class="anchor" href="#mysql-purges-binlog-files-used-by-debezium"></a>MySQL purges binlog files</h3>
<div class="paragraph">
<p>If the Debezium MySQL connector stops for too long, the MySQL server purges older binlog files and the connector&#8217;s last position may be lost. When the connector is restarted, the MySQL server no longer has the starting point and the connector performs another initial snapshot. If the snapshot is disabled, the connector fails with an error.</p>
</div>
<div class="paragraph">
<p>See <a href="#mysql-snapshots">snapshots</a> for details about how MySQL connectors perform initial snapshots.</p>
</div>
</div>
</div>
</div>
</article>
</div>
<div class="article-cell2">
</div>
</div>

<div id="toc-rightbar"></div>    <footer class="footer">
        <div class="wrapper">
            <div class="copyright">Copyright &copy; 2024 Debezium Community (Rev: <span class="truncated"><a href="https://github.com/debezium/debezium/commit/d3e41527da9750afb246651f8bda5c909bbbaa40">d3e41527</a></span>)
            
        </div>
    </footer>
</main></div>
<script>
    /* Make sure TOC carets are expanded if sub-elements exist */
    $("#toc").each(function(i,v) {
      $(this).closest('article').addClass('with-toc');
    });

    $("#toc ul.sectlevel1 > li").each(function(i,v) {
      $(this).has("ul").addClass("expanded");
    });

    $(function() {
        /* Expands all the documentation submenus */
        $(".nav-list > .nav-item:not(.is-active) .nav-item-toggle").click();
    });

    /**
     * This checks if a "#toc" element exists in the DOM and if so:
     *
     *  1. Appends a cloned copy of the #toc node to the #toc-rightbar div.
     *  2. Forces the #toc-rightbar div to be visible.
     *  3. Adds the .toc-right class to the #article-wrapper div to restrict the article's overall width.
     */
    var $toc = $("#toc");
    if ( $toc.length ) {
        $("#toc-rightbar").append($toc.clone());
        $("body .main").addClass("with-toc");
    }

    /**
     * In order to make CSS changes that are backward compatible with old adoc files, this applies a version
     * style to the body tag so we can use it to differentiate between CSS styles per version if needed,
     * such as tfoot rows.
     */
    var $version = $("body .nav-container").data("version");
    var $versionClass = "version-" + $version;
    $versionClass = $versionClass.replace('.','-');
    $("body").addClass($versionClass);

    /** A CSS trick to wrap long-width tables in a div that can be scrolled on smaller screens */
    $("table.tableblock").wrap("<div class='table-scroll-wrapper'></div>");

    $(function() {
        /* apply floating scrollbar to the scroll-wrapper */
        $(".table-scroll-wrapper").floatingScrollbar();
    });

</script>
<script src="../../../debezium-antora/js/site.js"></script>
<script async src="../../../debezium-antora/js/vendor/highlight.js"></script>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-10656779-1");
    pageTracker._trackPageview();
  } catch(err) {}
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76464546-1', 'auto');
  ga('send', 'pageview');
  ga('set', 'anonymizeIp', true);
  ga('require', 'linkid', 'linkid.js');
</script>
</body>
</html>