<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Exporting CloudEvents :: Debezium Documentation</title>
    <link rel="canonical" href="https://debezium.io/documentation/reference/stable/integrations/cloudevents.html">
    <meta name="generator" content="Antora 3.1.7">
<link rel="stylesheet" href="../../debezium-antora/css/site.css">
<link rel="stylesheet" href="../../debezium-antora/css/debezium-antora.css">
<link rel="stylesheet" href="../../debezium-antora/css/highlightjs-dark.css">
<link rel="stylesheet" href="https://static.jboss.org/css/rhbar.css">
<script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.js"></script>
<script src="../../debezium-antora/js/jquery.ba-floatingscrollbar.js"></script>
</head>
<body class="article">
<header class="header">
  <div id="rhbar">
      <a class="jbdevlogo" href="https://developers.redhat.com"></a>
      <a class="rhlogo" href="https://www.redhat.com"></a>
  </div>
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
          <img src="/assets/images/color_white_debezium_type_600px.svg" style="height: 32px; margin-right: 14px;"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/documentation/faq">FAQ</a>
        <a class="navbar-item" href="/documentation">DOCUMENTATION</a>
        <a class="navbar-item" href="/releases">RELEASES</a>
        <a class="navbar-item" href="/community">COMMUNITY</a>
        <a class="navbar-item" href="/blog">BLOG</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="reference" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Debezium nightly Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorial.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../postgres-plugins.html">PostgreSQL Decoding Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../features.html">Features</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/avro.html">Avro Serialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/topic-auto-create-config.html">Customizing Topic Auto-Creation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/signalling.html">Sending Signals to Debezium</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuration/notification.html">Receive notifications from Debezium</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Connectors</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/mysql.html">MySQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/mongodb.html">MongoDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/postgresql.html">PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/oracle.html">Oracle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/sqlserver.html">SQL Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/db2.html">Db2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/cassandra.html">Cassandra</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/vitess.html">Vitess</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/spanner.html">Spanner</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/jdbc.html">JDBC</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/informix.html">Informix</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Transformations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/topic-routing.html">Topic Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/event-flattening.html">New Record State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/mongodb-event-flattening.html">MongoDB New Document State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/event-changes.html">Event Changes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/outbox-event-router.html">Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/mongodb-outbox-event-router.html">MongoDB Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/filtering.html">Message Filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/schema-change-event-filter.html">Schema Change Event Filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/content-based-routing.html">Content-Based Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/applying-transformations-selectively.html">Using SMT Predicates to Selectively Apply Transformations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/partition-routing.html">Partition Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/header-to-value.html">HeaderToValue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/timezone-converter.html">Timezone Converter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/timescaledb.html">TimescaleDB Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/convert-cloudevent-to-saveable-form.html">Convert CloudEvents to Saveable Form</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Post Processors</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../post-processors/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../post-processors/reselect-columns.html">Reselect Columns</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">API and SPI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/engine.html">Debezium Engine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/converters.html">Custom Converters</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="serdes.html">Change Event SerDes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="outbox.html">Outbox Quarkus Extension</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="cloudevents.html">CloudEvents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tracing.html">OpenTelemetry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="testcontainers.html">Integration Testing with Testcontainers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Operations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-server.html">Debezium Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/kubernetes.html">Running on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/openshift.html">Running on Openshift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-ui.html">Debezium UI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Debezium Documentation</span>
    <span class="version">nightly</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Debezium Documentation</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="/documentation/reference/nightly/index.html">nightly</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.6/index.html">2.6</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.5/index.html">2.5</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.4/index.html">2.4</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.3/index.html">2.3</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.1/index.html">2.1</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.0/index.html">2.0</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/1.9/index.html">1.9</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/1.8/index.html">1.8</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/1.7/index.html">1.7</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main" class="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../stable/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Debezium Documentation</a></li>
    <li>Integrations</li>
    <li><a href="cloudevents.html">CloudEvents</a></li>
  </ul>
</nav>
    <div class="page-versions-container">
    Version:
    <div class="page-versions">
        <button class="version-menu-toggle versions-menu-current" title="Show other versions of page">nightly</button>
        <div class="version-menu">
                <a class="version is-current" href="/documentation/reference/nightly/index.html">nightly</a>
                <a class="version" href="/documentation/reference/2.6/index.html">2.6</a>
                <a class="version" href="/documentation/reference/2.5/index.html">2.5</a>
                <a class="version" href="/documentation/reference/2.4/index.html">2.4</a>
                <a class="version" href="/documentation/reference/2.3/index.html">2.3</a>
                <a class="version" href="/documentation/reference/2.2/index.html">2.2</a>
                <a class="version" href="/documentation/reference/2.1/index.html">2.1</a>
                <a class="version" href="/documentation/reference/2.0/index.html">2.0</a>
                <a class="version" href="/documentation/reference/1.9/index.html">1.9</a>
                <a class="version" href="/documentation/reference/1.8/index.html">1.8</a>
                <a class="version" href="/documentation/reference/1.7/index.html">1.7</a>
        </div>
        |
    </div>
    </div>
  <div class="edit-this-page"><a href="https://github.com/debezium/debezium/edit/main/documentation/modules/ROOT/pages/integrations/cloudevents.adoc">Edit this Page</a></div>
  </div>
<div class="article-grid">
<div class="article-cell1">
<article class="doc">
        
    <div class="version-banner version-banner-development">
    You are viewing documentation for an unreleased version of Debezium.
    <br/>
            If you want to view the latest stable version of this page, please go <a href=/documentation/reference/stable/index.html>here</a>.
            
</div>            <h1 class="page">Exporting CloudEvents</h1>
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_example_event_format">Example event format</a></li>
<li><a href="#_example_configuration">Example configuration</a></li>
<li><a href="#configuration-of-sources-of-metadata-and-some-cloudevents-fields">Configuration of sources of metadata and some CloudEvents fields</a>
<ul class="sectlevel2">
<li><a href="#_obtaining_record_metadata">Obtaining record metadata</a></li>
<li><a href="#_obtaining_cloudevent_metadata">Obtaining CloudEvent metadata</a></li>
</ul>
</li>
<li><a href="#cloud-events-converter-configuration-options">Configuration options</a></li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://cloudevents.io/">CloudEvents</a> is a specification for describing event data in a common way.
Its aim is to provide interoperability across services, platforms and systems.
Debezium enables you to configure a Db2,
Informix,
MongoDB, MySQL, Oracle, PostgreSQL, or SQL Server connector to emit change event records that conform to the CloudEvents specification.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Support for CloudEvents is in an incubating state. This means that exact semantics, configuration options, and other details may change in future revisions based on feedback.
Please let us know your specific requirements or if you encounter any problems while using this feature.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The CloudEvents specification defines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A set of standardized event attributes</p>
</li>
<li>
<p>Rules for defining custom attributes</p>
</li>
<li>
<p>Encoding rules for mapping event formats to serialized representations such as JSON or Apache Avro</p>
</li>
<li>
<p>Protocol bindings for transport layers such as Apache Kafka, HTTP or AMQP</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure a Debezium connector to emit change event records that conform to the CloudEvents specification, Debezium provides the <code>io.debezium.converters.CloudEventsConverter</code>, which is a Kafka Connect message converter.</p>
</div>
<div class="paragraph">
<p>Currently, only structured mapping mode can be used.
The CloudEvents change event envelope can be JSON or Avro, and you can use JSON or Avro as the <code>data</code> format for each envelope type.
It is expected that a future Debezium release will support binary mapping mode.</p>
</div>
<div class="paragraph">
<p>For information about using Avro, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../configuration/avro.html#avro-serialization" class="xref page">Avro serialization</a></p>
</li>
<li>
<p><a href="https://github.com/Apicurio/apicurio-registry">Apicurio Registry</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_event_format"><a class="anchor" href="#_example_event_format"></a>Example event format</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following example shows what a CloudEvents change event record emitted by a PostgreSQL connector looks like.
In this example, the PostgreSQL connector is configured to use JSON as the CloudEvents format envelope and also as the <code>data</code> format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "id" : "name:test_server;lsn:29274832;txId:565",   <i class="conum" data-value="1"></i><b>(1)</b>
  "source" : "/debezium/postgresql/test_server",     <i class="conum" data-value="2"></i><b>(2)</b>
  "specversion" : "1.0",                             <i class="conum" data-value="3"></i><b>(3)</b>
  "type" : "io.debezium.postgresql.datachangeevent", <i class="conum" data-value="4"></i><b>(4)</b>
  "time" : "2020-01-13T13:55:39.738Z",               <i class="conum" data-value="5"></i><b>(5)</b>
  "datacontenttype" : "application/json",            <i class="conum" data-value="6"></i><b>(6)</b>
  "iodebeziumop" : "r",                              <i class="conum" data-value="7"></i><b>(7)</b>
  "iodebeziumversion" : "2.6.0.Final",        <i class="conum" data-value="8"></i><b>(8)</b>
  "iodebeziumconnector" : "postgresql",
  "iodebeziumname" : "test_server",
  "iodebeziumtsms" : "1578923739738",
  "iodebeziumsnapshot" : "true",
  "iodebeziumdb" : "postgres",
  "iodebeziumschema" : "s1",
  "iodebeziumtable" : "a",
  "iodebeziumlsn" : "29274832",
  "iodebeziumxmin" : null,
  "iodebeziumtxid": "565",                           <i class="conum" data-value="9"></i><b>(9)</b>
  "iodebeziumtxtotalorder": "1",
  "iodebeziumtxdatacollectionorder": "1",
  "data" : {                                         <i class="conum" data-value="10"></i><b>(10)</b>
    "before" : null,
    "after" : {
      "pk" : 1,
      "name" : "Bob"
    }
  }
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Descriptions of fields in a CloudEvents change event record</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique ID that the connector generates for the change event based on the change event&#8217;s content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The source of the event, which is the logical name of the database as specified by the <code>topic.prefix</code> property in the connector&#8217;s configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CloudEvents specification version.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Connector type that generated the change event.
The format of this field is <code>io.debezium.<em>&lt;CONNECTOR_TYPE&gt;</em>.datachangeevent</code>.
Valid values for <code><em>CONNECTOR_TYPE</em></code> are <code>db2</code>,
<code>informix</code>,
<code>mongodb</code>, <code>mysql</code>, <code>oracle</code>, <code>postgresql</code>, or <code>sqlserver</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time of the change in the source database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the content type of the <code>data</code> attribute.
Possible values are <code>json</code>, as in this example, or <code>avro</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An operation identifier.
Possible values are <code>r</code> for read, <code>c</code> for create, <code>u</code> for update, or <code>d</code> for delete.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All <code>source</code> attributes that are known from Debezium change events are mapped to CloudEvents extension attributes by using the <code>iodebezium</code> prefix for the attribute name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When enabled in the connector, each <code>transaction</code> attribute that is known from Debezium change events is mapped to a CloudEvents extension attribute by using the <code>iodebeziumtx</code> prefix for the attribute name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The actual data change.
Depending on the operation and the connector, the data might contain <code>before</code>, <code>after</code>, or <code>patch</code> fields.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example also shows what a CloudEvents change event record emitted by a PostgreSQL connector looks like. In this example, the PostgreSQL connector is again configured to use JSON as the CloudEvents format envelope, but this time the connector is configured to use Avro for the <code>data</code> format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "id" : "name:test_server;lsn:33227720;txId:578",
  "source" : "/debezium/postgresql/test_server",
  "specversion" : "1.0",
  "type" : "io.debezium.postgresql.datachangeevent",
  "time" : "2020-01-13T14:04:18.597Z",
  "datacontenttype" : "application/avro",            <i class="conum" data-value="1"></i><b>(1)</b>
  "dataschema" : "http://my-registry/schemas/ids/1", <i class="conum" data-value="2"></i><b>(2)</b>
  "iodebeziumop" : "r",
  "iodebeziumversion" : "2.6.0.Final",
  "iodebeziumconnector" : "postgresql",
  "iodebeziumname" : "test_server",
  "iodebeziumtsms" : "1578924258597",
  "iodebeziumsnapshot" : "true",
  "iodebeziumdb" : "postgres",
  "iodebeziumschema" : "s1",
  "iodebeziumtable" : "a",
  "iodebeziumtxId" : "578",
  "iodebeziumlsn" : "33227720",
  "iodebeziumxmin" : null,
  "iodebeziumtxid": "578",
  "iodebeziumtxtotalorder": "1",
  "iodebeziumtxdatacollectionorder": "1",
  "data" : "AAAAAAEAAgICAg=="                        <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Descriptions of fields in a CloudEvents event record for a connector that uses Avro to format data</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the <code>data</code> attribute contains Avro binary data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI of the schema to which the Avro data adheres.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>data</code> attribute contains base64-encoded Avro binary data.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It is also possible to use Avro for the envelope as well as the <code>data</code> attribute.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_configuration"><a class="anchor" href="#_example_configuration"></a>Example configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configure <code>io.debezium.converters.CloudEventsConverter</code> in your Debezium connector configuration.
The following example shows how to configure the CloudEvents converter to emit change event records that have the following characteristics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use JSON as the envelope.</p>
</li>
<li>
<p>Use the schema registry at <code>http://my-registry/schemas/ids/1</code> to serialize the <code>data</code> attribute as binary Avro data.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">...
"value.converter": "io.debezium.converters.CloudEventsConverter",
"value.converter.serializer.type" : "json",          <i class="conum" data-value="1"></i><b>(1)</b>
"value.converter.data.serializer.type" : "avro",
"value.converter.avro.schema.registry.url": "http://my-registry/schemas/ids/1"
...</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Description of fields in CloudEvents converter configuration</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 87.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifying the <code>serializer.type</code> is optional, because <code>json</code> is the default.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The CloudEvents converter converts Kafka record values. In the same connector configuration, you can specify <code>key.converter</code> if you want to operate on record keys.
For example, you might specify <code>StringConverter</code>, <code>LongConverter</code>, <code>JsonConverter</code>, or <code>AvroConverter</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-of-sources-of-metadata-and-some-cloudevents-fields"><a class="anchor" href="#configuration-of-sources-of-metadata-and-some-cloudevents-fields"></a>Configuration of sources of metadata and some CloudEvents fields</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the <code>metadata.source</code> property consists of three parts, as seen in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"value,id:generate,type:generate,dataSchemaName:generate"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first part specifies the source for retrieving a record&#8217;s metadata; the permitted values are <code>value</code> and <code>header</code>.
The next parts specify how the converter populates values for the following metadata fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code></p>
</li>
<li>
<p><code>type</code></p>
</li>
<li>
<p><code>dataSchemaName</code> (the name under which the schema is registered in the Schema Registry)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The converter can use one of the following methods to populate each field:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>generate</code></dt>
<dd>
<p>The converter generates a value for the field.</p>
</dd>
<dt class="hdlist1"><code>header</code></dt>
<dd>
<p>The converter obtain values for the field from a message header.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="_obtaining_record_metadata"><a class="anchor" href="#_obtaining_record_metadata"></a>Obtaining record metadata</h3>
<div class="paragraph">
<p>To construct a CloudEvent, the converter requires source, operation, and transaction metadata.
Generally, the converter can retrieve the metadata from a record&#8217;s value.
But in some cases, before the converter receives a record, the record might be processed in such a way that metadata is not present in its value, for example, after the record is processed by the Outbox Event Router SMT.
To preserve the required metadata, you can use the following approach to pass the metadata in the record headers.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Implement a mechanism for recording the metadata in the record&#8217;s headers before the record reaches the converter, for example, by using the <code>HeaderFrom</code> SMT.</p>
</li>
<li>
<p>Set the value of the converter&#8217;s <code>metadata.source</code> property to <code>header</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following example shows the configuration for a connector that uses the Outbox Event Router SMT, and the <code>HeaderFrom</code> SMT:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">...
"tombstones.on.delete": false,
"transforms": "addMetadataHeaders,outbox",
"transforms.addMetadataHeaders.type": "org.apache.kafka.connect.transforms.HeaderFrom$Value",
"transforms.addMetadataHeaders.fields": "source,op,transaction",
"transforms.addMetadataHeaders.headers": "source,op,transaction",
"transforms.addMetadataHeaders.operation": "copy",
"transforms.addMetadataHeaders.predicate": "isHeartbeat",
"transforms.addMetadataHeaders.negate": true,
"transforms.outbox.type": "io.debezium.transforms.outbox.EventRouter",
"transforms.outbox.table.expand.json.payload": true,
"transforms.outbox.table.fields.additional.placement": "type:header",
"predicates": "isHeartbeat",
"predicates.isHeartbeat.type": "org.apache.kafka.connect.transforms.predicates.TopicNameMatches",
"predicates.isHeartbeat.pattern": "__debezium-heartbeat.*",
"value.converter": "io.debezium.converters.CloudEventsConverter",
"value.converter.metadata.source": "header",
"header.converter": "org.apache.kafka.connect.json.JsonConverter",
"header.converter.schemas.enable": true
...</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To use the <code>HeaderFrom</code> transformation, it might be necessary to filter tombstone and heartbeat messages.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>header</code> value of the <code>metadata.source</code> property is a global setting.
As a result, even if you omit parts of a property&#8217;s value, such as the <code>id</code> and <code>type</code> sources, the converter generates <code>header</code> values for the omitted parts.</p>
</div>
</div>
<div class="sect2">
<h3 id="_obtaining_cloudevent_metadata"><a class="anchor" href="#_obtaining_cloudevent_metadata"></a>Obtaining CloudEvent metadata</h3>
<div class="paragraph">
<p>By default, the CloudEvents converter automatically generates values for the <code>id</code> and <code>type</code> fields of a CloudEvent, and generates the schema name for its <code>data</code> field.
You can customize the way that the converter populates these fields by changing the defaults and specifying the fields' values in the appropriate headers.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"value.converter.metadata.source": "value,id:header,type:header,dataSchemaName:header"</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the preceding configuration in effect, you could configure upstream functions to add <code>id</code> and <code>type</code> headers with the values that you want to pass to the CloudEvents converter.</p>
</div>
<div class="paragraph">
<p>If you want to provide values only for <code>id</code> header, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"value.converter.metadata.source": "value,id:header,type:generate,dataSchemaName:generate"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To configure the converter to obtain <code>id</code>, <code>type</code>, and <code>dataSchemaName</code>  metadata from headers, use the following short syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"value.converter.metadata.source": "header"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable the converter to retrieve the data schema name from a header field, you must set <a href="#cloud-events-converter-schema-data-name-source-header-enable"><code>schema.data.name.source.header.enable</code></a> to <code>true</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cloud-events-converter-configuration-options"><a class="anchor" href="#cloud-events-converter-configuration-options"></a>Configuration options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you configure a Debezium connector to use the CloudEvent converter you can specify the following options.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Descriptions of CloudEvents converter configuration options</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 25%;">
<col style="width: 45%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Option</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Default</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Description</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-serializer-type"></a><a href="#cloud-events-converter-serializer-type"><code>serializer.type</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>json</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The encoding type to use for the CloudEvents envelope structure.
The value can be <code>json</code> or <code>avro</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-data-serializer-type"></a><a href="#cloud-events-converter-data-serializer-type"><code>data.serializer.type</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>json</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The encoding type to use for the <code>data</code> attribute.
The value can be <code>json</code> or <code>avro</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-json"></a><a href="#cloud-events-converter-json"><code>json. ...</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N/A</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Any configuration options to be passed through to the underlying converter when using JSON. The <code>json.</code> prefix is removed.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-avro"></a><a href="#cloud-events-converter-avro"><code>avro. ...</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N/A</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Any configuration options to be passed through to the underlying converter when using Avro. The <code>avro.</code> prefix is removed. For example, for Avro <code>data</code>, you would specify the <code>avro.schema.registry.url</code> option.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-schema-name-adjustment-mode"></a><a href="#cloud-events-converter-schema-name-adjustment-mode"><code>schema.name.adjustment.mode</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>none</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies how schema names should be adjusted for compatibility with the message converter used by the connector. The value can be <code>none</code> or <code>avro</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-schema-cloudevents-name"></a><a href="#cloud-events-converter-schema-cloudevents-name"><code>schema.cloudevents.name</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>none</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies CloudEvents schema name under which the schema is registered in a Schema Registry. The setting is ignored when <code>serializer.type</code> is <code>json</code> in
which case a record&#8217;s value is schemaless.
If this property is not specified, the default algorithm is used to generate the
schema name: <code>${serverName}.${databaseName}.CloudEvents.Envelope</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-schema-data-name-source-header-enable"></a><a href="#cloud-events-converter-schema-data-name-source-header-enable"><code>schema.data.name.source.header.enable</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>false</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies whether the converter can retrieve the schema name of the CloudEvents <code>data</code> field from a header.
The schema name is obtained from the <code>dataSchemaName</code> parameter that is specified in the <a href="#cloud-events-converter-metadata-source"><code>metadata.source</code></a> property.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-extension-attributes-enable"></a><a href="#cloud-events-converter-extension-attributes-enable"><code>extension.attributes.enable</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>true</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies whether the converter includes extension attributes when it generates a cloud event.
The value can be <code>true</code> or <code>false</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="cloud-events-converter-metadata-source"></a><a href="#cloud-events-converter-metadata-source"><code>metadata.source</code></a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>value,id:generate,type:generate,dataSchemaName:generate</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A comma-separated list that specifies the sources from which the converter retrieves metadata values (source, operation, transaction) for CloudEvent <code>id</code> and <code>type</code> fields,
and for the <code>dataSchemaName</code> parameter, which specifies the name under which the schema is registered in a Schema Registry.
The first element in the list is a global setting that specifies the source of the metadata.
The source of metadata can be <code>value</code> or <code>header</code>.
The global setting is followed by a set of pairs.
The first element in each pair specifies the name of a CloudEvent field (<code>id</code> or <code>type</code>), or the name of a data schema (<code>dataSchemaName</code>).
The second element in the pair specifies how the converter populates the value of the field.
Valid values are <code>generate</code> or <code>header</code>.
Separate the values in each pair with a colon, for example:</p>
</div>
<div class="paragraph">
<p><code>value,id:header,type:generate,dataSchemaName:header</code></p>
</div>
<div class="paragraph">
<p>For configuration examples, see <a href="#configuration-of-sources-of-metadata-and-some-cloudevents-fields">Configuration of sources of metadata and some CloudEvents fields</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</article>
</div>
<div class="article-cell2">
</div>
</div>

<div id="toc-rightbar"></div>    <footer class="footer">
        <div class="wrapper">
            <div class="copyright">Copyright &copy; 2024 Debezium Community (Rev: <span class="truncated"><a href="https://github.com/debezium/debezium/commit/5fad9e57a704b2d2cd30344985ba58757acefc41">5fad9e57</a></span>)
            
        </div>
    </footer>
</main></div>
<script>
    /* Make sure TOC carets are expanded if sub-elements exist */
    $("#toc").each(function(i,v) {
      $(this).closest('article').addClass('with-toc');
    });

    $("#toc ul.sectlevel1 > li").each(function(i,v) {
      $(this).has("ul").addClass("expanded");
    });

    $(function() {
        /* Expands all the documentation submenus */
        $(".nav-list > .nav-item:not(.is-active) .nav-item-toggle").click();
    });

    /**
     * This checks if a "#toc" element exists in the DOM and if so:
     *
     *  1. Appends a cloned copy of the #toc node to the #toc-rightbar div.
     *  2. Forces the #toc-rightbar div to be visible.
     *  3. Adds the .toc-right class to the #article-wrapper div to restrict the article's overall width.
     */
    var $toc = $("#toc");
    if ( $toc.length ) {
        $("#toc-rightbar").append($toc.clone());
        $("body .main").addClass("with-toc");
    }

    /**
     * In order to make CSS changes that are backward compatible with old adoc files, this applies a version
     * style to the body tag so we can use it to differentiate between CSS styles per version if needed,
     * such as tfoot rows.
     */
    var $version = $("body .nav-container").data("version");
    var $versionClass = "version-" + $version;
    $versionClass = $versionClass.replace('.','-');
    $("body").addClass($versionClass);

    /** A CSS trick to wrap long-width tables in a div that can be scrolled on smaller screens */
    $("table.tableblock").wrap("<div class='table-scroll-wrapper'></div>");

    $(function() {
        /* apply floating scrollbar to the scroll-wrapper */
        $(".table-scroll-wrapper").floatingScrollbar();
    });

</script>
<script src="../../debezium-antora/js/site.js"></script>
<script async src="../../debezium-antora/js/vendor/highlight.js"></script>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-10656779-1");
    pageTracker._trackPageview();
  } catch(err) {}
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76464546-1', 'auto');
  ga('send', 'pageview');
  ga('set', 'anonymizeIp', true);
  ga('require', 'linkid', 'linkid.js');
</script>
</body>
</html>