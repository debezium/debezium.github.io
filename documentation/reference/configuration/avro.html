<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Avro Serialization :: Debezium Documentation</title>
    <link rel="canonical" href="https://debezium.io/documentation/reference/stable/configuration/avro.html">
    <meta name="generator" content="Antora 3.1.7">
<link rel="stylesheet" href="../../debezium-antora/css/site.css">
<link rel="stylesheet" href="../../debezium-antora/css/debezium-antora.css">
<link rel="stylesheet" href="../../debezium-antora/css/highlightjs-dark.css">
<link rel="stylesheet" href="https://static.jboss.org/css/rhbar.css">
<script src="//static.jboss.org/theme/js/libs/jquery/jquery-1.9.1.js"></script>
<script src="../../debezium-antora/js/jquery.ba-floatingscrollbar.js"></script>
</head>
<body class="article">
<header class="header">
  <div id="rhbar">
      <a class="jbdevlogo" href="https://developers.redhat.com"></a>
      <a class="rhlogo" href="https://www.redhat.com"></a>
  </div>
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
          <img src="/assets/images/color_white_debezium_type_600px.svg" style="height: 32px; margin-right: 14px;"/>
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/documentation/faq">FAQ</a>
        <a class="navbar-item" href="/documentation">DOCUMENTATION</a>
        <a class="navbar-item" href="/releases">RELEASES</a>
        <a class="navbar-item" href="/community">COMMUNITY</a>
        <a class="navbar-item" href="/blog">BLOG</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="reference" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Debezium nightly Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorial.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../install.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../postgres-plugins.html">PostgreSQL Decoding Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../features.html">Features</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="avro.html">Avro Serialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="topic-auto-create-config.html">Customizing Topic Auto-Creation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="signalling.html">Sending Signals to Debezium</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="notification.html">Receive notifications from Debezium</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Connectors</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/mysql.html">MySQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/mariadb.html">MariaDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/mongodb.html">MongoDB</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/postgresql.html">PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/oracle.html">Oracle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/sqlserver.html">SQL Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/db2.html">Db2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/cassandra.html">Cassandra</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/vitess.html">Vitess</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/spanner.html">Spanner</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/jdbc.html">JDBC</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connectors/informix.html">Informix</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Transformations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/topic-routing.html">Topic Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/event-flattening.html">New Record State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/mongodb-event-flattening.html">MongoDB New Document State Extraction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/event-changes.html">Event Changes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/outbox-event-router.html">Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/mongodb-outbox-event-router.html">MongoDB Outbox Event Router</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/filtering.html">Message Filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/schema-change-event-filter.html">Schema Change Event Filtering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/content-based-routing.html">Content-Based Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/applying-transformations-selectively.html">Using SMT Predicates to Selectively Apply Transformations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/partition-routing.html">Partition Routing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/header-to-value.html">HeaderToValue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/timezone-converter.html">Timezone Converter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/timescaledb.html">TimescaleDB Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/decode-logical-decoding-message-content.html">Decode Logical Decoding Message Content</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../transformations/convert-cloudevent-to-saveable-form.html">Convert CloudEvents to Saveable Form</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Post Processors</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../post-processors/index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../post-processors/reselect-columns.html">Reselect Columns</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">API and SPI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/engine.html">Debezium Engine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../development/converters.html">Custom Converters</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/serdes.html">Change Event SerDes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/outbox.html">Outbox Quarkus Extension</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/cloudevents.html">CloudEvents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/tracing.html">OpenTelemetry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/testcontainers.html">Integration Testing with Testcontainers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Operations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-server.html">Debezium Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/kubernetes.html">Running on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/openshift.html">Running on Openshift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../operations/debezium-ui.html">Debezium UI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Debezium Documentation</span>
    <span class="version">nightly</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Debezium Documentation</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="/documentation/reference/nightly/index.html">nightly</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.7/index.html">2.7</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/3.0/index.html">3.0</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.6/index.html">2.6</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.5/index.html">2.5</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.4/index.html">2.4</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.3/index.html">2.3</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.1/index.html">2.1</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/2.0/index.html">2.0</a>
        </li>
        <li class="version">
          <a href="/documentation/reference/1.9/index.html">1.9</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main role="main" class="main">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../stable/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Debezium Documentation</a></li>
    <li>Configuration</li>
    <li><a href="avro.html">Avro Serialization</a></li>
  </ul>
</nav>
    <div class="page-versions-container">
    Version:
    <div class="page-versions">
        <button class="version-menu-toggle versions-menu-current" title="Show other versions of page">nightly</button>
        <div class="version-menu">
                <a class="version is-current" href="/documentation/reference/nightly/index.html">nightly</a>
                <a class="version" href="/documentation/reference/2.7/index.html">2.7</a>
                <a class="version" href="/documentation/reference/3.0/index.html">3.0</a>
                <a class="version" href="/documentation/reference/2.6/index.html">2.6</a>
                <a class="version" href="/documentation/reference/2.5/index.html">2.5</a>
                <a class="version" href="/documentation/reference/2.4/index.html">2.4</a>
                <a class="version" href="/documentation/reference/2.3/index.html">2.3</a>
                <a class="version" href="/documentation/reference/2.2/index.html">2.2</a>
                <a class="version" href="/documentation/reference/2.1/index.html">2.1</a>
                <a class="version" href="/documentation/reference/2.0/index.html">2.0</a>
                <a class="version" href="/documentation/reference/1.9/index.html">1.9</a>
        </div>
        |
    </div>
    </div>
  <div class="edit-this-page"><a href="https://github.com/debezium/debezium/edit/main/documentation/modules/ROOT/pages/configuration/avro.adoc">Edit this Page</a></div>
  </div>
<div class="article-grid">
<div class="article-cell1">
<article class="doc">
        
    <div class="version-banner version-banner-development">
    You are viewing documentation for an unreleased version of Debezium.
    <br/>
            If you want to view the latest stable version of this page, please go <a href=/documentation/reference/stable/index.html>here</a>.
            
</div>            <h1 class="page">Avro Serialization</h1>
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#apicurio-registry">Apicurio API and Schema Registry</a>
<ul class="sectlevel2">
<li><a href="#about-the-registry">About the Apicurio API and Schema Registry</a></li>
<li><a href="#overview-of-deploying-a-debezium-connector-that-uses-avro-serialization">Apicurio Registry deployment overview</a></li>
<li><a href="#deploying-with-debezium-containers">Deploying Apicurio Registry with Debezium containers</a></li>
</ul>
</li>
<li><a href="#confluent-schema-registry">Confluent Schema Registry</a>
<ul class="sectlevel2">
<li><a href="#overview-of-deploying-confluent-schema-registry">Confluent Schema Registry deployment overview</a></li>
<li><a href="#deploying-confluent-schema-registry-with-debezium-containers">Deploying Confluent Schema Registry with Debezium containers</a></li>
</ul>
</li>
<li><a href="#avro-naming">Naming</a></li>
<li><a href="#_getting_more_information">Getting More Information</a></li>
</ul>
</div>
<div class="paragraph">
<p>A Debezium connector works in the Kafka Connect framework to capture each row-level change in a database by generating a change event record.
For each change event record, the Debezium connector completes the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Applies configured transformations.</p>
</li>
<li>
<p>Serializes the record key and value into a binary form by using the configured <a href="https://kafka.apache.org/documentation/#connect_running">Kafka Connect converters</a>.</p>
</li>
<li>
<p>Writes the record to the correct Kafka topic.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can specify converters for each individual Debezium connector instance.
Kafka Connect provides a JSON converter that serializes the record keys and values into JSON documents.
The default behavior is that the JSON converter includes the record&#8217;s message schema, which makes each record very verbose.
The <a href="../tutorial.html" class="xref page">Debezium Tutorial</a> shows what the records look like when both payload and schemas are included.
If you want records to be serialized with JSON, consider setting the following connector configuration properties to <code>false</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>key.converter.schemas.enable</code></p>
</li>
<li>
<p><code>value.converter.schemas.enable</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Setting these properties to <code>false</code> excludes the verbose schema information from each record.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can serialize the record keys and values by using <a href="https://avro.apache.org/">Apache Avro</a>.
The Avro binary format is compact and efficient.
Avro schemas make it possible to ensure that each record has the correct structure.
Avro&#8217;s schema evolution mechanism enables schemas to evolve.
This is essential for Debezium connectors, which dynamically generate each record&#8217;s schema to match the structure of the database table that was changed.
Over time, change event records written to the same Kafka topic might have different versions of the same schema.
Avro serialization makes it easier for the consumers of change event records to adapt to a changing record schema.</p>
</div>
<div class="paragraph">
<p>To use Apache Avro serialization, you must deploy a schema registry that manages Avro message schemas and their versions.
Available options include the Apicurio API and Schema Registry as well as the Confluent Schema Registry. Both are described here.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="apicurio-registry"><a class="anchor" href="#apicurio-registry"></a>Apicurio API and Schema Registry</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="about-the-registry"><a class="anchor" href="#about-the-registry"></a>About the Apicurio API and Schema Registry</h3>
<div class="paragraph">
<p>The <a href="https://github.com/Apicurio/apicurio-registry">Apicurio Registry</a> open-source project provides several components that work with Avro:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An Avro converter that you can specify in Debezium connector configurations.
This converter maps Kafka Connect schemas to Avro schemas.
The converter then uses the Avro schemas to serialize the record keys and values into Avro&#8217;s compact binary form.</p>
</li>
<li>
<p>An API and schema registry that tracks:</p>
<div class="ulist">
<ul>
<li>
<p>Avro schemas that are used in Kafka topics.</p>
</li>
<li>
<p>Where the Avro converter sends the generated Avro schemas.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because the Avro schemas are stored in this registry, each record needs to contain only a tiny <em>schema identifier</em>.
This makes each record even smaller. For an I/O bound system like Kafka, this means more total throughput for producers and consumers.</p>
</div>
</li>
<li>
<p>Avro <em>Serdes</em> (serializers and deserializers) for Kafka producers and consumers.
Kafka consumer applications that you write to consume change event records can use Avro Serdes to deserialize the change event records.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use the Apicurio Registry with Debezium, add Apicurio Registry converters and their dependencies to the Kafka Connect container image that you are using for running a Debezium connector.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Apicurio Registry project also provides a JSON converter.
This converter combines the advantage of less verbose messages with human-readable JSON.
Messages do not contain the schema information themselves, but only a schema ID.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To use converters provided by Apicurio Registry you need to provide <code>apicurio.registry.url</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="overview-of-deploying-a-debezium-connector-that-uses-avro-serialization"><a class="anchor" href="#overview-of-deploying-a-debezium-connector-that-uses-avro-serialization"></a>Apicurio Registry deployment overview</h3>
<div class="paragraph">
<p>To deploy a Debezium connector that uses Avro serialization, you must complete three main tasks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy an <a href="https://github.com/Apicurio/apicurio-registry">Apicurio API and Schema Registry</a> instance.</p>
</li>
<li>
<p>Install the Avro converter from the <a href="https://repo1.maven.org/maven2/io/apicurio/apicurio-registry-distro-connect-converter/2.5.11.Final/apicurio-registry-distro-connect-converter-2.5.11.Final.tar.gz">installation package</a> into a plug-in directory. If you are using the <a href="https://quay.io/repository/debezium/connect">Debezium Connect container image</a>, it&#8217;s not necessary to install the package. For more information, see  <a href="#deploying-with-debezium-containers">Deploying Apicurio Registry with Debezium containers</a>.</p>
</li>
<li>
<p>Configure a Debezium connector instance to use Avro serialization by setting configuration properties as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">key.converter=io.apicurio.registry.utils.converter.AvroConverter
key.converter.apicurio.registry.url=http://apicurio:8080/apis/registry/v2
key.converter.apicurio.registry.auto-register=true
key.converter.apicurio.registry.find-latest=true
value.converter=io.apicurio.registry.utils.converter.AvroConverter
value.converter.apicurio.registry.url=http://apicurio:8080/apis/registry/v2
value.converter.apicurio.registry.auto-register=true
value.converter.apicurio.registry.find-latest=true
schema.name.adjustment.mode=avro</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Internally, Kafka Connect always uses JSON key/value converters for storing configuration and offsets.</p>
</div>
</div>
<div class="sect2">
<h3 id="deploying-with-debezium-containers"><a class="anchor" href="#deploying-with-debezium-containers"></a>Deploying Apicurio Registry with Debezium containers</h3>
<div class="paragraph">
<p>In your environment, you might want to use a provided Debezium container image to deploy Debezium connectors that use Avro serialization. Follow the procedure here to do that. In this procedure, you enable Apicurio converters on the Debezium Kafka Connect container image, and configure the Debezium connector to use the Avro converter.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have Docker installed and sufficient rights to create and manage containers.</p>
</li>
<li>
<p>You downloaded the Debezium connector plug-in(s) that you want to deploy with Avro serialization.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Deploy an instance of Apicurio Registry.</p>
<div class="paragraph">
<p>The following example uses a non-production, in-memory, Apicurio Registry instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">docker run -it --rm --name apicurio \
    -p 8080:8080 apicurio/apicurio-registry-mem:2.5.11.Final</code></pre>
</div>
</div>
</li>
<li>
<p>Run the Debezium container image for Kafka Connect, configuring it to provide the Avro converter by enabling Apicurio via <code>ENABLE_APICURIO_CONVERTERS=true</code> environment variable:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">docker run -it --rm --name connect \
    --link zookeeper:zookeeper \
    --link kafka:kafka \
    --link mysql:mysql \
    --link apicurio:apicurio \
    -e ENABLE_APICURIO_CONVERTERS=true \
    -e GROUP_ID=1 \
    -e CONFIG_STORAGE_TOPIC=my_connect_configs \
    -e OFFSET_STORAGE_TOPIC=my_connect_offsets \
    -e KEY_CONVERTER=io.apicurio.registry.utils.converter.AvroConverter \
    -e VALUE_CONVERTER=io.apicurio.registry.utils.converter.AvroConverter \
    -e CONNECT_KEY_CONVERTER=io.apicurio.registry.utils.converter.AvroConverter \
    -e CONNECT_KEY_CONVERTER_APICURIO.REGISTRY_URL=http://apicurio:8080/apis/registry/v2 \
    -e CONNECT_KEY_CONVERTER_APICURIO_REGISTRY_AUTO-REGISTER=true \
    -e CONNECT_KEY_CONVERTER_APICURIO_REGISTRY_FIND-LATEST=true \
    -e CONNECT_VALUE_CONVERTER=io.apicurio.registry.utils.converter.AvroConverter \
    -e CONNECT_VALUE_CONVERTER_APICURIO_REGISTRY_URL=http://apicurio:8080/apis/registry/v2 \
    -e CONNECT_VALUE_CONVERTER_APICURIO_REGISTRY_AUTO-REGISTER=true \
    -e CONNECT_VALUE_CONVERTER_APICURIO_REGISTRY_FIND-LATEST=true \
    -e CONNECT_SCHEMA_NAME_ADJUSTMENT_MODE=avro \
    -p 8083:8083 quay.io/debezium/connect:2.7</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="confluent-schema-registry"><a class="anchor" href="#confluent-schema-registry"></a>Confluent Schema Registry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is an alternative <a href="https://github.com/confluentinc/schema-registry">schema registry</a> implementation provided by Confluent.</p>
</div>
<div class="sect2">
<h3 id="overview-of-deploying-confluent-schema-registry"><a class="anchor" href="#overview-of-deploying-confluent-schema-registry"></a>Confluent Schema Registry deployment overview</h3>
<div class="paragraph">
<p>For information about installing the standalone Confluent Schema Registry, see the  <a href="https://docs.confluent.io/platform/current/installation/installing_cp/overview.html">Confluent Platform deployment documentation</a>.</p>
</div>
<div class="paragraph">
<p>As an alternative, you can <a href="https://docs.confluent.io/platform/current/installation/docker/installation.html">install</a> the standalone Confluent Schema Registry as a container.</p>
</div>
</div>
<div class="sect2">
<h3 id="deploying-confluent-schema-registry-with-debezium-containers"><a class="anchor" href="#deploying-confluent-schema-registry-with-debezium-containers"></a>Deploying Confluent Schema Registry with Debezium containers</h3>
<div class="paragraph">
<p>Beginning with Debezium 2.0.0, Confluent Schema Registry support is not included in the Debezium containers.
To enable the Confluent Schema Registry for a Debezium container, install the following Confluent Avro converter JAR files into the Connect plugin directory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kafka-connect-avro-converter</code></p>
</li>
<li>
<p><code>kafka-connect-avro-data</code></p>
</li>
<li>
<p><code>kafka-avro-serializer</code></p>
</li>
<li>
<p><code>kafka-schema-serializer</code></p>
</li>
<li>
<p><code>kafka-schema-converter</code></p>
</li>
<li>
<p><code>kafka-schema-registry-client</code></p>
</li>
<li>
<p><code>common-config</code></p>
</li>
<li>
<p><code>common-utils</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can download the preceding files from the <a href="https://packages.confluent.io/maven/">Confluent Maven repository</a>.</p>
</div>
<div class="paragraph">
<p>There are also some other JAR files required to be located into the Connect plugin directory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>avro</code></p>
</li>
<li>
<p><code>commons-compress</code></p>
</li>
<li>
<p><code>failureaccess</code></p>
</li>
<li>
<p><code>guava</code></p>
</li>
<li>
<p><code>minimal-json</code></p>
</li>
<li>
<p><code>re2j</code></p>
</li>
<li>
<p><code>slf4j-api</code></p>
</li>
<li>
<p><code>snakeyaml</code></p>
</li>
<li>
<p><code>swagger-annotations</code></p>
</li>
<li>
<p><code>jackson-databind</code></p>
</li>
<li>
<p><code>jackson-core</code></p>
</li>
<li>
<p><code>jackson-annotations</code></p>
</li>
<li>
<p><code>jackson-dataformat-csv</code></p>
</li>
<li>
<p><code>logredactor</code></p>
</li>
<li>
<p><code>logredactor-metrics</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can download the preceding files from the <a href="https://mvnrepository.com/">Maven repository</a>.</p>
</div>
<div class="paragraph">
<p>The configuration is slightly different.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your Debezium connector configuration, specify the following properties:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">key.converter=io.confluent.connect.avro.AvroConverter
key.converter.schema.registry.url=http://localhost:8081
value.converter=io.confluent.connect.avro.AvroConverter
value.converter.schema.registry.url=http://localhost:8081</code></pre>
</div>
</div>
</li>
<li>
<p>Deploy an instance of the Confluent Schema Registry:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">docker run -it --rm --name schema-registry \
    --link zookeeper \
    -e SCHEMA_REGISTRY_KAFKASTORE_CONNECTION_URL=zookeeper:2181 \
    -e SCHEMA_REGISTRY_HOST_NAME=schema-registry \
    -e SCHEMA_REGISTRY_LISTENERS=http://schema-registry:8081 \
    -p 8181:8181 confluentinc/cp-schema-registry</code></pre>
</div>
</div>
</li>
<li>
<p>Run a Kafka Connect image configured to use Avro:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">docker run -it --rm --name connect \
    --link zookeeper:zookeeper \
    --link kafka:kafka \
    --link mysql:mysql \
    --link schema-registry:schema-registry \
    -e GROUP_ID=1 \
    -e CONFIG_STORAGE_TOPIC=my_connect_configs \
    -e OFFSET_STORAGE_TOPIC=my_connect_offsets \
    -e KEY_CONVERTER=io.confluent.connect.avro.AvroConverter \
    -e VALUE_CONVERTER=io.confluent.connect.avro.AvroConverter \
    -e CONNECT_KEY_CONVERTER_SCHEMA_REGISTRY_URL=http://schema-registry:8081 \
    -e CONNECT_VALUE_CONVERTER_SCHEMA_REGISTRY_URL=http://schema-registry:8081 \
    -p 8083:8083 quay.io/debezium/connect:2.7</code></pre>
</div>
</div>
</li>
<li>
<p>Run a console consumer that reads new Avro messages from the <code>db.myschema.mytable</code> topic and decodes to JSON:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">docker run -it --rm --name avro-consumer \
    --link zookeeper:zookeeper \
    --link kafka:kafka \
    --link mysql:mysql \
    --link schema-registry:schema-registry \
    quay.io/debezium/connect:2.7 \
    /kafka/bin/kafka-console-consumer.sh \
      --bootstrap-server kafka:9092 \
      --property print.key=true \
      --formatter io.confluent.kafka.formatter.AvroMessageFormatter \
      --property schema.registry.url=http://schema-registry:8081 \
      --topic db.myschema.mytable</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="avro-naming"><a class="anchor" href="#avro-naming"></a>Naming</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As stated in the Avro <a href="https://avro.apache.org/docs/current/spec.html#names">documentation</a>, names must adhere to the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start with <code>[A-Za-z_]</code></p>
</li>
<li>
<p>Subsequently contains only <code>[A-Za-z0-9_]</code> characters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Debezium uses the column&#8217;s name as the basis for the corresponding Avro field.
This can lead to problems during serialization if the column name does not also adhere to the Avro naming rules.
Each Debezium connector provides a configuration property, <code>field.name.adjustment.mode</code> that you can set to <code>avro</code> if you have columns that do not adhere to Avro rules for names.
Setting <code>field.name.adjustment.mode</code> to <code>avro</code> allows serialization of non-conformant fields without having to actually modify your schema.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_more_information"><a class="anchor" href="#_getting_more_information"></a>Getting More Information</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="/blog/2016/09/19/Serializing-Debezium-events-with-Avro/">This post</a> from the Debezium blog
describes the concepts of serializers, converters, and other components, and discusses the advantages of using Avro.
Some Kafka Connect converter details have slightly changed since that post was written.</p>
</div>
<div class="paragraph">
<p>For a complete example of using Avro as the message format for Debezium change data events,
see <a href="https://github.com/debezium/debezium-examples/tree/main/tutorial#using-mysql-and-the-avro-message-format">MySQL and the Avro message format</a>.</p>
</div>
</div>
</div>
</article>
</div>
<div class="article-cell2">
</div>
</div>

<div id="toc-rightbar"></div>    <footer class="footer">
        <div class="wrapper">
            <div class="copyright">Copyright &copy; 2024 Debezium Community (Rev: <span class="truncated"><a href="https://github.com/debezium/debezium/commit/40114d1219a1d4d83601e0427e09674cd1c65d7a">40114d12</a></span>)
            
        </div>
    </footer>
</main></div>
<script>
    /* Make sure TOC carets are expanded if sub-elements exist */
    $("#toc").each(function(i,v) {
      $(this).closest('article').addClass('with-toc');
    });

    $("#toc ul.sectlevel1 > li").each(function(i,v) {
      $(this).has("ul").addClass("expanded");
    });

    $(function() {
        /* Expands all the documentation submenus */
        $(".nav-list > .nav-item:not(.is-active) .nav-item-toggle").click();
    });

    /**
     * This checks if a "#toc" element exists in the DOM and if so:
     *
     *  1. Appends a cloned copy of the #toc node to the #toc-rightbar div.
     *  2. Forces the #toc-rightbar div to be visible.
     *  3. Adds the .toc-right class to the #article-wrapper div to restrict the article's overall width.
     */
    var $toc = $("#toc");
    if ( $toc.length ) {
        $("#toc-rightbar").append($toc.clone());
        $("body .main").addClass("with-toc");
    }

    /**
     * In order to make CSS changes that are backward compatible with old adoc files, this applies a version
     * style to the body tag so we can use it to differentiate between CSS styles per version if needed,
     * such as tfoot rows.
     */
    var $version = $("body .nav-container").data("version");
    var $versionClass = "version-" + $version;
    $versionClass = $versionClass.replace('.','-');
    $("body").addClass($versionClass);

    /** A CSS trick to wrap long-width tables in a div that can be scrolled on smaller screens */
    $("table.tableblock").wrap("<div class='table-scroll-wrapper'></div>");

    $(function() {
        /* apply floating scrollbar to the scroll-wrapper */
        $(".table-scroll-wrapper").floatingScrollbar();
    });

</script>
<script src="../../debezium-antora/js/site.js"></script>
<script async src="../../debezium-antora/js/vendor/highlight.js"></script>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-10656779-1");
    pageTracker._trackPageview();
  } catch(err) {}
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76464546-1', 'auto');
  ga('send', 'pageview');
  ga('set', 'anonymizeIp', true);
  ga('require', 'linkid', 'linkid.js');
</script>
</body>
</html>